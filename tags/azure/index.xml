<feed xmlns="http://www.w3.org/2005/Atom" xmlns:cc="http://web.resource.org/cc/">
	<title>List of azure - text.Baldanders.info</title>
	<link rel="alternate" type="text/html" href="https://text.baldanders.info/tags/azure/" />
	<link rel="self" type="application/atom+xml" href="https://text.baldanders.info/tags/azure/index.xml" />
	<id>tag:text.Baldanders.info,2021-12-05:/tags</id>
	<updated>2021-12-05T23:16:02+09:00</updated>
	<subtitle>帰ってきた「しっぽのさきっちょ」</subtitle>
	<icon>https://text.baldanders.info/images/avatar.jpg</icon>
	<logo>https://text.baldanders.info/images/avatar.jpg</logo>

	<entry>
		<title>ようやく Azure Virtual Desktop を導入できた</title>
		<link rel="alternate" type="text/html" href="https://text.baldanders.info/remark/2021/12/azure-virtual-desktop/" />
		<id>tag:text.Baldanders.info,2021-12-05:/remark/2021/12/azure-virtual-desktop/</id>
		<published>2021-12-05T14:16:02+00:00</published>
		<updated>2021-12-05T14:16:24+00:00</updated>
		<summary>最初の頃はデプロイが失敗しまくりで往生したですよ。</summary>
		<author>
			<name>Spiegel</name>
			<uri>https://baldanders.info/profile/</uri>
		</author>
		
	<link rel="cc:license" type="application/rdf+xml" href="https://creativecommons.org/licenses/by-sa/4.0/rdf" />


		<content type="html" xml:lang="ja" xml:base="https://text.baldanders.info/">&lt;p&gt;よーやく &lt;a href=&#34;https://docs.microsoft.com/ja-jp/azure/virtual-desktop/&#34; title=&#34;Azure Virtual Desktop のドキュメント | Microsoft Docs&#34;&gt;Azure Virtual Desktop&lt;/a&gt; を導入できたよ。
Windows 11 が使えるということで個人用の Azure アカウントで試そうとしたんだけど，何だか情報が断片的で分かりにくくてさ。&lt;/p&gt;
&lt;p&gt;手順を覚えているうちに覚え書きとして残しておく。
なお，法人ユーザの場合は &lt;a href=&#34;https://www.microsoft.com/ja-jp/windows-365&#34; title=&#34;Windows 365 クラウド PC | Microsoft&#34;&gt;Windows 365&lt;/a&gt; のほうがオススメである。
今回はあくまで個人ユーザの場合ね。&lt;/p&gt;
&lt;h2&gt;&lt;a href=&#34;https://docs.microsoft.com/ja-jp/azure/active-directory/fundamentals/active-directory-whatis&#34; title=&#34;Azure Active Directory とは - Azure Active Directory | Microsoft Docs&#34;&gt;Azure Active Directory&lt;/a&gt; を確認する&lt;/h2&gt;
&lt;p&gt;個人で Azure アカウントをとった場合でもフリー版の &lt;a href=&#34;https://docs.microsoft.com/ja-jp/azure/active-directory/fundamentals/active-directory-whatis&#34; title=&#34;Azure Active Directory とは - Azure Active Directory | Microsoft Docs&#34;&gt;Azure Active Directory&lt;/a&gt; が用意されている。
&lt;a href=&#34;https://docs.microsoft.com/ja-jp/azure/virtual-desktop/&#34; title=&#34;Azure Virtual Desktop のドキュメント | Microsoft Docs&#34;&gt;Azure Virtual Desktop&lt;/a&gt; を構成するためには &lt;a href=&#34;https://docs.microsoft.com/ja-jp/azure/active-directory/fundamentals/active-directory-whatis&#34; title=&#34;Azure Active Directory とは - Azure Active Directory | Microsoft Docs&#34;&gt;Azure Active Directory&lt;/a&gt; をチェックしてユーザ・プリンシパル名（User Principal Name; UPN）を確認してサインイン可能にしておく必要がある。&lt;/p&gt;
&lt;p&gt;注意しないといけないのは Azure アカウントを取得したときのアカウント名と UPN が異なっている（場合がある）という点。
これに気が付かなくてしーばらく悩んだよ。&lt;/p&gt;
&lt;h2&gt;&lt;a href=&#34;https://docs.microsoft.com/ja-jp/azure/virtual-network/&#34; title=&#34;Azure Virtual Network のドキュメント - チュートリアル、クイックスタート、API リファレンス | Microsoft Docs&#34;&gt;Azure Virtual Network&lt;/a&gt; を構成する&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.microsoft.com/ja-jp/azure/virtual-desktop/&#34; title=&#34;Azure Virtual Desktop のドキュメント | Microsoft Docs&#34;&gt;Azure Virtual Desktop&lt;/a&gt; を構成する際に &lt;a href=&#34;https://docs.microsoft.com/ja-jp/azure/virtual-network/&#34; title=&#34;Azure Virtual Network のドキュメント - チュートリアル、クイックスタート、API リファレンス | Microsoft Docs&#34;&gt;Azure Virtual Network&lt;/a&gt; を指定する必要がある。
これも気が付かなくて，何度もやり直す羽目になった。
Microsoft Docs には色々書かれているが，単純に &lt;a href=&#34;https://docs.microsoft.com/ja-jp/azure/virtual-desktop/&#34; title=&#34;Azure Virtual Desktop のドキュメント | Microsoft Docs&#34;&gt;Azure Virtual Desktop&lt;/a&gt; を使いたいだけなら BastionHost も Firewall も不要である&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.microsoft.com/ja-jp/azure/virtual-network/quick-create-portal&#34;&gt;クイック スタート: 仮想ネットワークを作成する - Azure portal - Azure Virtual Network | Microsoft Docs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;ホストプールを先に作る&lt;/h2&gt;
&lt;p&gt;さて，いよいよ &lt;a href=&#34;https://docs.microsoft.com/ja-jp/azure/virtual-desktop/&#34; title=&#34;Azure Virtual Desktop のドキュメント | Microsoft Docs&#34;&gt;Azure Virtual Desktop&lt;/a&gt; の作成を始めるのだが&lt;/p&gt;
&lt;figure style=&#39;margin:0 auto;text-align:center;&#39;&gt;&lt;a href=&#34;./azure-virtual-desktop-1.png&#34;&gt;&lt;img src=&#34;./azure-virtual-desktop-1.png&#34; srcset=&#34;./azure-virtual-desktop-1.png 1003w&#34; sizes=&#34;(min-width:600px) 500px, 80vw&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/a&gt;&lt;/figure&gt;
&lt;p&gt;「作業の開始」ではなく「ホスト プールの作成」から始めるとよい。
この中で「ホストプール」「仮想マシン」「ワークスペース」を決めていくのが効率がいいようだ。
最初の頃は「作業の開始」から始めて，どうやってもデプロイが失敗するので往生したですよ。&lt;/p&gt;
&lt;p&gt;なお，ホストプールだけ先に作っておいて仮想デスクトップとワークスペースは後から追加する手もある。
私は仮想デスクトップを試行錯誤でいくつか潰してしまった（笑）&lt;/p&gt;
&lt;p&gt;仮想デスクトップを構成する際に&lt;/p&gt;
&lt;figure style=&#39;margin:0 auto;text-align:center;&#39;&gt;&lt;a href=&#34;./azure-virtual-desktop-2.png&#34;&gt;&lt;img src=&#34;./azure-virtual-desktop-2.png&#34; srcset=&#34;./azure-virtual-desktop-2.png 732w&#34; sizes=&#34;(min-width:600px) 500px, 80vw&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/a&gt;&lt;/figure&gt;
&lt;p&gt;てな感じに「仮想マシンの管理者アカウント」を決めるのだが，この情報はどこかに控えておくこと。
最初に仮想デスクトップにログインする際はこの管理者アカウント情報が必要になる。
いや，うっかりアカウント情報を紛失しまって仮想デスクトップを無駄にしてしまったのよ&lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;。&lt;/p&gt;
&lt;p&gt;なお，仮想デスクトップを追加する際にはホストプールの「セッション ホスト」で「追加」すればよい。&lt;/p&gt;
&lt;p&gt;ところで，作成した仮想デスクトップを見ると&lt;/p&gt;
&lt;figure style=&#39;margin:0 auto;text-align:center;&#39;&gt;&lt;a href=&#34;./azure-virtual-desktop-3.png&#34;&gt;&lt;img src=&#34;./azure-virtual-desktop-3.png&#34; srcset=&#34;./azure-virtual-desktop-3.png 502w&#34; sizes=&#34;(min-width:600px) 500px, 80vw&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/a&gt;&lt;/figure&gt;
&lt;p&gt;ってなってるんだけど Windows 11 って 10 のバリエーションってことでOK？&lt;/p&gt;
&lt;p&gt;作成した仮想デスクトップに対して &lt;a href=&#34;https://docs.microsoft.com/ja-jp/azure/active-directory/fundamentals/active-directory-whatis&#34; title=&#34;Azure Active Directory とは - Azure Active Directory | Microsoft Docs&#34;&gt;Azure Active Directory&lt;/a&gt; のユーザを割り当てる。
基本的にひとつの仮想デスクトップに対して1ユーザを割り当てる。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.microsoft.com/ja-jp/azure/virtual-desktop/configure-host-pool-personal-desktop-assignment-type&#34;&gt;Azure Virtual Desktop の個人用デスクトップの割り当ての種類 - Azure | Microsoft Docs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ちゃんと割り当てておかないとログイン時に割り当てられたリソースがないって怒られる。&lt;/p&gt;
&lt;h2&gt;Web クライアントで接続する&lt;/h2&gt;
&lt;p&gt;作成した仮想デスクトップにつなぐには各種クライアント・ツールが使えるのだが&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.microsoft.com/ja-jp/azure/virtual-desktop/user-documentation/&#34;&gt;Azure Virtual Desktop のユーザー ドキュメント | Microsoft Docs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Linux 環境では Web クライアントを使うしかないみたい。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.microsoft.com/ja-jp/azure/virtual-desktop/user-documentation/connect-web&#34;&gt;Web クライアントを使用して Azure Virtual Desktop に接続する - Azure | Microsoft Docs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;接続先は「&lt;a href=&#34;https://rdweb.wvd.microsoft.com/arm/webclient&#34;&gt;Azure Resource Manager 統合バージョンの Azure Virtual Desktop Web クライアント&lt;/a&gt;」でいいようだ。
サインインは仮想デスクトップを割り当ててている &lt;a href=&#34;https://docs.microsoft.com/ja-jp/azure/active-directory/fundamentals/active-directory-whatis&#34; title=&#34;Azure Active Directory とは - Azure Active Directory | Microsoft Docs&#34;&gt;Azure Active Directory&lt;/a&gt; の UNP でおこなう。
以下の画面が表示されればサインイン成功。&lt;/p&gt;
&lt;figure style=&#39;margin:0 auto;text-align:center;&#39;&gt;&lt;a href=&#34;./azure-virtual-desktop-4.png&#34;&gt;&lt;img src=&#34;./azure-virtual-desktop-4.png&#34; srcset=&#34;./azure-virtual-desktop-4.png 500w&#34; sizes=&#34;(min-width:600px) 500px, 80vw&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/a&gt;&lt;/figure&gt;
&lt;p&gt;“SessionDesktop” を選択すると&lt;/p&gt;
&lt;figure style=&#39;margin:0 auto;text-align:center;&#39;&gt;&lt;a href=&#34;./azure-virtual-desktop-5.png&#34;&gt;&lt;img src=&#34;./azure-virtual-desktop-5.png&#34; srcset=&#34;./azure-virtual-desktop-5.png 623w&#34; sizes=&#34;(min-width:600px) 500px, 80vw&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/a&gt;&lt;/figure&gt;
&lt;p&gt;などとプロンプトが出るので適当に「許可」するとようやく&lt;/p&gt;
&lt;figure style=&#39;margin:0 auto;text-align:center;&#39;&gt;&lt;a href=&#34;./azure-virtual-desktop-6.png&#34;&gt;&lt;img src=&#34;./azure-virtual-desktop-6.png&#34; srcset=&#34;./azure-virtual-desktop-6.png 621w&#34; sizes=&#34;(min-width:600px) 500px, 80vw&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/a&gt;&lt;/figure&gt;
&lt;p&gt;ログイン画面になる。
ここで「仮想マシンの管理者アカウント」を使ってログインすればよい。&lt;/p&gt;
&lt;figure style=&#39;margin:0 auto;text-align:center;&#39;&gt;&lt;a href=&#34;./azure-virtual-desktop-7.png&#34;&gt;&lt;img src=&#34;./azure-virtual-desktop-7.png&#34; srcset=&#34;./azure-virtual-desktop-7.png 1920w&#34; sizes=&#34;(min-width:600px) 500px, 80vw&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/a&gt;&lt;/figure&gt;
&lt;p&gt;よーし。
よーやくここまできたよ。&lt;/p&gt;
&lt;p&gt;試しに Edge ブラウザで Google のページを開いてみる。&lt;/p&gt;
&lt;figure style=&#39;margin:0 auto;text-align:center;&#39;&gt;&lt;a href=&#34;./azure-virtual-desktop-8.png&#34;&gt;&lt;img src=&#34;./azure-virtual-desktop-8.png&#34; srcset=&#34;./azure-virtual-desktop-8.png 1920w&#34; sizes=&#34;(min-width:600px) 500px, 80vw&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/a&gt;&lt;/figure&gt;
&lt;p&gt;おー。
これが噂の&lt;a href=&#34;https://japanese.engadget.com/microsoft-edge-try-stop-user-download-chrome-050051364.html&#34; title=&#34;マイクロソフトEdge、ユーザーにChromeのダウンロードを止めるよう呼びかける - Engadget 日本版&#34;&gt;ブラウザ勧誘合戦&lt;/a&gt;か。
アホだ（笑）&lt;/p&gt;
&lt;p&gt;というわけで，やっと Windows 11 で遊び倒す準備ができた。
まずは大量の Windows Update をどうにかしないと（笑）&lt;/p&gt;
&lt;p&gt;ちなみにめちゃめちゃ重い。
普段遣いにはできないな，これ。&lt;/p&gt;
&lt;h2&gt;&lt;a href=&#34;https://docs.microsoft.com/ja-jp/azure/virtual-desktop/&#34; title=&#34;Azure Virtual Desktop のドキュメント | Microsoft Docs&#34;&gt;Azure Virtual Desktop&lt;/a&gt; のコスト&lt;/h2&gt;
&lt;p&gt;2021-12-31 までは無料で &lt;a href=&#34;https://docs.microsoft.com/ja-jp/azure/virtual-desktop/&#34; title=&#34;Azure Virtual Desktop のドキュメント | Microsoft Docs&#34;&gt;Azure Virtual Desktop&lt;/a&gt; を利用できる。
以降については以下のサイトが参考になるかな。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://azure.microsoft.com/ja-jp/pricing/details/virtual-desktop/&#34;&gt;Azure Virtual Desktop の価格 | Microsoft Azure&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.microsoft.com/ja-jp/azure/virtual-desktop/remote-app-streaming/total-costs&#34;&gt;Azure Virtual Desktop のデプロイ コストの合計について - Azure | Microsoft Docs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;section class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;仮想マシン間でやり取りしたいなら BastionHost を設定したほうがいいかも。外部から SSH で入る場合も必要かな。&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;仮想デスクトップのアカウント名だけでも分かっていれば Azure 側からパスワードリセットすることは可能。&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;
</content>
	</entry>
</feed>
