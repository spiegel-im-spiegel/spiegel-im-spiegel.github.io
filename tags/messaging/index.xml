<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<feed xmlns="http://www.w3.org/2005/Atom" xmlns:cc="http://web.resource.org/cc/">
	<title>Messaging - text.Baldanders.info</title>
	<link rel="alternate" type="text/html" href="http://text.baldanders.info/tags/messaging/" />
	<link rel="self" type="application/atom+xml" href="http://text.baldanders.info/tags/messaging/index.xml" />
	<id>tag:text.Baldanders.info,2015-10-14T22:44:28+0900:/</id>
	<updated>2015-10-14T22:44:28+0900</updated>
	<subtitle>帰ってきた「しっぽのさきっちょ」</subtitle>
	<icon>http://text.baldanders.info//images/avatar.jpg</icon>
	<logo>http://text.baldanders.info//images/avatar.jpg</logo>
	<generator uri="http://gohugo.io/">Hugo 0.15-DEV</generator>

	
	<entry>
		<title>LINE： Letter Sealing による End-to-End 暗号化 - remark</title>
		<link rel="alternate" type="text/html" href="http://text.baldanders.info/remark/2015/letter-sealing-line/" />
		<id>tag:text.Baldanders.info,2015-10-14T22:44:28+0900:/remark/2015/letter-sealing-line/</id>
		<published>2015-10-14T22:44:28+0900</published>
		<updated>2015-10-14T22:44:28+0900</updated>
		<summary>昨年 EFF が安全なメッセージングアプリの条件を示した。この条件に照らせば Letter Sealing は最初の2つはクリアしたけど，残りは「もっと頑張りましょう」な状態。</summary>
		
			<author>
				<name>Spiegel</name>
				<uri>http://www.baldanders.info/spiegel/profile/</uri>
			</author>
			
	<link rel="cc:license" type="application/rdf+xml" href="http://creativecommons.org/licenses/by-sa/4.0/rdf" />


		
		<category term="remark" label="remark" scheme="http://text.baldanders.info/remark" />
		<content type="html" xml:lang="ja" xml:base="http://text.baldanders.info/">

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://appllio.com/how-to-set-line-letter-sealing&#34;&gt;LINE、トークを高度な暗号化で保護する「Letter Sealing」を実装　設定方法も紹介 | アプリオ&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;以前の「&lt;a href=&#34;http://ja.hideki.hclippr.com/2014/08/01/line%E3%81%AE%E3%82%BF%E3%82%A4%E3%83%9E%E3%83%BC%E3%83%88%E3%83%BC%E3%82%AF%E3%81%A7%E6%80%9D%E3%81%86%E3%81%93%E3%81%A8/&#34;&gt;タイマートーク&lt;/a&gt;」のように「どうせ日本リージョンのユーザには関係ない話だろう」と思っていたら，日本でもやるらしい。
LINE は捨てたので完全に見落としていたのだが，既に9月時点で実装されていたようだ。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://ja.hideki.hclippr.com/2015/09/01/line%E3%81%AEe2ee%E5%AE%9F%E8%A3%85%E3%80%8Cletter-sealing%E3%80%8D%E5%88%9D%E8%A6%8B/&#34;&gt;LINEのE2EE実装「Letter Sealing」初見 | Hideki&amp;rsquo;s Random Stuff Japanese&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Letter Sealing に関する詳細情報も公開されている。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://developers.linecorp.com/blog/?p=3679&#34;&gt;New generation of safe messaging: “Letter Sealing” « LINE Engineers&amp;rsquo; Blog&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://developers.linecorp.com/blog/ja/?p=3591&#34;&gt;メッセージの安全性新時代：Letter Sealing « LINE Engineers&amp;rsquo; Blog&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;まぁ Google の Hungout や Facebook の Messanger よりマシになったとは言えるだろう。
上の記事で説明されている仕様は以下の通り。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;エンド・ユーザ間の Diffie-Hellman 鍵交換。アルゴリズムは ECDH/256bits。ただし ephemeral かどうかは不明&lt;sup class=&#34;footnote-ref&#34; id=&#34;fnref:817c55b24c7606bf42368624314c7800:0&#34;&gt;&lt;a rel=&#34;footnote&#34; href=&#34;#fn:817c55b24c7606bf42368624314c7800:0&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/li&gt;
&lt;li&gt;メッセージの暗号化には上の鍵交換で生成した AES/256bits 鍵を使う。モードは CBC&lt;/li&gt;
&lt;li&gt;HMAC によるメッセージの完全性の担保&lt;sup class=&#34;footnote-ref&#34; id=&#34;fnref:817c55b24c7606bf42368624314c7800:1&#34;&gt;&lt;a rel=&#34;footnote&#34; href=&#34;#fn:817c55b24c7606bf42368624314c7800:1&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;お気づきと思うが，このままでは鍵の真正性を証明（certification）できない。
相手から送られて来る公開鍵情報を無条件に受け入れてしまう。
ぶっちゃけて言うなら LINE サーバ上で中間者攻撃（man-in-the-middle attack）が可能ということだ&lt;sup class=&#34;footnote-ref&#34; id=&#34;fnref:817c55b24c7606bf42368624314c7800:a&#34;&gt;&lt;a rel=&#34;footnote&#34; href=&#34;#fn:817c55b24c7606bf42368624314c7800:a&#34;&gt;3&lt;/a&gt;&lt;/sup&gt;。
「&lt;a href=&#34;http://ja.hideki.hclippr.com/2015/09/01/line%E3%81%AEe2ee%E5%AE%9F%E8%A3%85%E3%80%8Cletter-sealing%E3%80%8D%E5%88%9D%E8%A6%8B/&#34;&gt;LINEのE2EE実装「Letter Sealing」初見&lt;/a&gt;」によるとクライアントごとに異なる鍵を生成するようなので&lt;sup class=&#34;footnote-ref&#34; id=&#34;fnref:817c55b24c7606bf42368624314c7800:b&#34;&gt;&lt;a rel=&#34;footnote&#34; href=&#34;#fn:817c55b24c7606bf42368624314c7800:b&#34;&gt;4&lt;/a&gt;&lt;/sup&gt;，なおさら鍵の証明が重要になってくると思うのだけど。&lt;/p&gt;

&lt;p&gt;どうも最近は「暗号鍵がユーザに見えるのはダサい」みたいな風潮があるけど，公開鍵暗号方式を使うなら鍵の証明と管理の scheme が生命線になるので，これを怠ると今回のような中途半端な実装になってしまう。&lt;/p&gt;

&lt;p&gt;昨年， EFF が安全なメッセージング・アプリの条件を示した。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.eff.org/secure-messaging-scorecard&#34;&gt;Secure Messaging Scorecard | Electronic Frontier Foundation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://ascii.jp/elem/000/000/958/958626/&#34;&gt;ASCII.jp：実は危険だらけのメッセージアプリ&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;条件は7つ。&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Encrypted in transit?&lt;/li&gt;
&lt;li&gt;Encrypted so the provider can&amp;rsquo;t read it?&lt;/li&gt;
&lt;li&gt;Can you verify contacts&amp;rsquo; identities?&lt;/li&gt;
&lt;li&gt;Are past comms secure if your keys are stolen?&lt;/li&gt;
&lt;li&gt;Is the code open to independent review?&lt;/li&gt;
&lt;li&gt;Is security design properly documented?&lt;/li&gt;
&lt;li&gt;Has there been any recent code audit?&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;この条件に照らせば Letter Sealing は最初の2つはクリアしたけど&lt;sup class=&#34;footnote-ref&#34; id=&#34;fnref:817c55b24c7606bf42368624314c7800:c&#34;&gt;&lt;a rel=&#34;footnote&#34; href=&#34;#fn:817c55b24c7606bf42368624314c7800:c&#34;&gt;5&lt;/a&gt;&lt;/sup&gt;，残りは「もっと頑張りましょう」な状態。
せめて条件4までは全て対応していただきたいところだ。&lt;/p&gt;

&lt;p&gt;LINE の場合，アカウントの乗っ取りや成りすましが（手を変え品を変え）現在も続いているようなので，（脆弱なユーザの purge を含めて）そろそろ抜本的に対策していかないと「暗号化したけど意味ないじゃん」ってことになりかねないと思う&lt;sup class=&#34;footnote-ref&#34; id=&#34;fnref:817c55b24c7606bf42368624314c7800:d&#34;&gt;&lt;a rel=&#34;footnote&#34; href=&#34;#fn:817c55b24c7606bf42368624314c7800:d&#34;&gt;6&lt;/a&gt;&lt;/sup&gt;。&lt;/p&gt;

&lt;h2 id=&#34;参考:817c55b24c7606bf42368624314c7800&#34;&gt;参考&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://www.baldanders.info/spiegel/log2/000782.shtml&#34;&gt;安全なメッセージング・アプリとは — Baldanders.info&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.baldanders.info/spiegel/log2/000800.shtml&#34;&gt;安全なメッセージング・アプリ（ちょびっと改訂） — Baldanders.info&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://ja.hideki.hclippr.com/2015/10/14/line%E3%81%AEletter-sealing%E3%81%AB%E9%96%A2%E3%81%99%E3%82%8B%E3%83%95%E3%82%A9%E3%83%AD%E3%83%BC%E3%82%A2%E3%83%83%E3%83%97/&#34;&gt;LINEのLetter Sealingに関するフォローアップ | Hideki&amp;rsquo;s Random Stuff Japanese&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://official-blog.line.me/ja/archives/39021529.html&#34;&gt;【注意喚起】 友人や知人になりすまして電話番号やSMS認証番号を聞き出すメッセージにご注意ください : LINE公式ブログ&lt;/a&gt; : 今年の夏ごろに流行った乗っ取り手口&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;footnotes&#34;&gt;

&lt;hr /&gt;

&lt;ol&gt;
&lt;li id=&#34;fn:817c55b24c7606bf42368624314c7800:0&#34;&gt;Ephemeral かどうかは通信が PFS (Perfect Forward Secrecy) を満たすか否かに関わってくる。
 &lt;a class=&#34;footnote-return&#34; href=&#34;#fnref:817c55b24c7606bf42368624314c7800:0&#34;&gt;&lt;sup&gt;[return]&lt;/sup&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li id=&#34;fn:817c55b24c7606bf42368624314c7800:1&#34;&gt;「HMACは、ハッシュ関数(hash funciton)という一方向性関数(one-way function)でメッセージに対するデジタル署名(digital signature)を取得し」と書かれているのは何かの冗談だと思う。英語の記事にはそんな記述ないし。
 &lt;a class=&#34;footnote-return&#34; href=&#34;#fnref:817c55b24c7606bf42368624314c7800:1&#34;&gt;&lt;sup&gt;[return]&lt;/sup&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li id=&#34;fn:817c55b24c7606bf42368624314c7800:a&#34;&gt;ただし中間者攻撃は（昨年の &lt;a href=&#34;http://www.baldanders.info/spiegel/log2/000682.shtml&#34;&gt;OpenSSL に対する HeartBleed&lt;/a&gt; のように）既に攻撃が可能な状態なら相当な脅威だけど，攻撃を行うための前提条件を揃えるのは結構面倒なので，全体としてのリスクはそれほど高いわけではない。
 &lt;a class=&#34;footnote-return&#34; href=&#34;#fnref:817c55b24c7606bf42368624314c7800:a&#34;&gt;&lt;sup&gt;[return]&lt;/sup&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li id=&#34;fn:817c55b24c7606bf42368624314c7800:b&#34;&gt;これ自体は妥当。もっと言うなら， ephemeral な鍵であればおそらくセッション毎に異なる。
 &lt;a class=&#34;footnote-return&#34; href=&#34;#fnref:817c55b24c7606bf42368624314c7800:b&#34;&gt;&lt;sup&gt;[return]&lt;/sup&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li id=&#34;fn:817c55b24c7606bf42368624314c7800:c&#34;&gt;PFS を満たすなら条件4も満たす。
 &lt;a class=&#34;footnote-return&#34; href=&#34;#fnref:817c55b24c7606bf42368624314c7800:c&#34;&gt;&lt;sup&gt;[return]&lt;/sup&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li id=&#34;fn:817c55b24c7606bf42368624314c7800:d&#34;&gt;ていうか， LINE はユーザを増やしすぎたよね。これは Facebook とかでも同じだけど。総じて LINE は真正性について甘い。むしろ意図的に避けてる印象。真正性を担保できない状態で，どれだけ暗号化に力を入れようとも無意味。
 &lt;a class=&#34;footnote-return&#34; href=&#34;#fnref:817c55b24c7606bf42368624314c7800:d&#34;&gt;&lt;sup&gt;[return]&lt;/sup&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</content>
	</entry>
	
</feed>
