<feed xmlns="http://www.w3.org/2005/Atom" xmlns:cc="http://web.resource.org/cc/">
	<title>List of samba - text.Baldanders.info</title>
	<link rel="alternate" type="text/html" href="https://text.baldanders.info/tags/samba/" />
	<link rel="self" type="application/atom+xml" href="https://text.baldanders.info/tags/samba/index.xml" />
	<id>tag:text.Baldanders.info,2021-10-26:/tags</id>
	<updated>2021-10-26T23:50:36+09:00</updated>
	<subtitle>帰ってきた「しっぽのさきっちょ」</subtitle>
	<icon>https://text.baldanders.info/images/avatar.jpg</icon>
	<logo>https://text.baldanders.info/images/avatar.jpg</logo>

	<entry>
		<title>秋 NAS は俺に喰わせろ！</title>
		<link rel="alternate" type="text/html" href="https://text.baldanders.info/remark/2021/10/nas/" />
		<id>tag:text.Baldanders.info,2021-10-26:/remark/2021/10/nas/</id>
		<published>2021-10-26T14:50:36+00:00</published>
		<updated>2021-10-26T23:18:10+00:00</updated>
		<summary>金曜の夜にポチって中1日で届くとは思わざりき（笑）</summary>
		<author>
			<name>Spiegel</name>
			<uri>https://baldanders.info/profile/</uri>
		</author>
		
	<link rel="cc:license" type="application/rdf+xml" href="https://creativecommons.org/licenses/by-sa/4.0/rdf" />


		<content type="html" xml:lang="ja" xml:base="https://text.baldanders.info/">&lt;p&gt;勤務先で LAN 上の NAS やクラウド・ストレージの構成を見直す動きが出ていて「そういや私が簡易 NAS を導入したのっていつだっけ？」と過去記事を漁ってみたら3年半も前だったよ。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://text.baldanders.info/remark/2018/04/nas/&#34;&gt;NAS を導入した&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;その半年後に&lt;a href=&#34;https://text.baldanders.info/remark/2018/12/i-am-a-sunday-programmer/&#34; title=&#34;どうも，日曜プログラマの Spiegel です&#34;&gt;田舎に&lt;ruby&gt;&lt;rb&gt;帰郷&lt;/rb&gt;&lt;rp&gt; (&lt;/rp&gt;&lt;rt&gt;かえ&lt;/rt&gt;&lt;rp&gt;) &lt;/rp&gt;&lt;/ruby&gt;る羽目になった&lt;/a&gt;のだが，当時は Windows を捨てる準備に入ろうかというところで，バックアップと書き戻し用に（OS を跨いで）アクセスできる共有ストレージが欲しかったんだよね。&lt;/p&gt;
&lt;p&gt;導入して良かった点は LAN 上の NAS とクラウド・ストレージ・サービスを連携させることで，そこそこ安全で快適な環境を手に入れられたことだろう。
とはいえ RAID 0 すら組んでない簡易設備でこのまま運用を続けるのはもう限界だろうと思い直したわけだ。&lt;/p&gt;
&lt;p&gt;で，まぁ，あれこれ迷った挙句に買ったのは &lt;a href=&#34;https://www.synology.com/ja-jp/products/DS220j&#34; title=&#34;DS220j | Synology Inc.&#34;&gt;Synology DS220j&lt;/a&gt; ってやつ。
今回も&lt;a href=&#34;https://www.dospara.co.jp/&#34;&gt;ドスパラ&lt;/a&gt;さんのお世話になりました。
&lt;a href=&#34;https://www.dospara.co.jp/5shopping/detail_set.php?bg=&amp;amp;br=&amp;amp;sbr=&amp;amp;camp=1804&amp;amp;ft=synology&amp;amp;lf=2&#34; title=&#34;【HDD+ドライブケース】Synology NAS + 選べる W.D HDD 3点セット｜｜｜通販のドスパラ&#34;&gt;HDD 2基と3点セット&lt;/a&gt;になってるやつをポチりました。&lt;/p&gt;
&lt;p&gt;本当はポチってから数日あけて来ることを想定してたんだけど，金曜の夜にポチって中1日で（松江みたいな片田舎まで）届くとは思わざりき（笑）&lt;/p&gt;
&lt;figure style=&#39;margin:0 auto;text-align:center;&#39;&gt;&lt;a href=&#34;https://www.flickr.com/photos/spiegel/51625630824/&#34;&gt;&lt;img src=&#34;./51625630824_e1ae072032_e.jpg&#34; srcset=&#34;./51625630824_e1ae072032_e.jpg 500w&#34; sizes=&#34;(min-width:600px) 500px, 80vw&#34; alt=&#34;秋 NAS 来た！ | Flickr&#34;&gt;&lt;/a&gt;&lt;figcaption&gt;&lt;div&gt;&lt;a href=&#34;https://www.flickr.com/photos/spiegel/51625630824/&#34;&gt;秋 NAS 来た！ | Flickr&lt;/a&gt;&lt;/div&gt;&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;ありがたいことに「NAS 初心者ガイド」という日本語の冊子がついていた。
これのおかげでセットアップ自体は比較的スムーズにできた。
ブラウザで Web Assistant を開いたときに最初はうまく検出できなかったくらい（ブラウザを立ち上げ直したら上手くいった）かな？&lt;/p&gt;
&lt;h2&gt;RAID&lt;/h2&gt;
&lt;p&gt;RAID は SHR (Synology Hybrid RAID) にした。
RAID 1 とかだと ストレージの容量やメーカーを揃える必要があるが， SHR はその辺は柔軟に運用できるらしい。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://kb.synology.com/ja-jp/DSM/tutorial/What_is_Synology_Hybrid_RAID_SHR&#34;&gt;Synology Hybrid RAID（SHR）とは？ - Synology ナレッジセンター&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;QuickConnect は無効にした&lt;/h2&gt;
&lt;p&gt;最初は Synology アカウントを取得して QuickConnect も使ってたんだが，どうにも気持ち悪いので QuickConnect はいったん無効にした。
Synology アカウントは有効にしてるので，必要になったらまた復活させればいいだろう。&lt;/p&gt;
&lt;p&gt;VPN 接続は &lt;a href=&#34;https://www.synology.com/ja-jp/dsm/packages/Tailscale?os_ver=7.0&#34; title=&#34;Tailscale - アドオン パッケージ | Synology Inc.&#34;&gt;Tailscale&lt;/a&gt; を検討中&amp;hellip;&lt;/p&gt;
&lt;h2&gt;Ubuntu ファイルマネージャから SMB サービスに入れない&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.ubuntu.com/&#34; title=&#34;The leading operating system for PCs, IoT devices, servers and the cloud | Ubuntu&#34;&gt;Ubuntu&lt;/a&gt; 標準のファイルマネージャ（&lt;code&gt;nautilus&lt;/code&gt;）は LAN 上の Windows 共有フォルダや &lt;a href=&#34;https://www.samba.org/&#34; title=&#34;Samba - opening windows to a wider world&#34;&gt;Samba&lt;/a&gt; サービスを自動的に検出・表示してくれる。
&lt;a href=&#34;https://www.synology.com/ja-jp/products/DS220j&#34; title=&#34;DS220j | Synology Inc.&#34;&gt;DS220j&lt;/a&gt; も SMB (Server Message Block) が使えるので Windows ネットワークと同じように表示されるんだけど，クリックしても何故か入れないのよね。&lt;/p&gt;
&lt;figure style=&#39;margin:0 auto;text-align:center;&#39;&gt;&lt;a href=&#34;./samba-error.png&#34;&gt;&lt;img src=&#34;./samba-error.png&#34; srcset=&#34;./samba-error.png 626w&#34; sizes=&#34;(min-width:600px) 500px, 80vw&#34; alt=&#34;&#34;&gt;&lt;/a&gt;&lt;/figure&gt;
&lt;p&gt;なんやねん「無効な引数」て &lt;code&gt;orz&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;これは現在に至るも改善しない（理由がわからないので）。
ただし &lt;code&gt;mount.cifs&lt;/code&gt; でマウントはできるし &lt;code&gt;/etc/fstab&lt;/code&gt; ファイルへの記述もちゃんと効いたので実害はない。
多分ファイルマネージャ側の問題なんだろうなぁ。
CIFS 経由で NAS に接続する方法は以下の通り。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://text.baldanders.info/remark/2019/03/common-internet-file-system/&#34;&gt;CIFS 経由で NAS に接続する&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ちなみに Android の &lt;a href=&#34;https://play.google.com/store/apps/details?id=com.skyjos.apps.fileexplorer&#34; title=&#34;File Explorer Pro - file manager and file transfer - Google Play&#34;&gt;FE File Explorer Pro&lt;/a&gt; からは普通に見れた。&lt;/p&gt;
&lt;h2&gt;Ubuntu から NFS サービスに入れない&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.ubuntu.com/&#34; title=&#34;The leading operating system for PCs, IoT devices, servers and the cloud | Ubuntu&#34;&gt;Ubuntu&lt;/a&gt; に NFS クライアントを導入する。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;$ sudo apt install nfs-common
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;https://www.synology.com/ja-jp/products/DS220j&#34; title=&#34;DS220j | Synology Inc.&#34;&gt;DS220j&lt;/a&gt; 側の NFS サービスを有効化して &lt;a href=&#34;https://www.ubuntu.com/&#34; title=&#34;The leading operating system for PCs, IoT devices, servers and the cloud | Ubuntu&#34;&gt;Ubuntu&lt;/a&gt; からアクセスしようとしたが上手くいかない。
まぁ，考えてみたら当たり前で Kerberos を使ってアカウントのマッピングでもするのならともかく，家庭内 LAN ごときでそこまでしないし，しないなら見えなくても仕方ない。&lt;/p&gt;
&lt;figure&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;strong&gt;セキュリティ フレーバー：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;特定のユーザー アカウントで NFS を介して共有フォルダにアクセスする場合：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;AUTH_SYS&lt;/strong&gt; セキュリティが導入されている場合：クライアントは NFS クライアントと Synology NAS で全く同じ UID（ユーザー識別子）と GID（グループ識別子）を持っていなければなりません。そうしなければ、クライアントが共有フォルダにアクセスするときに、&lt;strong&gt;「others」&lt;strong&gt;という許可が割り当てられます。権限が競合しないように、&lt;/strong&gt;[Squash]&lt;/strong&gt; から &lt;strong&gt;[全ユーザーを admin にマップ]&lt;/strong&gt; を選択するか、共有フォルダに｢Everyone｣権限を割り当てます。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Kerberos (krb5、krb5i、krb5p)&lt;/strong&gt; セキュリティが導入されている場合：&lt;strong&gt;[ファイル サービス]&lt;/strong&gt; &amp;gt; &lt;strong&gt;[NFS]&lt;/strong&gt; &amp;gt; &lt;strong&gt;[NFS サービスの有効化]&lt;/strong&gt; &amp;gt; &lt;strong&gt;[詳細設定]&lt;/strong&gt; &amp;gt; &lt;strong&gt;[Kerberos の設定]&lt;/strong&gt; の順にを選択して、NFS クライアントを特定のユーザーに割り当てなければなりません。または、相当するユーザー アカウントで Windows/LDAP ドメインに加わります。そうしなければ、クライアントが共有フォルダにアクセスするときに、「guest」という許可が割り当てられます。&lt;/li&gt;
&lt;li&gt;共有フォルダを作成する拡張デバイスのファイル システムが NTFS または FAT の場合は、&lt;strong&gt;[すべてのユーザーを admin にマップ]&lt;/strong&gt; オプションが強制的に適用されます。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Synology NAS に接続するために Kerberos セキュリティを使用するには、&lt;strong&gt;[ファイル サービス]&lt;/strong&gt; &amp;gt; &lt;strong&gt;[NFS]&lt;/strong&gt; &amp;gt; &lt;strong&gt;[NFS サービスの有効化]&lt;/strong&gt; &amp;gt; &lt;strong&gt;[詳細設定]&lt;/strong&gt; &amp;gt; &lt;strong&gt;[Kerberos の設定]&lt;/strong&gt; の順に選択して、Kerberos 認証が設定されていなければなりません。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figcaption&gt;&lt;div&gt;&lt;q&gt;&lt;a href=&#34;https://kb.synology.com/ja-jp/DSM/help/DSM/AdminCenter/file_share_privilege_nfs?version=7&#34;&gt;NFS 権限を割り当てる | DSM - Synology ナレッジセンター&lt;/a&gt;&lt;/q&gt;より&lt;/div&gt;&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;というわけで，今回は 権限を「カスタマイズ」して &lt;code&gt;Everyone&lt;/code&gt; 権限を追加・設定した。
複数人で使う場合は NFS は使わんほうがいいかもなぁ。&lt;/p&gt;
&lt;p&gt;ちなみに &lt;code&gt;/etc/fstab&lt;/code&gt; ファイルを使ってマウントする場合には&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;ds220j-hostname:/volumeX/homes/username /home/username/nas-home nfs rsize=8192,wsize=8192,timeo=14,intr 0 0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;などとすればよい。&lt;/p&gt;
&lt;h2&gt;Cloud Sync&lt;/h2&gt;
&lt;p&gt;パッケージ・センターから &lt;a href=&#34;https://www.synology.com/ja-jp/dsm/feature/cloud_sync&#34; title=&#34;Cloud Sync | Synology Inc.&#34;&gt;Cloud Sync&lt;/a&gt; をインストールしてストレージ・クラウドと連携できるようにした。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.synology.com/ja-jp/dsm/feature/cloud_sync&#34; title=&#34;Cloud Sync | Synology Inc.&#34;&gt;Cloud Sync&lt;/a&gt; は Google Drive, Dropbox, Box, Microsoft OneDrive あるいは Azure Storage, Google Cloud Storage, S3 storage といったメジャー・サービスはもちろん，一般的な WebDAV とも連携できるらしい。&lt;/p&gt;
&lt;p&gt;さらに &lt;a href=&#34;https://www.synology.com/ja-jp/dsm/feature/cloud_sync&#34; title=&#34;Cloud Sync | Synology Inc.&#34;&gt;Cloud Sync&lt;/a&gt; では&lt;/p&gt;
&lt;figure style=&#39;margin:0 auto;text-align:center;&#39;&gt;&lt;a href=&#34;./cloud-storage-encrypt.png&#34;&gt;&lt;img src=&#34;./cloud-storage-encrypt.png&#34; srcset=&#34;./cloud-storage-encrypt.png 630w&#34; sizes=&#34;(min-width:600px) 500px, 80vw&#34; alt=&#34;&#34;&gt;&lt;/a&gt;&lt;/figure&gt;
&lt;p&gt;てな感じに同期データの暗号化ができる。
具体的には &lt;a href=&#34;https://www.synology.com/ja-jp/dsm/feature/cloud_sync&#34; title=&#34;Cloud Sync | Synology Inc.&#34;&gt;Cloud Sync&lt;/a&gt; からアップロードする際に暗号化された状態でアップロードされる。
元々クラウド・ストレージ側に置いてあるファイルは暗号化の対象にならない。
暗号化ファイルは NAS 側では復号された状態で格納されており，クラウド・ストレージ側で暗号化されているか否かに関係なく透過的に扱うことができる。&lt;/p&gt;
&lt;p&gt;クラウド・ストレージって便利で使い勝手がいいけど，他人のデータを覗き見る痴漢野郎がいるぢゃん。
Google とか &lt;a href=&#34;https://text.baldanders.info/remark/2021/08/apples-mass-surveillance-plans/&#34;&gt;Apple&lt;/a&gt; とか。
だから積極的には使わないようにしてたんだけど，これで踏ん切りがついたわ。&lt;/p&gt;
&lt;p&gt;物置用のクラウド・ストレージ・サービスとして Google Drive をデータ暗号化した上で利用することにした。
これに伴い &lt;a href=&#34;https://one.google.com/&#34;&gt;Google One&lt;/a&gt; の&lt;a href=&#34;https://one.google.com/about/plans&#34; title=&#34;プランと料金設定 - Google One&#34;&gt;有料プラン&lt;/a&gt;へアップグレードした。&lt;/p&gt;
&lt;p&gt;運用中の各種クラウド・ストレージ・サービスに置いてあるファイルを整理しないとな。&lt;/p&gt;
&lt;h2&gt;Git Server と SSH&lt;/h2&gt;
&lt;p&gt;パッケージ・センターで &lt;a href=&#34;https://www.synology.com/ja-jp/dsm/packages/Git?os_ver=7.0&#34; title=&#34;Git Server - アドオン パッケージ | Synology Inc.&#34;&gt;Git Server&lt;/a&gt; を見つけたのでインストールしてみたのだが&amp;hellip;&lt;/p&gt;
&lt;p&gt;どうやら SSH ベースのサーバのようだが&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://kb.synology.com/ja-jp/DSM/help/Git/git?version=7&#34;&gt;Git Server - Synology ナレッジセンター&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;そもそも &lt;a href=&#34;https://www.synology.com/ja-jp/products/DS220j&#34; title=&#34;DS220j | Synology Inc.&#34;&gt;DS220j&lt;/a&gt; は管理者権限を持つアカウントしか SSH を使えないようになっている。
なので &lt;a href=&#34;https://www.synology.com/ja-jp/dsm/packages/Git?os_ver=7.0&#34; title=&#34;Git Server - アドオン パッケージ | Synology Inc.&#34;&gt;Git Server&lt;/a&gt; へのアクセス専用にグループとユーザを作成し，専用の共有フォルダを設定する必要がある。&lt;/p&gt;
&lt;p&gt;更に言うとユーザ・ホーム・サービスを有効にしておく必要がある。&lt;/p&gt;
&lt;figure style=&#39;margin:0 auto;text-align:center;&#39;&gt;&lt;a href=&#34;./user-home-service.png&#34;&gt;&lt;img src=&#34;./user-home-service.png&#34; srcset=&#34;./user-home-service.png 642w&#34; sizes=&#34;(min-width:600px) 500px, 80vw&#34; alt=&#34;&#34;&gt;&lt;/a&gt;&lt;/figure&gt;
&lt;p&gt;これがないと公開鍵認証ができないらしい。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://qiita.com/shimizumasaru/items/56474d98e723ea1b5ae3&#34;&gt;Synology DiskStation で SSH 接続を公開鍵認証方式にする - Qiita&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;まぁ，ぼちぼち進めるか。&lt;/p&gt;
&lt;h2&gt;次は Tailscale か？&lt;/h2&gt;
&lt;p&gt;これは次の休みにでもやってみることにしよう。
もともと &lt;a href=&#34;https://tailscale.com/&#34; title=&#34;Tailscale · Best VPN Service for Secure Networks&#34;&gt;Tailscale&lt;/a&gt; は興味があってやってみようとは思っていたのだ。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://internet.watch.impress.co.jp/docs/column/shimizu/1303751.html&#34;&gt;100台まで無料のVPNサービス「tailscale」、リンクだけでマシンのシェアも可能!?【イニシャルB】 - INTERNET Watch&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://blog.tsukumijima.net/article/tailscale-vpn/&#34;&gt;Tailscale VPN を使ってみたので感想 | つくみ島だより&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://4b-media.net/tailscale/&#34;&gt;リモートワーク向けにセキュアなVPNを構築【tailscale】 | 4b-media&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;ブックマーク&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://community.synology.com/jpn/forum/2/post/6&#34;&gt;RAIDの構成を「SHR」から「RAID 1」へ変更できますか？ | Synology Community&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://news.mynavi.jp/kikaku/20181221-741225/&#34;&gt;知らないと損! Synology社員が教えるNASの裏ワザ【前編】セキュリティーと信頼性を高める | マイナビニュース&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://dc.watch.impress.co.jp/docs/review/special/1209064.html&#34;&gt;特別企画：知っておきたい！NAS購入から活用までの疑問あれこれ - デジカメ Watch&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.itmedia.co.jp/pcuser/articles/1603/18/news096_3.html&#34;&gt;NASを使ったほうがいい人、使わないほうがいい人：Synologyで始めるNAS生活（3/3 ページ） - ITmedia PC USER&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://arakoki70.com/?p=2317&#34;&gt;Synology アカウントの取得 - アラコキからの Raspberry Pi 電子工作&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.digitalocean.com/community/tutorials/how-to-set-up-an-nfs-mount-on-ubuntu-20-04-ja&#34;&gt;Ubuntu 20.04にNFSマウントをセットアップする方法 | DigitalOcean&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;参考&lt;/h2&gt;
&lt;div class=&#34;hreview&#34;&gt;
  &lt;div class=&#34;photo&#34;&gt;&lt;a href=&#34;https://www.amazon.co.jp/dp/B0855LMP81?tag=baldandersinf-22&amp;amp;linkCode=ogi&amp;amp;th=1&amp;amp;psc=1&#34;&gt;&lt;img src=&#34;https://m.media-amazon.com/images/I/31Jy8IwFHwL._SL160_.jpg&#34; width=&#34;160&#34; alt=&#34;photo&#34;&gt;&lt;/a&gt;&lt;/div&gt;
  &lt;dl&gt;
    &lt;dt class=&#34;item&#34;&gt;&lt;a class=&#34;fn url&#34; href=&#34;https://www.amazon.co.jp/dp/B0855LMP81?tag=baldandersinf-22&amp;amp;linkCode=ogi&amp;amp;th=1&amp;amp;psc=1&#34;&gt;Synology NASキット 2ベイ DS220j クアッドコアCPU 512MBメモリ搭載 ライトユーザー向け 国内正規代理店品 電話サポート対応品 DiskStation&lt;/a&gt;&lt;/dt&gt;
    &lt;dd&gt;Synology (Release 2020-03-12)&lt;/dd&gt;
    &lt;dd&gt;Personal Computers&lt;/dd&gt;
    &lt;dd&gt;B0855LMP81 (ASIN), 4537694279369 (EAN), 0846504003440 (EAN), 846504003440 (UPC)&lt;/dd&gt;
    &lt;dd&gt;評価&lt;abbr class=&#34;rating fa-sm&#34; title=&#34;4&#34;&gt;&amp;nbsp;&lt;i class=&#34;fas fa-star&#34;&gt;&lt;/i&gt;&amp;nbsp;&lt;i class=&#34;fas fa-star&#34;&gt;&lt;/i&gt;&amp;nbsp;&lt;i class=&#34;fas fa-star&#34;&gt;&lt;/i&gt;&amp;nbsp;&lt;i class=&#34;fas fa-star&#34;&gt;&lt;/i&gt;&amp;nbsp;&lt;i class=&#34;far fa-star&#34;&gt;&lt;/i&gt;&lt;/abbr&gt;&lt;/dd&gt;
  &lt;/dl&gt;
  &lt;p class=&#34;description&#34;&gt;&lt;a href=&#34;https://www.dospara.co.jp/&#34;&gt;ドスパラ&lt;/a&gt;で HDD 2基と3点セットで購入。家庭内 LAN で使うなら必要十分な性能。各種クラウド・ストレージ・サービスと連携可能。 Tailscale を含む各種 VPN と組み合わせることも可能。&lt;/p&gt;
  &lt;p class=&#34;powered-by&#34;&gt;reviewed by &lt;a href=&#39;#maker&#39; class=&#39;reviewer&#39;&gt;Spiegel&lt;/a&gt; on &lt;abbr class=&#34;dtreviewed&#34; title=&#34;2021-10-26&#34;&gt;2021-10-26&lt;/abbr&gt; (powered by &lt;a href=&#34;https://affiliate.amazon.co.jp/assoc_credentials/home&#34;&gt;PA-APIv5&lt;/a&gt;)&lt;/p&gt;
&lt;/div&gt; &lt;!-- Synology DS220j --&gt;
&lt;div class=&#34;hreview&#34;&gt;
  &lt;div class=&#34;photo&#34;&gt;&lt;a href=&#34;https://www.amazon.co.jp/dp/B08V8LNR2H?tag=baldandersinf-22&amp;amp;linkCode=ogi&amp;amp;th=1&amp;amp;psc=1&#34;&gt;&lt;img src=&#34;https://m.media-amazon.com/images/I/41&amp;#43;wOkdJItL._SL160_.jpg&#34; width=&#34;160&#34; alt=&#34;photo&#34;&gt;&lt;/a&gt;&lt;/div&gt;
  &lt;dl&gt;
    &lt;dt class=&#34;item&#34;&gt;&lt;a class=&#34;fn url&#34; href=&#34;https://www.amazon.co.jp/dp/B08V8LNR2H?tag=baldandersinf-22&amp;amp;linkCode=ogi&amp;amp;th=1&amp;amp;psc=1&#34;&gt;Western Digital ウエスタンデジタル 内蔵 HDD WD Red Plus NAS RAID (CMR) 3.5インチ WD40EFZX-EC 【国内正規代理店品】&lt;/a&gt;&lt;/dt&gt;
    &lt;dd&gt;ウエスタンデジタル(Western Digital) (Release 2021-02-05)&lt;/dd&gt;
    &lt;dd&gt;Personal Computers&lt;/dd&gt;
    &lt;dd&gt;B08V8LNR2H (ASIN), 4988755057738 (EAN)&lt;/dd&gt;
    &lt;dd&gt;評価&lt;abbr class=&#34;rating fa-sm&#34; title=&#34;4&#34;&gt;&amp;nbsp;&lt;i class=&#34;fas fa-star&#34;&gt;&lt;/i&gt;&amp;nbsp;&lt;i class=&#34;fas fa-star&#34;&gt;&lt;/i&gt;&amp;nbsp;&lt;i class=&#34;fas fa-star&#34;&gt;&lt;/i&gt;&amp;nbsp;&lt;i class=&#34;fas fa-star&#34;&gt;&lt;/i&gt;&amp;nbsp;&lt;i class=&#34;far fa-star&#34;&gt;&lt;/i&gt;&lt;/abbr&gt;&lt;/dd&gt;
  &lt;/dl&gt;
  &lt;p class=&#34;description&#34;&gt;&lt;a href=&#34;https://www.synology.com/ja-jp/products/DS220j&#34;&gt;Synology DS220j&lt;/a&gt; と併せて購入。&lt;/p&gt;
  &lt;p class=&#34;powered-by&#34;&gt;reviewed by &lt;a href=&#39;#maker&#39; class=&#39;reviewer&#39;&gt;Spiegel&lt;/a&gt; on &lt;abbr class=&#34;dtreviewed&#34; title=&#34;2021-10-26&#34;&gt;2021-10-26&lt;/abbr&gt; (powered by &lt;a href=&#34;https://affiliate.amazon.co.jp/assoc_credentials/home&#34;&gt;PA-APIv5&lt;/a&gt;)&lt;/p&gt;
&lt;/div&gt; &lt;!-- HDD WD Red Plus --&gt;
&lt;div class=&#34;hreview&#34;&gt;
  &lt;div class=&#34;photo&#34;&gt;&lt;a href=&#34;https://www.amazon.co.jp/dp/B09GS5ZCHN?tag=baldandersinf-22&amp;amp;linkCode=ogi&amp;amp;th=1&amp;amp;psc=1&#34;&gt;&lt;img src=&#34;https://m.media-amazon.com/images/I/51FF8hiCp8L._SL160_.jpg&#34; width=&#34;160&#34; alt=&#34;photo&#34;&gt;&lt;/a&gt;&lt;/div&gt;
  &lt;dl&gt;
    &lt;dt class=&#34;item&#34;&gt;&lt;a class=&#34;fn url&#34; href=&#34;https://www.amazon.co.jp/dp/B09GS5ZCHN?tag=baldandersinf-22&amp;amp;linkCode=ogi&amp;amp;th=1&amp;amp;psc=1&#34;&gt;Voice of Angel&lt;/a&gt;&lt;/dt&gt;
    &lt;dd&gt;太田貴子 (メインアーティスト)&lt;/dd&gt;
    &lt;dd&gt;SOLID RECORDS 2021-10-20 (Release 2021-10-20)&lt;/dd&gt;
    &lt;dd&gt;MP3 ダウンロード&lt;/dd&gt;
    &lt;dd&gt;B09GS5ZCHN (ASIN)&lt;/dd&gt;
    &lt;dd&gt;評価&lt;abbr class=&#34;rating fa-sm&#34; title=&#34;5&#34;&gt;&amp;nbsp;&lt;i class=&#34;fas fa-star&#34;&gt;&lt;/i&gt;&amp;nbsp;&lt;i class=&#34;fas fa-star&#34;&gt;&lt;/i&gt;&amp;nbsp;&lt;i class=&#34;fas fa-star&#34;&gt;&lt;/i&gt;&amp;nbsp;&lt;i class=&#34;fas fa-star&#34;&gt;&lt;/i&gt;&amp;nbsp;&lt;i class=&#34;fas fa-star&#34;&gt;&lt;/i&gt;&lt;/abbr&gt;&lt;/dd&gt;
  &lt;/dl&gt;
  &lt;p class=&#34;description&#34;&gt;「太田貴子」としては31年ぶりのアルバムらしい。仕事中にヘヴィローテーションしてます。&lt;/p&gt;
  &lt;p class=&#34;powered-by&#34;&gt;reviewed by &lt;a href=&#39;#maker&#39; class=&#39;reviewer&#39;&gt;Spiegel&lt;/a&gt; on &lt;abbr class=&#34;dtreviewed&#34; title=&#34;2021-10-26&#34;&gt;2021-10-26&lt;/abbr&gt; (powered by &lt;a href=&#34;https://affiliate.amazon.co.jp/assoc_credentials/home&#34;&gt;PA-APIv5&lt;/a&gt;)&lt;/p&gt;
&lt;/div&gt; &lt;!-- Voice of Angel (太田貴子) --&gt;
</content>
	</entry><entry>
		<title>CIFS 経由で NAS に接続する</title>
		<link rel="alternate" type="text/html" href="https://text.baldanders.info/remark/2019/03/common-internet-file-system/" />
		<id>tag:text.Baldanders.info,2019-03-31:/remark/2019/03/common-internet-file-system/</id>
		<published>2019-03-31T11:24:45+00:00</published>
		<updated>2021-05-09T05:34:56+00:00</updated>
		<summary>今回は CIFS (Common Internet File System) クライアントを使って NAS に接続を試みる。</summary>
		<author>
			<name>Spiegel</name>
			<uri>https://baldanders.info/profile/</uri>
		</author>
		
	<link rel="cc:license" type="application/rdf+xml" href="https://creativecommons.org/licenses/by-sa/4.0/rdf" />


		<content type="html" xml:lang="ja" xml:base="https://text.baldanders.info/">&lt;p&gt;&lt;a href=&#34;https://www.ubuntu.com/&#34; title=&#34;The leading operating system for PCs, IoT devices, servers and the cloud | Ubuntu&#34;&gt;Ubuntu&lt;/a&gt; から&lt;a href=&#34;https://text.baldanders.info/remark/2018/04/nas/&#34; title=&#34;NAS を導入した&#34;&gt;自宅の簡易 NAS&lt;/a&gt; に接続することを考える。&lt;/p&gt;
&lt;p&gt;相手の NAS には &lt;a href=&#34;https://www.samba.org/&#34; title=&#34;Samba - opening windows to a wider world&#34;&gt;Samba&lt;/a&gt; サーバとして接続できることは分かっているので，こちらは対応するクライアント・ツールを用意すればいいわけだ。&lt;/p&gt;
&lt;p&gt;というわけで今回は CIFS (Common Internet File System) クライアントを使って接続を試みる。&lt;/p&gt;
&lt;h2&gt;CIFS クライアントの導入&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.ubuntu.com/&#34; title=&#34;The leading operating system for PCs, IoT devices, servers and the cloud | Ubuntu&#34;&gt;Ubuntu&lt;/a&gt; であれば APT (Advanced Package Tool) で導入できる。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;$ sudo apt install cifs-utils
パッケージリストを読み込んでいます... 完了
依存関係ツリーを作成しています                
状態情報を読み取っています... 完了
提案パッケージ:
  keyutils smbclient winbind
以下のパッケージが新たにインストールされます:
  cifs-utils
アップグレード: 0 個、新規インストール: 1 個、削除: 0 個、保留: 0 個。
71.5 kB のアーカイブを取得する必要があります。
この操作後に追加で 231 kB のディスク容量が消費されます。
取得:1 http://jp.archive.ubuntu.com/ubuntu cosmic/main amd64 cifs-utils amd64 2:6.8-2 [71.5 kB]
71.5 kB を 1秒 で取得しました (104 kB/s)
以前に未選択のパッケージ cifs-utils を選択しています。
(データベースを読み込んでいます ... 現在 167532 個のファイルとディレクトリがインストールされています。)
.../cifs-utils_2%3a6.8-2_amd64.deb を展開する準備をしています ...
cifs-utils (2:6.8-2) を展開しています...
cifs-utils (2:6.8-2) を設定しています ...
update-alternatives: /etc/cifs-utils/idmap-plugin (idmap-plugin) を提供するために自動モードで /usr/lib/x86_64-linux-gnu/cifs-utils/idmapwb.so を使います
man-db (2.8.4-2) のトリガを処理しています ...

$ mount.cifs -V
mount.cifs version: 6.8
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;バージョンは 6.8 か。&lt;/p&gt;
&lt;h2&gt;事前準備（2019-04-03 追記）&lt;/h2&gt;
&lt;p&gt;実際に作業に入る前にいくつか事前設定をしておく。&lt;/p&gt;
&lt;h3&gt;ホスト名の解決&lt;/h3&gt;
&lt;p&gt;IP アドレス指定のままでもいいのだが，もし LAN 内で NAS の名前解決が出来ないなら &lt;code&gt;/etc/hosts&lt;/code&gt; ファイルで名前を定義しておくといいだろう。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;10.0.0.100  nas01
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3&gt;Samba グループを作成する&lt;/h3&gt;
&lt;p&gt;共有ディレクトリをマウントできるグループを作成する。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;$ sudo groupadd samba
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;さらに&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;$ sudo visudo
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;で &lt;code&gt;sudo&lt;/code&gt; 用の設定ファイルを開き以下の行を追加する。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;%samba  ALL=(ALL) /bin/mount,/bin/umount,/sbin/mount.cifs,/sbin/umount.cifs
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;これで &lt;code&gt;samba&lt;/code&gt; グループに追加したユーザは自身のホーム・ディレクトリ以下に NAS の共有ディレクトリをマウントできる。
さっそく追加しておこう。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;$ sudo adduser username samba
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;これで準備完了。&lt;/p&gt;
&lt;h2&gt;一時的な接続&lt;/h2&gt;
&lt;p&gt;まずマウント先のディレクトリを作成する（ディレクトリの場所や名前は他と被らなければなんでもいい）。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;$ mkdir ~/nas
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;この &lt;code&gt;~/nas&lt;/code&gt; ディレクトリに対して以下のコマンドを実行する。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;sudo mount -t cifs //nas01/shared ~/nas -o username=sambauser,noexec,nosuid,nodev
[sudo] username のパスワード: 
Password for sambauser@//nas01/shared:  ********
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;これで &lt;code&gt;~/nas&lt;/code&gt; ディレクトリに対して共有ディレクトリ &lt;code&gt;//nas01/shared&lt;/code&gt; を一時的にマウントできる。
マウント時に指定できる主なパラメータ（値がある場合は &lt;code&gt;param=value&lt;/code&gt; 形式で指定）は以下の通り&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;パラメータ名&lt;/th&gt;
&lt;th&gt;既定値&lt;/th&gt;
&lt;th&gt;内容&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;username&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;root&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;接続先のユーザ名&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;password&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;接続先ユーザのパスワード。指定しない場合は接続時に訊いてくる&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;domain&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;接続先のドメイン名またはワークグループ名（必要な場合のみ）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;credentials&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;接続情報が書かれたファイル（詳しくは後述する）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;uid&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;root&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;共有ディレクトリ・ファイルの（見かけの）オーナー名&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;gid&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;root&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;共有ディレクトリ・ファイルの（見かけの）グループ名&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;file_mode&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;0755&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;共有ファイルの（見かけの）ファイルモード&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;dir_mode&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;0755&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;共有ディレクトリの（見かけの）ディレクトリモード&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;vers&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;3.0&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;SMB プロトコル・バージョン（&lt;code&gt;1.0&lt;/code&gt;/&lt;code&gt;2.0&lt;/code&gt;/&lt;code&gt;3.0&lt;/code&gt;/&lt;code&gt;3.1.1&lt;/code&gt;）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;sec&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ntlmssp&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;セキュリティ・モード (&lt;code&gt;none&lt;/code&gt;/&lt;code&gt;krb5&lt;/code&gt;/&lt;code&gt;krb5i&lt;/code&gt;/&lt;code&gt;ntlm&lt;/code&gt;/&lt;code&gt;ntlmi&lt;/code&gt;/&lt;code&gt;ntlmv2&lt;/code&gt;/&lt;code&gt;ntlmv2i&lt;/code&gt;/&lt;code&gt;ntlmssp&lt;/code&gt;/&lt;code&gt;ntlmsspi&lt;/code&gt;)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;noexec&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;―&lt;/td&gt;
&lt;td&gt;共有ディレクトリ上のファイルの実行をさせない&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;nosuid&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;―&lt;/td&gt;
&lt;td&gt;共有ディレクトリ・ファイルの SUID ビットを認識しない&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;nodev&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;―&lt;/td&gt;
&lt;td&gt;共有ディレクトリ上のデバイスファイルを作用させない&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ro&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;―&lt;/td&gt;
&lt;td&gt;読み込み専用でマウントする&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;rw&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;―&lt;/td&gt;
&lt;td&gt;読み書き可でマウントする&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;コマンドラインでマウントする際は絶対に &lt;code&gt;password&lt;/code&gt; オプションを付けないこと（履歴に残っちゃうからね）。
あるいは以下の内容の接続情報ファイル &lt;code&gt;~/.nascred&lt;/code&gt; を作って（ファイル名は適当）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;username=sambauser
password=password_string
domain=domainname
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ファイルモードを &lt;code&gt;0400&lt;/code&gt; に設定して他ユーザから見られないようにし&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;$ sudo chamod 0400 ~/.nascred
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;credentials&lt;/code&gt; オプションで指定してマウントする。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;sudo mount -t cifs //nas01/shared ~/nas -o credentials=~/.nascred,noexec,nosuid,nodev
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;他ユーザから見えなくてもパスワードを平文で保存するのはちょっと&amp;hellip; という人は &lt;code&gt;password&lt;/code&gt; の指定行を外してしまえばコマンド実行時にパスワードを訊いてくる。&lt;/p&gt;
&lt;p&gt;マウントを解除するには&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;$ sudo umount ~/nas
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;で OK。&lt;/p&gt;
&lt;h2&gt;/etc/fstab を使って起動時にマウントする&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;/etc/fstab&lt;/code&gt; ファイルに以下の行を追加することで起動時に共有ファイルをマウントできる。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;# &amp;lt;file system&amp;gt; &amp;lt;mount point&amp;gt;      &amp;lt;type&amp;gt; &amp;lt;options&amp;gt;                                                 &amp;lt;dump&amp;gt; &amp;lt;pass&amp;gt;
//nas01/shared  /home/username/nas cifs   _netdev,credentials=/home/username/.nascred,noexec,nosuid 0      0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ちなみに &lt;code&gt;_netdev&lt;/code&gt; はネットワークの設定が終わったあとにマウントするよう指示するオプションである（先頭のアンダーバーを忘れずに）。&lt;/p&gt;
&lt;p&gt;起動時のマウントではないが以下の2つのオプションを追加する手もある。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;パラメータ名&lt;/th&gt;
&lt;th&gt;内容&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;noauto&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;起動時にはマウントを行わない&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;user&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;一般ユーザもマウントできる&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;# &amp;lt;file system&amp;gt; &amp;lt;mount point&amp;gt;      &amp;lt;type&amp;gt; &amp;lt;options&amp;gt;                                                     &amp;lt;dump&amp;gt; &amp;lt;pass&amp;gt;
//nas01/shared  /home/username/nas cifs   noauto,user,credentials=/home/username/.nascred,noexec,nosuid 0      0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;これなら管理者モードでなくともログイン後に任意のタイミングで&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;$ mount ~/nas
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;という感じにコマンドラインを少し簡略化してマウントできる（&lt;code&gt;umount&lt;/code&gt; も同様）。&lt;/p&gt;
&lt;p&gt;よし。
これで次に進める。
次は &lt;a href=&#34;https://gnupg.org/&#34; title=&#34;The GNU Privacy Guard&#34;&gt;GnuPG&lt;/a&gt; かな。&lt;/p&gt;
&lt;h2&gt;ブックマーク&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://www.samba.gr.jp/project/translation/3.5/htmldocs/manpages-3/mount.cifs.8.html&#34;&gt;mount.cifs&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://help.ubuntu.com/community/Samba/SambaClientGuide&#34;&gt;Samba/SambaClientGuide - Community Help Wiki&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.profaim.jp/tools/soft/linux/mnt_cifs.php&#34;&gt;mountコマンドでCIFSをファイル共有 - profaim.jp&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://qiita.com/kakinaguru_zo/items/af0122f79af0aa0913b7&#34;&gt;mount.cifsに付けるオプション - Qiita&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://qiita.com/mdstoy/items/54925cdcbca6d558b666&#34;&gt;Ubuntu から Windows の共有フォルダをマウントして利用する - Qiita&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://qiita.com/You_name_is_YU/items/85ffbffee744f6f494ed&#34;&gt;samba-client／cifs-utilsを使ってWindowsの共有フォルダをマウントする - Qiita&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://qiita.com/office-itou/items/0f8df0c5f8c7022b7fad&#34;&gt;Windows 10 に cifs 接続する - Qiita&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.atmarkit.co.jp/ait/articles/1502/13/news042.html&#34;&gt;Linuxはサンバ（Samba）で踊る――WindowsとLinuxのファイル共有のいま (1/2)：その知識、ホントに正しい？ Windowsにまつわる都市伝説（25） - ＠IT&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://wiki.archlinux.jp/index.php/Fstab&#34;&gt;fstab - ArchWiki&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;参考図書&lt;/h2&gt;
&lt;div class=&#34;hreview&#34;&gt;
  &lt;div class=&#34;photo&#34;&gt;&lt;a href=&#34;https://www.amazon.co.jp/dp/B01CXL8NL6?tag=baldandersinf-22&amp;amp;linkCode=ogi&amp;amp;th=1&amp;amp;psc=1&#34;&gt;&lt;img src=&#34;https://m.media-amazon.com/images/I/51zK0JJz6ZL._SL160_.jpg&#34; width=&#34;112&#34; alt=&#34;photo&#34;&gt;&lt;/a&gt;&lt;/div&gt;
  &lt;dl&gt;
    &lt;dt class=&#34;item&#34;&gt;&lt;a class=&#34;fn url&#34; href=&#34;https://www.amazon.co.jp/dp/B01CXL8NL6?tag=baldandersinf-22&amp;amp;linkCode=ogi&amp;amp;th=1&amp;amp;psc=1&#34;&gt;【改訂新版】サーバ構築の実例がわかるSamba［実践］入門&lt;/a&gt;&lt;/dt&gt;
    &lt;dd&gt;髙橋基信 (著)&lt;/dd&gt;
    &lt;dd&gt;技術評論社 2016-03-04 (Release 2016-03-04)&lt;/dd&gt;
    &lt;dd&gt;Kindle版&lt;/dd&gt;
    &lt;dd&gt;B01CXL8NL6 (ASIN)&lt;/dd&gt;
  &lt;/dl&gt;
  &lt;p class=&#34;description&#34;&gt;Samba4/Windows10 対応。昔に比べたら Samba もずいぶん変わったんだねぇ。&lt;/p&gt;
  &lt;p class=&#34;powered-by&#34;&gt;reviewed by &lt;a href=&#39;#maker&#39; class=&#39;reviewer&#39;&gt;Spiegel&lt;/a&gt; on &lt;abbr class=&#34;dtreviewed&#34; title=&#34;2019-03-31&#34;&gt;2019-03-31&lt;/abbr&gt; (powered by &lt;a href=&#34;https://affiliate.amazon.co.jp/assoc_credentials/home&#34;&gt;PA-APIv5&lt;/a&gt;)&lt;/p&gt;
&lt;/div&gt; &lt;!-- 【改訂新版】サーバ構築の実例がわかるSamba［実践］入門 --&gt;
&lt;section class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;オプションの詳細は &lt;code&gt;man mount.cifs&lt;/code&gt; でマニュアルを参照するとよい。&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;
</content>
	</entry><entry>
		<title>NAS を導入した</title>
		<link rel="alternate" type="text/html" href="https://text.baldanders.info/remark/2018/04/nas/" />
		<id>tag:text.Baldanders.info,2018-04-30:/remark/2018/04/nas/</id>
		<published>2018-04-30T06:32:40+00:00</published>
		<updated>2020-01-05T11:59:50+00:00</updated>
		<summary>Win7 のサポートが切れる2020年までに Windows は捨てる予定なので，今回の NAS 導入はその前準備というところである。</summary>
		<author>
			<name>Spiegel</name>
			<uri>https://baldanders.info/profile/</uri>
		</author>
		
	<link rel="cc:license" type="application/rdf+xml" href="https://creativecommons.org/licenses/by-sa/4.0/rdf" />


		<content type="html" xml:lang="ja" xml:base="https://text.baldanders.info/">&lt;p&gt;GW に突入して最初の作業は NAS (Network-Attached Storage) の導入だった。
つっても，今までパソコンの「外付けハードディスク」として使っていたものを家庭内 LAN 上で使えるようにしただけなのだが。
ストレージは増設して 2TB に。
つか，安い簡易 NAS に件の外付け HDD を組み込んだという方が正しいかな。&lt;/p&gt;
&lt;p&gt;大昔は職場で減価償却の終わった古い PC を安く譲ってもらって Linux をぶち込んでたりしたのだが，そういうのもすっかり面倒くさくなって（今は PC を捨てるのにもお金かかるしねぇ），というかサーバ立てて実験するならクラウド・サービスを使うほうが早い。
実験用としても自宅でフルスクラッチでサーバを組むメリットはなくなっている（ラズパイ等で遊ぶのならありだろうが）。&lt;/p&gt;
&lt;p&gt;とりあえず Windows 7 と Android 携帯端末から &lt;a href=&#34;https://www.samba.org/&#34; title=&#34;Samba - opening windows to a wider world&#34;&gt;Samba&lt;/a&gt; 経由で NAS にアクセスできることは確認したので問題ないかな。
日本語ファイル名のモノがかなりあって心配したのだが，最近のは優秀なんだねぇ。
アクセス制御を含む各種設定も Web ブラウザでできるし。
Box や Dropbox といったクラウドストレージとも連携できるし。&lt;/p&gt;
&lt;p&gt;Win7 のサポートが切れる2020年までに Windows は捨てる予定なので&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;，今回の NAS 導入はその前準備というところである。
ここのところの Windows 関連の脆弱性情報を見るに Microsoft は既に Win7 にリソースを割いてない（割けない）印象を受ける。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://forest.watch.impress.co.jp/docs/news/1114999.html&#34;&gt;「KB4099950」が公開、3月パッチでWindows 7のネットワーク設定が失われる問題を修正 - 窓の杜&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://japan.zdnet.com/article/35118231/&#34;&gt;IEに脆弱性、ゼロデイ攻撃に悪用と指摘 - ZDNet Japan&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ひょっとして予定を前倒ししたほうがいいかも。&lt;/p&gt;
&lt;h2&gt;ブックマーク&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://play.google.com/store/apps/details?id=com.skyjos.apps.fileexplorer&#34;&gt;File Explorer Pro - file manager and file transfer - Google Play&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;参考図書&lt;/h2&gt;
&lt;div class=&#34;hreview&#34;&gt;
  &lt;div class=&#34;photo&#34;&gt;&lt;a href=&#34;https://www.amazon.co.jp/dp/B079YJS1J1?tag=baldandersinf-22&amp;amp;linkCode=ogi&amp;amp;th=1&amp;amp;psc=1&#34;&gt;&lt;img src=&#34;https://m.media-amazon.com/images/I/51CPvtuv&amp;#43;wL._SL160_.jpg&#34; width=&#34;123&#34; alt=&#34;photo&#34;&gt;&lt;/a&gt;&lt;/div&gt;
  &lt;dl&gt;
    &lt;dt class=&#34;item&#34;&gt;&lt;a class=&#34;fn url&#34; href=&#34;https://www.amazon.co.jp/dp/B079YJS1J1?tag=baldandersinf-22&amp;amp;linkCode=ogi&amp;amp;th=1&amp;amp;psc=1&#34;&gt;［試して理解］Linuxのしくみ ～実験と図解で学ぶOSとハードウェアの基礎知識&lt;/a&gt;&lt;/dt&gt;
    &lt;dd&gt;武内 覚 (著)&lt;/dd&gt;
    &lt;dd&gt;技術評論社 2018-02-23 (Release 2018-02-23)&lt;/dd&gt;
    &lt;dd&gt;Kindle版&lt;/dd&gt;
    &lt;dd&gt;B079YJS1J1 (ASIN)&lt;/dd&gt;
    &lt;dd&gt;評価&lt;abbr class=&#34;rating fa-sm&#34; title=&#34;4&#34;&gt;&amp;nbsp;&lt;i class=&#34;fas fa-star&#34;&gt;&lt;/i&gt;&amp;nbsp;&lt;i class=&#34;fas fa-star&#34;&gt;&lt;/i&gt;&amp;nbsp;&lt;i class=&#34;fas fa-star&#34;&gt;&lt;/i&gt;&amp;nbsp;&lt;i class=&#34;fas fa-star&#34;&gt;&lt;/i&gt;&amp;nbsp;&lt;i class=&#34;far fa-star&#34;&gt;&lt;/i&gt;&lt;/abbr&gt;&lt;/dd&gt;
  &lt;/dl&gt;
  &lt;p class=&#34;description&#34;&gt;コンテナ全盛のこの時代にかなり硬派な内容の Linux 解説書。コンピュータの教科書としても使えそう。&lt;/p&gt;
  &lt;p class=&#34;powered-by&#34;&gt;reviewed by &lt;a href=&#39;#maker&#39; class=&#39;reviewer&#39;&gt;Spiegel&lt;/a&gt; on &lt;abbr class=&#34;dtreviewed&#34; title=&#34;2019-01-07&#34;&gt;2019-01-07&lt;/abbr&gt; (powered by &lt;a href=&#34;https://affiliate.amazon.co.jp/assoc_credentials/home&#34;&gt;PA-APIv5&lt;/a&gt;)&lt;/p&gt;
&lt;/div&gt; &lt;!-- ［試して理解］Linuxのしくみ --&gt;
&lt;section class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;Windows を捨てる理由は個人的な（Win8 以降に馴染めない）ものなので，今後も Windows を使い続けたいなら，なるべく早く Windows 10 に移行することを強くお勧めする。なお Windows はメジャー・バージョンを「アップグレード」する際にトラブルが起きやすいので，この際マシンごと買い換えるほうがいいと思う。&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;
</content>
	</entry>
</feed>
