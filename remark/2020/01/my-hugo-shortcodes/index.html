<!DOCTYPE html>
<html lang="ja">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="generator" content="Hugo 0.153.3">
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
<link rel="apple-touch-icon" type="image/png" sizes="144x144" href="/apple-icon-144x144.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/android-icon-192x192.png">
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="https://text.baldanders.info/remark/2020/01/my-hugo-shortcodes/">
<script defer src="/fa/js/all.min.js"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=BIZ+UDGothic:wght@400;700&family=BIZ+UDMincho:wght@400;700&family=Intel+One+Mono:wght@400;700&family=Noto+Color+Emoji&family=Noto+Sans:wght@400;700&family=Noto+Serif+Hentaigana:wght@400;700&family=Noto+Serif:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="/css/local-font.css" type='text/css'>
<link rel="stylesheet" href="/css/baldanders-info-dark.css" type='text/css'>

<link rel="alternate" href="https://text.baldanders.info/index.xml" type="application/rss+xml" title="text.Baldanders.info">
<link rel="alternate" href="https://text.baldanders.info/index.json" type="application/json" title="text.Baldanders.info">
<meta name="google-site-verification" content="jTjBCslPtf8gwVatiY-GDgGv7pV5csa8aUOw1MRPUD4">
<link rel="me" href="https://fedibird.com/@spiegel">
<title>ぼくがかんがえたさいきょうの Hugo Shortcodes [text.Baldanders.info]</title>
<meta property="og:title" content="ぼくがかんがえたさいきょうの Hugo Shortcodes">
<meta name="description" content="Hugo 0.62 用に自作 shortcode を整理した。以下にいくつか紹介しておこう。">
<meta property="og:description" content="Hugo 0.62 用に自作 shortcode を整理した。以下にいくつか紹介しておこう。">
<meta property="og:image" content="https://text.baldanders.info/images/attention/kitten.jpg">
<meta name="author" content="Spiegel">


<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@spiegel_2007">
<meta name="twitter:creator" content="@spiegel_2007">
<link rel="me" href="https://goark.fedicity.net/@spiegel">
<meta name="keywords" content="hugo, shortcodes, site">
<link rel='prev' href='https://text.baldanders.info/remark/2020/01/our-decade/' title='私達の10年'>
<link rel='next' href='https://text.baldanders.info/remark/2020/01/review-database-with-hugo/' title='Hugo で簡易データベースを構成する'>

<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "WebSite",
	"@id": "https://text.baldanders.info/",
	"inLanguage": "ja",
	"name": "text.Baldanders.info",
    "url": "https://text.baldanders.info/",
	"publisher": {
		"@id": "https://text.baldanders.info/#org"
	},
	"author": {
		"@id": "https://text.baldanders.info/#maker"
	},
	"image": "https://text.baldanders.info/images/attention/site.jpg",
	"description": "帰ってきた「しっぽのさきっちょ」"
}
</script>
<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "Organization",
	"@id": "https://text.baldanders.info/#org",
	"name": "Spiegel",
	"logo": {
		"@type": "ImageObject",
		"@id": "https://text.baldanders.info/#logo",
		"url": "https://text.baldanders.info/images/avatar.jpg"
	}
}
</script>
<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "Person",
	"@id": "https://text.baldanders.info/#maker",
	"name": "Spiegel",
	"url": "https://baldanders.info/profile/",
	"image": "https://text.baldanders.info/images/avatar.jpg"
}
</script>
<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "Blog",
	"@id": "https://text.baldanders.info/remark/",
	"url": "https://text.baldanders.info/remark/",
	"inLanguage": "ja",
	"name": "しっぽのさきっちょ",
	"description": "帰ってきた「しっぽのさきっちょ」。とりとめのない四方山話。",
	"image": "https://text.baldanders.info/images/attention/remark.jpg",
	"publisher": {
		"@id": "https://text.baldanders.info/#org"
	},
	"author": {
		"@id": "https://text.baldanders.info/#maker"
	}
}
</script>
<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "BreadcrumbList",
	"@id": "https://text.baldanders.info/remark/2020/01/my-hugo-shortcodes/#breadcrumb-list",
	"itemListElement": [
		{
			"@type": "ListItem",
			"position": 1,
			"item": {
				"@id": "https://text.baldanders.info/"
			}
		},
		{
			"@type": "ListItem",
			"position": 2,
			"item": {
				"@id": "https://text.baldanders.info/remark/"
			}
		}
	]
}
</script>
<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "BlogPosting",
	"@id": "https://text.baldanders.info/remark/2020/01/my-hugo-shortcodes/",
	"url": "https://text.baldanders.info/remark/2020/01/my-hugo-shortcodes/",
	"mainEntityOfPage": "https://text.baldanders.info/remark/2020/01/my-hugo-shortcodes/",
	"inLanguage": "ja",
	"name": "ぼくがかんがえたさいきょうの Hugo Shortcodes",
	"description": "Hugo 0.62 用に自作 shortcode を整理した。以下にいくつか紹介しておこう。",
	"headline": "Hugo 0.62 用に自作 shortcode を整理した。以下にいくつか紹介しておこう。",
	"keywords": "hugo, shortcodes, site",
	"image": "https://text.baldanders.info/images/attention/kitten.jpg",
	"datePublished": "2020-01-03T06:02:51+00:00",
	"dateModified": "2020-02-18T11:47:08+00:00",
	"publisher": {
		"@id": "https://text.baldanders.info/#org"
	},
	"author": {
		"@id": "https://text.baldanders.info/#maker"
	},
	"license": "https://creativecommons.org/licenses/by-sa/4.0/"
}
</script>
</head>
<body>

<div id='container'>

<main>
<nav class="breadcrumb">
<a href="https://text.baldanders.info/">text.Baldanders.info</a> &raquo; <a href="/remark/">しっぽのさきっちょ</a>
</nav>
<article>
<h1>ぼくがかんがえたさいきょうの Hugo Shortcodes</h1>
<nav class="tags">
	<div><a href='/tags/'>Tags</a>: #<a href="/tags/hugo/">hugo</a> #<a href="/tags/shortcodes/">shortcodes</a> #<a href="/tags/site/">site</a></div>
	<div class="cloud">
		<span class="share-color" title="Share this entry"><i class="fa-solid fa-share-from-square"></i></span>&nbsp;:
		&nbsp;<a href="https://getpocket.com/edit?url=https%3a%2f%2ftext.baldanders.info%2fremark%2f2020%2f01%2fmy-hugo-shortcodes%2f&amp;title=%e3%81%bc%e3%81%8f%e3%81%8c%e3%81%8b%e3%82%93%e3%81%8c%e3%81%88%e3%81%9f%e3%81%95%e3%81%84%e3%81%8d%e3%82%87%e3%81%86%e3%81%ae%20Hugo%20Shortcodes" target="_blank"><span class="pocket-color"><abbr title="Share Pocket"><i class="fab fa-get-pocket" aria-hidden="true"></i></abbr></span></a>
		&nbsp;<a href="http://www.facebook.com/share.php?u=https%3a%2f%2ftext.baldanders.info%2fremark%2f2020%2f01%2fmy-hugo-shortcodes%2f" target="_blank"><span class="facebook-color"><abbr title="Share facebook"><i class="fab fa-square-facebook" aria-hidden="true"></i></abbr></span></a>
		&nbsp;<a href="http://x.com/intent/post?text=%e3%81%bc%e3%81%8f%e3%81%8c%e3%81%8b%e3%82%93%e3%81%8c%e3%81%88%e3%81%9f%e3%81%95%e3%81%84%e3%81%8d%e3%82%87%e3%81%86%e3%81%ae%20Hugo%20Shortcodes+by+@spiegel_2007&amp;url=https%3a%2f%2ftext.baldanders.info%2fremark%2f2020%2f01%2fmy-hugo-shortcodes%2f" target="_blank"><span class="x-twitter-color"><abbr title="Share Twitter"><i class="fa-brands fa-square-x-twitter" aria-hidden="true"></i></abbr></span></a>
		&nbsp;<a href="https://donshare.net/share.html?text=%e3%81%bc%e3%81%8f%e3%81%8c%e3%81%8b%e3%82%93%e3%81%8c%e3%81%88%e3%81%9f%e3%81%95%e3%81%84%e3%81%8d%e3%82%87%e3%81%86%e3%81%ae%20Hugo%20Shortcodes+by+@spiegel%40goark.fedicity.net%20+https%3a%2f%2ftext.baldanders.info%2fremark%2f2020%2f01%2fmy-hugo-shortcodes%2f" target="_blank"><span class="mastodon-color"><abbr title="Share Mastodon"><i class="fa-brands fa-mastodon" aria-hidden="true"></i></abbr></span></a>
	</div>
</nav>
<nav class="history">History in
  <a href="https://github.com/spiegel-im-spiegel/spiegel-im-spiegel.github.io/commits/master/remark/2020/01/my-hugo-shortcodes/index.html">GitHub Page</a>
</nav>

<section><div>
<div class="noextension">
<a href="https://baldanders.info/public-domain-locked/" title="Public Domain Locked... | Baldanders.info"><img src="/images/Locked-150.png" alt="no extension" width="150"></a>
</div>
<p>今回は <a href="https://gohugo.io/" title="The world’s fastest framework for building websites | Hugo">Hugo</a> に関する小ネタをいくつかお送りする。</p>
<p><a href="https://gohugo.io/" title="The world’s fastest framework for building websites | Hugo">Hugo</a> v0.60 から markdown パーサの既定が <a href="https://github.com/yuin/goldmark/" title="yuin/goldmark: A markdown parser written in Go. Easy to extend, standard(CommonMark) compliant, well structured.">yuin/goldmark</a> になった。</p>
<ul>
<li><a href="https://text.baldanders.info/release/2019/11/hugo-v0_60-with-goldmark-parser/">Hugo v0.60 から既定の Markdown パーサが Goldmark になったようだ</a></li>
</ul>
<p><a href="https://github.com/yuin/goldmark/" title="yuin/goldmark: A markdown parser written in Go. Easy to extend, standard(CommonMark) compliant, well structured.">yuin/goldmark</a> はきちんと <a href="https://commonmark.org/">CommonMark</a> に準拠していて，そこには好感が持てるのだが，見方を変えるとあまり融通の効かないパーサであるとも言える。
たとえば <a href="https://github.com/russross/blackfriday" title="russross/blackfriday: Blackfriday: a markdown processor for Go">russross/blackfriday</a> では設定で <code>target=&quot;_blank&quot;</code> や <code>rel=&quot;nofollow&quot;</code> といった属性値を <code>&lt;a&gt;</code> 要素に付与できたが， <a href="https://github.com/yuin/goldmark/" title="yuin/goldmark: A markdown parser written in Go. Easy to extend, standard(CommonMark) compliant, well structured.">yuin/goldmark</a> にはこれに対応するオプションがない。</p>
<h2><a href="https://gohugo.io/getting-started/configuration-markup/#markdown-render-hooks" title="Configure Markup | Hugo">Markdown Render Hooks</a></h2>
<p>そこで <a href="https://gohugo.io/" title="The world’s fastest framework for building websites | Hugo">Hugo</a> v0.62 で “<a href="https://gohugo.io/getting-started/configuration-markup/#markdown-render-hooks" title="Configure Markup | Hugo">Markdown Render Hooks</a>” という仕組みが用意された（<a href="https://github.com/yuin/goldmark/" title="yuin/goldmark: A markdown parser written in Go. Easy to extend, standard(CommonMark) compliant, well structured.">yuin/goldmark</a> パーサ使用時のみ有効）。
これは，簡単にいうと画像やリンクの HTML レンダリングを横取りして自前のテンプレートを差し込むものである。</p>
<p>例を挙げて説明しよう。</p>
<p>たとえば以下のような markdown 記述がある。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl">[<span class="nt">Hugo</span>](<span class="na">https://gohugo.io/ &#34;The world’s fastest framework for building websites&#34;</span>) はチョー簡単！
</span></span></code></pre></div><p>これに対して <a href="https://github.com/yuin/goldmark/" title="yuin/goldmark: A markdown parser written in Go. Easy to extend, standard(CommonMark) compliant, well structured.">yuin/goldmark</a> パーサを使って HTML レンダリングを行うと以下のようになる。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;https://gohugo.io/&#34;</span> <span class="na">title</span><span class="o">=</span><span class="s">&#34;The world’s fastest framework for building websites&#34;</span><span class="p">&gt;</span>Hugo<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> はチョー簡単！
</span></span></code></pre></div><p>この <code>&lt;a&gt;</code> 要素に属性値 <code>target=&quot;_blank&quot;</code> を付加することを考える。</p>
<p>まずは <a href="https://gohugo.io/" title="The world’s fastest framework for building websites | Hugo">Hugo</a> の環境で <code>layouts/_default/_markup</code> ディレクトリを作成し，その中に <code>render-link.html</code> ファイルを置く。
<code>render-link.html</code> ファイルの中身はこんな感じでどうだろう。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">&lt;a href=&#34;{{ .Destination | safeURL }}&#34; target=&#34;_blank&#34;{{ with .Title }} title=&#34;{{ . }}&#34;{{ end }}&gt;{{ .Text | safeHTML }}&lt;/a&gt;
</span></span></code></pre></div><p>これで先程の markdown 記述は</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;https://gohugo.io/&#34;</span> <span class="na">target</span><span class="o">=</span><span class="s">&#34;_blank&#34;</span> <span class="na">title</span><span class="o">=</span><span class="s">&#34;The world’s fastest framework for building websites&#34;</span><span class="p">&gt;</span>Hugo<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> はチョー簡単！
</span></span></code></pre></div><p>となった。
ちゃんと <code>target=&quot;_blank&quot;</code> が付加されているのがお分かりだろうか。</p>
<p>画像も同様にカスタマイズできる。
たとえば <code>layouts/_default/_markup/render-image.html</code> ファイルを用意して</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">&lt;img src=&#34;{{ .Destination | safeURL }}&#34; alt=&#34;{{ .PlainText }}&#34;{{ with .PlainText }} title=&#34;{{ . }}&#34;{{ end }}&gt;
</span></span></code></pre></div><p>としておけば</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl">![<span class="nt">avatar</span>](<span class="na">/images/avatar.jpg</span>)
</span></span></code></pre></div><p>という記述に対して</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;/images/avatar.jpg&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;avatar&#34;</span> <span class="na">title</span><span class="o">=</span><span class="s">&#34;avatar&#34;</span><span class="p">&gt;</span>
</span></span></code></pre></div><p>と <code>title</code> 属性を付加することができる。</p>
<p>なお <code>render-link.html</code> および <code>render-image.html</code> テンプレートファイルは1つのサイトについて（今のところ）ひとつずつしか定義でず，サイト全体に適用されてしまうので注意が必要だ（テンプレートの条件分け等の機能を使うことはできる）。</p>
<h2>.RenderString 関数</h2>
<p>任意の文字列を markdown テキストとして HTML 形式へレンダリングする関数としては <a href="https://gohugo.io/functions/markdownify/" title="markdownify | Hugo"><code>markdownify</code></a> があったが，新たに <a href="https://gohugo.io/" title="The world’s fastest framework for building websites | Hugo">Hugo</a> 0.62 で <a href="https://gohugo.io/functions/renderstring/" title=".RenderString | Hugo"><code>.RenderString</code></a> 関数が追加された。
これまでの <a href="https://gohugo.io/functions/markdownify/" title="markdownify | Hugo"><code>markdownify</code></a> 関数との違いは以下の通り。</p>
<ul>
<li><a href="https://gohugo.io/functions/renderstring/" title=".RenderString | Hugo"><code>.RenderString</code></a> 関数は <a href="https://gohugo.io/variables/page/" title="Page Variables | Hugo"><code>Page</code></a> 変数のメソッドとして実装されている</li>
<li>パーサを指定できる（既定値はそのページの形式とパーサ）
<ul>
<li>パーサが <a href="https://github.com/yuin/goldmark/" title="yuin/goldmark: A markdown parser written in Go. Easy to extend, standard(CommonMark) compliant, well structured.">yuin/goldmark</a> であれば <a href="https://gohugo.io/getting-started/configuration-markup/#markdown-render-hooks" title="Configure Markup | Hugo">Markdown Render Hooks</a> が適用される</li>
</ul>
</li>
<li>入力テキストを強制的にブロック要素として展開することができる</li>
</ul>
<p>たとえば <a href="https://orgmode.org/" title="Org mode for Emacs – Your Life in Plain Text">Org-mode</a> 形式による</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">{{ &#34;/italic org mode/&#34; | $.Page.RenderString (dict &#34;display&#34; &#34;block&#34; &#34;markup&#34; &#34;org&#34;) }}
</span></span></code></pre></div><p>という記述に対して</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">em</span><span class="p">&gt;</span>italic org mode<span class="p">&lt;/</span><span class="nt">em</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span></code></pre></div><p>などと展開される。</p>
<p>上の例のように，パラメータには <code>display</code> と <code>markup</code> があり（<a href="https://gohugo.io/functions/dict/" title="dict | Hugo"><code>dict</code></a> 関数を使って）連想配列にして渡す。</p>
<p><code>display</code> が取り得る値は以下の通り。</p>
<table>
  <thead>
      <tr>
          <th>display 値</th>
          <th>内容</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>inline</code></td>
          <td>既定値</td>
      </tr>
      <tr>
          <td><code>block</code></td>
          <td>インライン・テキストと推定される場合でも強制的に <code>&lt;p&gt;</code> などのブロック要素として展開する</td>
      </tr>
  </tbody>
</table>
<p><code>markup</code> が取り得る値は以下の通り。</p>
<table>
  <thead>
      <tr>
          <th>markup 値</th>
          <th>内容</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>markdown</code></td>
          <td>既定の markdown パーサ<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></td>
      </tr>
      <tr>
          <td><code>goldmark</code></td>
          <td>Markdown として <a href="https://github.com/yuin/goldmark/" title="yuin/goldmark: A markdown parser written in Go. Easy to extend, standard(CommonMark) compliant, well structured.">yuin/goldmark</a> パーサを使用</td>
      </tr>
      <tr>
          <td><code>blackfriday</code></td>
          <td>Markdown として <a href="https://github.com/russross/blackfriday" title="russross/blackfriday: Blackfriday: a markdown processor for Go">russross/blackfriday</a> パーサを使用</td>
      </tr>
      <tr>
          <td><code>org</code></td>
          <td><a href="https://orgmode.org/" title="Org mode for Emacs – Your Life in Plain Text">Org-mode</a> として <a href="https://github.com/niklasfasching/go-org" title="niklasfasching/go-org: Org mode parser with html &amp; pretty printed org rendering">niklasfasching/go-org</a> パーサを使用</td>
      </tr>
      <tr>
          <td><code>asciidoc</code></td>
          <td><a href="http://asciidoc.org/">AsciiDoc</a> として処理（要 <a href="http://asciidoc.org/">AsciiDoc</a> 環境）</td>
      </tr>
      <tr>
          <td><code>rst</code></td>
          <td><a href="https://docutils.sourceforge.io/rst.html" title="reStructuredText">reStructuredText</a> として処理（要 <a href="https://docutils.sourceforge.io/rst.html" title="reStructuredText">RST</a> 環境）</td>
      </tr>
      <tr>
          <td><code>pandoc</code></td>
          <td><a href="https://www.pandoc.org/">Pandoc</a> として処理（要 <a href="https://www.pandoc.org/">Pandoc</a> 環境）</td>
      </tr>
      <tr>
          <td><code>html</code></td>
          <td>素通し</td>
      </tr>
  </tbody>
</table>
<h2>ぼくがかんがえたさいきょうの <a href="https://gohugo.io/" title="The world’s fastest framework for building websites | Hugo">Hugo</a> Shortcodes</h2>
<p>以上を踏まえて自作 shortcode を整理した。
以下にいくつか紹介しておこう。</p>
<h3>ルビを振る</h3>
<p>まずは軽くルビを振るところから。</p>
<p><code>shortcodes/ruby.html</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">&lt;ruby&gt;&lt;rb&gt;{{ .Inner }}&lt;/rb&gt;&lt;rp&gt; (&lt;/rp&gt;&lt;rt&gt;{{ index .Params 0 }}&lt;/rt&gt;&lt;rp&gt;) &lt;/rp&gt;&lt;/ruby&gt;
</span></span></code></pre></div><p><em>入力：</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">{{&lt; ruby &#34;それはさておき&#34; &gt;}}閑話休題{{&lt; /ruby &gt;}}
</span></span></code></pre></div><p><em>出力：</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">ruby</span><span class="p">&gt;&lt;</span><span class="nt">rb</span><span class="p">&gt;</span>閑話休題<span class="p">&lt;/</span><span class="nt">rb</span><span class="p">&gt;&lt;</span><span class="nt">rp</span><span class="p">&gt;</span> (<span class="p">&lt;/</span><span class="nt">rp</span><span class="p">&gt;&lt;</span><span class="nt">rt</span><span class="p">&gt;</span>それはさておき<span class="p">&lt;/</span><span class="nt">rt</span><span class="p">&gt;&lt;</span><span class="nt">rp</span><span class="p">&gt;</span>) <span class="p">&lt;/</span><span class="nt">rp</span><span class="p">&gt;&lt;/</span><span class="nt">ruby</span><span class="p">&gt;</span>
</span></span></code></pre></div><div class="box"><ruby><rb>閑話休題</rb><rp> (</rp><rt>それはさておき</rt><rp>) </rp></ruby></div>
<h3>図を figure 要素で囲む</h3>
<p>実は <a href="https://gohugo.io/" title="The world’s fastest framework for building websites | Hugo">Hugo</a> の<a href="https://gohugo.io/content-management/shortcodes/#use-hugos-built-in-shortcodes" title="Shortcodes | Hugo">組み込み shortcode</a> に <code>figure</code> というのがあって図を <code>&lt;figure&gt;</code> 要素で囲んでキャプションを付けれるようになってるんだけど，作りが気に食わないので自作したのだった。</p>
<p><code>shortcodes/fig-img.html</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">&lt;figure style=&#39;margin:0 auto;text-align:center;&#39;&gt;
</span></span><span class="line"><span class="cl">{{ with .Get &#34;link&#34; }}&lt;a href=&#34;{{ . }}&#34;&gt;{{ end }}&lt;img src=&#34;{{ .Get &#34;src&#34; }}&#34; srcset=&#34;{{ .Get &#34;src&#34; }}{{ with .Get &#34;width&#34; }}{{ . }}{{ else }}500{{ end }}w&#34; sizes=&#34;(min-width:600px) 500px, 80vw&#34;{{ if .Get &#34;title&#34; }} alt=&#34;{{ .Get &#34;title&#34; }}&#34;{{ else if .Get &#34;alt&#34; }} alt=&#34;{{ .Get &#34;alt&#34; }}&#34;{{ else }} alt=&#34;&#34;{{ end }}&gt;{{ with .Get &#34;link&#34; }}&lt;/a&gt;{{ end }}{{ if .Get &#34;title&#34; }}
</span></span><span class="line"><span class="cl">&lt;figcaption&gt;{{ with .Get &#34;link&#34; }}&lt;a href=&#34;{{ . }}&#34;&gt;{{ end }}{{ .Get &#34;title&#34; }}{{ with .Get &#34;link&#34; }}&lt;/a&gt;{{ end }}&lt;/figcaption&gt;
</span></span><span class="line"><span class="cl">{{ end }}&lt;/figure&gt;
</span></span></code></pre></div><p><em>入力：</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">{{&lt; fig-img src=&#34;https://photo.baldanders.info/flickr/image/8113077_o.png&#34; title=&#34;SHIMENAWA&#34; link=&#34;https://photo.baldanders.info/flickr/8113077/&#34; width=&#34;768&#34; &gt;}}
</span></span></code></pre></div><p><em>出力：</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">figure</span> <span class="na">style</span><span class="o">=</span><span class="s">&#39;margin:0 auto;text-align:center;&#39;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;https://photo.baldanders.info/flickr/8113077/&#34;</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https://photo.baldanders.info/flickr/image/8113077_o.png&#34;</span> <span class="na">srcset</span><span class="o">=</span><span class="s">&#34;https://photo.baldanders.info/flickr/image/8113077_o.png 768w&#34;</span> <span class="na">sizes</span><span class="o">=</span><span class="s">&#34;(min-width:600px) 500px, 80vw&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;SHIMENAWA&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">figcaption</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;https://photo.baldanders.info/flickr/8113077/&#34;</span><span class="p">&gt;</span>SHIMENAWA<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">figcaption</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">figure</span><span class="p">&gt;</span>
</span></span></code></pre></div><figure style='margin:0 auto;text-align:center;'><a href="https://photo.baldanders.info/flickr/8113077/"><img src="https://photo.baldanders.info/flickr/image/8113077_o.png" srcset="https://photo.baldanders.info/flickr/image/8113077_o.png 768w" sizes="(min-width:600px) 500px, 80vw" alt="SHIMENAWA" loading="lazy"></a><figcaption><div><a href="https://photo.baldanders.info/flickr/8113077/">SHIMENAWA</a></div></figcaption>
</figure>
<p><code>&lt;img&gt;</code> 要素の各属性値はこのブログのレイアウトに合わせてチューニングしているので，そのままでは（多分）使えない。
あしからず。</p>
<h3>引用を figure 要素で囲んで引用元を指示する</h3>
<p>引用ブロックは <code>&lt;blockquote&gt;</code> 要素で囲めば「意味」は通るし，実際に markdown の引用（<code>&gt;</code>）も <code>&lt;blockquote&gt;</code> 要素内に展開するようになっている。
しかしこれでは「引用元」の指示が曖昧になってしまう。</p>
<p>そこで <code>&lt;blockquote&gt;</code> 要素を更に <code>&lt;figure&gt;</code> 要素で囲んでキャプションを付加することで引用元を指示できるようにした。</p>
<p><code>shortcodes/fig-quote.html</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">{{ with .Get &#34;lang&#34; }}&lt;figure lang=&#34;{{ . }}&#34;&gt;{{ else }}&lt;figure&gt;{{ end }}
</span></span><span class="line"><span class="cl">&lt;blockquote&gt;{{ with .Get &#34;type&#34; }}{{ $.Inner | $.Page.RenderString (dict &#34;markup&#34; .) }}{{ else }}{{ .Inner }}{{ end }}&lt;/blockquote&gt;{{ if .Get &#34;title&#34;}}
</span></span><span class="line"><span class="cl">&lt;figcaption&gt;via &lt;q&gt;{{ with .Get &#34;link&#34;}}&lt;a href=&#34;{{.}}&#34;&gt;{{ end }}{{ .Get &#34;title&#34; }}{{ with .Get &#34;link&#34;}}&lt;/a&gt;{{ end }}&lt;/q&gt;&lt;/figcaption&gt;
</span></span><span class="line"><span class="cl">{{ end }}&lt;/figure&gt;
</span></span></code></pre></div><p><em>入力：</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">{{&lt; fig-quote title=&#34;The Two Myths of the Internet | WIRED&#34; link=&#34;https://www.wired.com/story/the-two-myths-of-the-internet/&#34; lang=&#34;en&#34; &gt;}}
</span></span><span class="line"><span class="cl">&lt;q&gt;Technologies determine nothing.
</span></span><span class="line"><span class="cl">Technologies influence everything&lt;/q&gt;.
</span></span><span class="line"><span class="cl">{{&lt; /fig-quote &gt;}}
</span></span></code></pre></div><p><em>出力：</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">figure</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">blockquote</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">q</span><span class="p">&gt;</span>Technologies determine nothing.
</span></span><span class="line"><span class="cl">Technologies influence everything<span class="p">&lt;/</span><span class="nt">q</span><span class="p">&gt;</span>.
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">blockquote</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">figcaption</span><span class="p">&gt;</span>via <span class="p">&lt;</span><span class="nt">q</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;https://www.wired.com/story/the-two-myths-of-the-internet/&#34;</span><span class="p">&gt;</span>The Two Myths of the Internet | WIRED<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">q</span><span class="p">&gt;&lt;/</span><span class="nt">figcaption</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">figure</span><span class="p">&gt;</span>
</span></span></code></pre></div><figure lang="en">
<blockquote cite="https://www.wired.com/story/the-two-myths-of-the-internet/">
<q>Technologies determine nothing.
Technologies influence everything</q>.
</blockquote>
<figcaption><div>via <q><a href="https://www.wired.com/story/the-two-myths-of-the-internet/">The Two Myths of the Internet | WIRED</a></q></div></figcaption>
</figure>
<p>これで「引用」の最低要件は満たせるかな。</p>
<h3>汎用 figure 環境</h3>
<p>上記以外に汎用的に <code>&lt;figure&gt;</code> 環境を使うための shortcode。</p>
<p><code>shortcodes/fig-gen.html</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">&lt;figure style=&#39;margin:0 auto;text-align:center;&#39;&gt;{{ with .Get &#34;type&#34; }}{{ $.Inner | $.Page.RenderString (dict &#34;markup&#34; .) }}{{ else }}{{ .Inner }}{{ end }}{{ if .Get &#34;title&#34;}}
</span></span><span class="line"><span class="cl">&lt;figcaption&gt;{{ with .Get &#34;link&#34;}}&lt;a href=&#34;{{.}}&#34;&gt;{{ end }}{{ .Get &#34;title&#34; }}{{ with .Get &#34;link&#34;}}&lt;/a&gt;{{ end }}&lt;/figcaption&gt;
</span></span><span class="line"><span class="cl">{{ end }}&lt;/figure&gt;
</span></span></code></pre></div><p>入出力例は割愛する。</p>
<h3>汎用 div 環境</h3>
<p>これはもっと素朴に <code>&lt;div&gt;</code> で囲むだけの shortcode。</p>
<p><code>shortcodes/div-gen.html</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">&lt;div{{ with .Get &#34;class&#34; }} class=&#34;{{ . }}&#34;{{ end }}{{ with .Get &#34;height&#34; }} style=&#34;height:{{ . }};&#34;{{ end }}{{ with .Get &#34;lang&#34; }} lang=&#34;{{ . }}&#34;{{ end }}&gt;{{ with .Get &#34;type&#34; }}{{ $.Inner | $.Page.RenderString (dict &#34;markup&#34; .) }}{{ else }}{{ .Inner }}{{ end }}&lt;/div&gt;
</span></span></code></pre></div><p><code>class</code> を指定できる他， <code>height</code> で高さを指定できる。
ネタバレ防止の行間稼ぎでよく使う手ですな（笑）</p>
<p>これも入出力例は割愛する。</p>
<h2>ブックマーク</h2>
<ul>
<li><a href="https://gohugo.io/news/0.62.0-relnotes/">Hugo Christmas Edition! | Hugo</a></li>
<li><a href="https://nasust.com/hugo/tips/markdown_render_hooks/">Markdown Render Hooks - リンクや画像のテンプレートを作成する仕組み | Hugo 入門 / 解説 | nasust dev blog</a></li>
<li><a href="https://nasust.com/hugo/functions/render_string/">.RenderString | Markdownの文字列をHTMLに変換する | Hugo 入門 / 解説 | nasust dev blog</a></li>
<li><a href="https://discourse.gohugo.io/t/a-way-to-add-parameters-to-image-and-link-render-hooks/23496">A way to add parameters to image and link render hooks - tips &amp; tricks - HUGO</a></li>
</ul>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>既定の markdown パーサは <a href="https://github.com/yuin/goldmark/" title="yuin/goldmark: A markdown parser written in Go. Easy to extend, standard(CommonMark) compliant, well structured.">yuin/goldmark</a> だが <code>config.toml</code> 等の設定で変更することができる。&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

</div></section>

</article>
</main>
<nav class="page-nav">
<div class="prev-page">&laquo; <a href="/remark/2020/01/our-decade/">私達の10年</a></div>
<div class="next-page"><a href="/remark/2020/01/review-database-with-hugo/">Hugo で簡易データベースを構成する</a> &raquo;</div>
</nav>

<aside class="feedback" id='feedback'>
<h1>Feedback</h1>
<p>GitHub に<a href="https://github.com/spiegel-im-spiegel/github-pages-env/discussions">フィードバック用のディスカッションページ</a>を用意しました。
書き込みには GitHub のアカウントが必要ですが，お気軽にご利用ください。</p>
<p>他のフィードバック手段として Mastodon などの SNS や電子メールも利用できます。電子メールを利用する際の公開鍵は<a href="https://baldanders.info/profile/">プロフィール</a>から取得できます。</p>
</aside>
<footer>


<div class="userinfo">
	<div class="userinfo-avater">
		<a href="https://baldanders.info/profile/"><img src="https://text.baldanders.info/images/avatar.jpg" width="48" height="48" alt="avatar" id="logo"></a>
	</div>
	<div class="userinfo-info" id="maker">
		Text by <a href="https://baldanders.info/profile/" rel="cc:attributionURL" property="cc:attributionName">Spiegel</a>
		in <time property='dc:dateCopyrighted'>2020-01-03</time> (revised in 2020-02-18)
		<a rel='cc:license' href="https://creativecommons.org/licenses/by-sa/4.0/"><i class="fab fa-creative-commons"></i>&nbsp;<i class="fab fa-creative-commons-by"></i>&nbsp;<i class="fab fa-creative-commons-sa"></i></a>
		<ul class="social"><li><a rel="me" href="https://github.com/spiegel-im-spiegel"><span class="github-color"><abbr title="GitHub"><i class="fab fa-github"></i></abbr></span></a></li><li><a rel="me" href="https://www.flickr.com/photos/spiegel/"><span class="flickr-color"><abbr title="Flickr"><i class="fab fa-flickr"></i></abbr></span></a></li><li><a rel="me" href="https://goark.fedicity.net/@spiegel"><span class="mastodon-color"><abbr title="Mastodon"><i class="fa-brands fa-mastodon"></i></abbr></span></a></li><li><a rel="me" href="https://bsky.app/profile/baldanders.info"><span class="bluesky-color"><abbr title="Bluesky"><i class="fa-brands fa-bluesky"></i></abbr></span></a></li><li><a rel="me" href="https://www.strava.com/athletes/122077389"><span class="strava-color"><abbr title="Strava"><i class="fa-brands fa-strava"></i></abbr></span></a></li><li><a rel="me" href="https://x.com/spiegel_2007"><span class="x-twitter-color"><abbr title="X (Twitter)"><i class="fab fa-x-twitter"></i></abbr></span></a></li></ul>
	</div>
</div>

<nav>
<ul class='cloud center'>
<li><a href='/about-feeds/'>Feeds</a></li>
<li><a href='/reviews/'>Reviews</a></li>
<li><a href='/site-policy/'>Policy</a></li>
<li><a href='https://github.com/spiegel-im-spiegel/spiegel-im-spiegel.github.io'>Repository</a></li>
<li><a href='https://validator.w3.org/nu/?doc=https%3a%2f%2ftext.baldanders.info%2fremark%2f2020%2f01%2fmy-hugo-shortcodes%2f&amp;showoutline=yes'>Debug</a></li>
</ul>
<ul class='cloud center'>
<li><a href='https://baldanders.info/'>Home</a></li>
<li><a href='https://photo.baldanders.info/'>Photos</a></li>
<li><a href='https://slide.baldanders.info/'>Slide</a></li>
<li><a href='https://zenn.dev/spiegel'>Zenn</a></li>
</ul>
<ul class='cloud center'>
<li>Powered by <a href='https://gohugo.io/'>Hugo 0.153.3</a> and <a href="https://github.com/spiegel-im-spiegel/hugo-theme-baldanders-info
">Theme of Baldanders.info</a>.</li>
</ul>
</nav>
</footer>
</div>

</body>
</html>
