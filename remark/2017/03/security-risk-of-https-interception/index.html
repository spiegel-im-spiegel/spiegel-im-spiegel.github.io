<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="generator" content="Hugo 0.29" />
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<link rel='stylesheet' href='//fonts.googleapis.com/css?family=Noto+Serif%7cNoto+Sans%3a400,700%7cInconsolata%3a400,700' type='text/css'>
<link rel='stylesheet' href='//fonts.googleapis.com/earlyaccess/notosansjp.css' type='text/css'>
<link rel='stylesheet' href='//fonts.googleapis.com/earlyaccess/sawarabimincho.css' type='text/css'>
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/cc-icons/1.2.1/css/cc-icons.min.css">
<link rel="stylesheet" href="/css/main.css">
<link rel="stylesheet" href="/css/text-baldanders.css">
<link rel="alternate" href="http://text.baldanders.info/index.xml" type="application/rss+xml" title="text.Baldanders.info">
<meta name="google-site-verification" content="jTjBCslPtf8gwVatiY-GDgGv7pV5csa8aUOw1MRPUD4">
<link rel="stylesheet" href="/css/addon.css">
<link rel="stylesheet" href="/css/chroma-styles.css">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
	displayAlign: "left",
	displayIndent: "2em",
	tex2jax: {
		inlineMath: [['$','$'], ['\\(','\\)']],
		processEscapes: true
	},
	TeX: {
		equationNumbers: { autoNumber: "AMS" }
	},
	CommonHTML: {
		matchFontHeight: false
	},
	"HTML-CSS": {
		availableFonts: [],
		preferredFont: null,
		webFont: "STIX-Web"
	}
});
</script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML&amp;locale=ja"></script>
<title>HTTPS 通信監視機器のリスク — しっぽのさきっちょ | text.Baldanders.info</title>
<meta name="description" content="2015年の CERT/CC ブログ記事「The Risks of SSL Inspection」に関する注意喚起が今更ながら出ている。">
<meta name="author" content="Spiegel">
<meta name="keywords" content="security,risk,x509,pki,ssl,tls">
<link rel='prev' href='http://text.baldanders.info/remark/2017/03/wish-list-201703/' title='欲しいものリスト2017年3月版' />
<link rel='next' href='http://text.baldanders.info/remark/2017/03/common-sense-of-ai/' title='人工知能に「常識」は必要なのか？' />
</head>
<body>

<div id='container'>
<header>
<div id="sitetitle"><a href="http://text.baldanders.info/">text.Baldanders.info</a> <a href='/index.xml' title='Feed'><i class='fa fa-rss'></i></a></div>
<p>帰ってきた「しっぽのさきっちょ」</p>
</header>


<main>
<article itemscope itemtype='http://schema.org/BlogPosting' itemref='maker'>
<div><strong><a href="/remark">しっぽのさきっちょ</a>: 2017-03-21 付</strong> （2017-03-27 更新）</div>
<h1 itemprop='name'>HTTPS 通信監視機器のリスク</h1>
<nav class="tags">
<div><a href="/tags">Tags</a>: #<a href="/tags/pki">pki</a> #<a href="/tags/risk">risk</a> #<a href="/tags/security">security</a> #<a href="/tags/ssl">ssl</a> #<a href="/tags/tls">tls</a> #<a href="/tags/x509">x509</a></div>
<div><a href="https://github.com/spiegel-im-spiegel/spiegel-im-spiegel.github.io/commits/master/remark/2017/03/security-risk-of-https-interception/index.html">History</a></div>
</nav>

<section><div>
<div style="float:right;margin-left:0.5rem;margin-bottom:0.5rem;padding-left:0.5rem;padding-bottom:0.5rem;">
<a href="http://www.baldanders.info/spiegel/log2/000820.shtml" title="Stop Fast Track TPP — Baldanders.info"><img src="http://www.baldanders.info/images/noextension.png" alt="no extension" width="165" height="50" /></a>
</div>


<p>2015年の CERT/CC ブログ記事 “<a href="http://insights.sei.cmu.edu/cert/2015/03/the-risks-of-ssl-inspection.html">The Risks of SSL Inspection</a>” に関する注意喚起が今更ながら出ている。</p>

<ul>
<li><a href="http://insights.sei.cmu.edu/cert/2015/03/the-risks-of-ssl-inspection.html">The Risks of SSL Inspection</a>

<ul>
<li><span><a href="https://jhalderm.com/pub/papers/interception-ndss17.pdf">The Security Impact of HTTPS Interception<sup><i class="fa fa-file-pdf-o"></i></sup></a></span></li>
<li><a href="https://www.us-cert.gov/ncas/alerts/TA17-075A">HTTPS Interception Weakens TLS Security | US-CERT</a></li>
<li><a href="http://jvn.jp/ta/JVNTA96603741/">JVNTA#96603741: HTTPS 通信監視機器によるセキュリティ強度低下の問題</a></li>
</ul></li>
</ul>

<p>「HTTPS 通信監視機器」というのは，ぶっちゃけていうと， HTTPS 暗号通信<sup class="footnote-ref" id="fnref:https"><a rel="footnote" href="#fn:https">1</a></sup> に「中間者攻撃（man-in-the-middle attack）」を仕掛けて通信を傍受し malware 等を検出・排除する「セキュリティ製品」である。</p>

<p>HTTPS 通信監視機器のいくつかにはセキュリティ上の問題が存在する。
“<a href="http://insights.sei.cmu.edu/cert/2015/03/the-risks-of-ssl-inspection.html">The Risks of SSL Inspection</a>” から抜き出してみよう。</p>

<ol>
<li>Incomplete validation of upstream certificate validity</li>
<li>Not conveying validation of upstream certificate to the client</li>
<li>Overloading of certificate Canonical Name (CN) field</li>
<li>Use of the application layer to convey certificate validity</li>
<li>Use of a User-Agent HTTP header to determine when to validate a certificate</li>
<li>Communication before warning</li>
<li>Same root CA certificate</li>
</ol>

<p>これらの問題があると推測される製品のリストが “<a href="http://insights.sei.cmu.edu/cert/2015/03/the-risks-of-ssl-inspection.html">The Risks of SSL Inspection</a>” に挙がっているので該当者は確認してみるとよいだろう。
また以下のサイトからも確認できる。</p>

<ul>
<li><a href="https://badssl.com/">badssl.com</a></li>
</ul>

<p>“<a href="http://insights.sei.cmu.edu/cert/2015/03/the-risks-of-ssl-inspection.html">The Risks of SSL Inspection</a>” では以下のように結論付けている。</p>

<figure lang="en">
<blockquote>
<q>SSL and TLS do not provide the level of end-to-end security that users may expect. Even in absence of SSL inspection, there are problems with how well browsers are conveying SSL information to users. The fact that "SSL inspection" is a phrase that exists, should be a blazing red flag that what you think SSL is doing for you is fundamentally broken.</q>
</blockquote>
<figcaption>via <q><a href="http://insights.sei.cmu.edu/cert/2015/03/the-risks-of-ssl-inspection.html">The Risks of SSL Inspection</a></q></figcaption>
</figure>

<p><a href="http://www.baldanders.info/spiegel/log2/000812.shtml" title="HTTPS Deep Inspection — Baldanders.info">以前も書いた</a>が，HTTPS 通信監視機器（あるいは HTTPS Deep Inspection）の存在自体がインターネットの “End to End” 原則を崩すものであり，ひいては「ネットの中立性」に楔を入れるものである。
しかし「<a href="/remark/2016/03/vulnerability-cross-protocol-attack-on-tls-using-sslv2/" title="SSLv2 を有効にしている TLS 実装の脆弱性 ― 馬も鹿も暗号化する時代のセキュリティ">馬も鹿も暗号化する時代</a>」にこの原則は風前の灯である。
たとえば <a href="/remark/2016/07/cms/" title="「自分で面倒見られる子」だけが CMS を導入しなさい">CMS の面倒すらろくすっぽ見られない</a>ユーザが「うちも <a href="https://letsencrypt.org/" title="Let's Encrypt - Free SSL/TLS Certificates">Let&rsquo;s la Encrypt</a>」とか言い出して脆弱性だらけのサイトを暗号化したらどうなるのか。</p>

<p>ネットワーク・セキュリティ専門家から企業あるいは私たち個人に至るまで，場当たりな対処に満足するのではなく，この「現実」にきちんと向き合うべきだと思うのだが，どうだろう。</p>

<h2 id="おまけの追記-公開鍵基盤が担保するもの">【おまけの追記】公開鍵基盤が担保するもの</h2>

<p>他の事象だが同じ公開鍵基盤（Public Key Infrastructure; PKI）に関連している事柄なので，おまけの追記ということで。</p>

<ul>
<li><a href="http://www.computerworld.com/article/3184573/security/to-punish-symantec-google-may-distrust-a-third-of-the-webs-ssl-certificates.html">To punish Symantec, Google may distrust a third of the web&rsquo;s SSL certificates | Computerworld</a></li>
<li><a href="http://notchained.hatenablog.com/entry/2017/03/27/090554">Symantecが再びGoogleの信頼を失った件についてのメモ - Technically, technophobic.</a></li>
<li><a href="https://japan.cnet.com/article/35098759/">グーグル、シマンテックが発行したTLS証明書に不信感 - CNET Japan</a></li>
</ul>

<p>「<a href="http://notchained.hatenablog.com/entry/2017/03/27/090554" title="Symantecが再びGoogleの信頼を失った件についてのメモ - Technically, technophobic.">Symantecが再びGoogleの信頼を失った件についてのメモ</a>」にもあるように Symantec （傘下の Thawte）は既に前科持ちなので「またか（sigh）」って感じなのだが&hellip;</p>

<p>X.509 型の公開鍵基盤は認証局（Certification Authority; CA）が信頼できることが絶対条件で，これが崩れると機能しなくなる。</p>

<p>喩えるならお金と銀行の関係と似ている。
銀行はお金の価値を担保するが銀行が信用できないのならお金の価値を担保するものがなくなる。
同じく認証局が管理する証明書は認証局が安全性を担保できているからこそ意味がある。
そうでなければオレオレ証明書またはそれ以下の価値しかない。</p>

<p>この問題は Symantec と Google の2者間の喧嘩だと思ったら物事を見誤る。
現在 Web を支配している公開鍵基盤の根幹に関わる問題なのである。</p>

<p>それにしても，昔「<a href="http://www.baldanders.info/spiegel/log2/000277.shtml" title="Extended Validation SSL — Baldanders.info">EV SSL は『屋上屋を架す』ようにしか見えない</a>」と書いたが，まったくもってその通りだったな（笑）</p>

<h2 id="ブックマーク">ブックマーク</h2>

<ul>
<li><a href="http://www.baldanders.info/spiegel/log2/000809.shtml">Malware Spoofing HTTPS（3月2日，追記あり） — Baldanders.info</a></li>
<li><a href="http://www.baldanders.info/spiegel/log2/000812.shtml">HTTPS Deep Inspection — Baldanders.info</a></li>
<li><a href="https://japan.zdnet.com/article/35098402/">HTTPS監視装置にセキュリティ低下の危険性&ndash;日米機関で注意喚起 - ZDNet Japan</a></li>
<li><a href="https://www.schneier.com/blog/archives/2017/03/new_paper_on_en.html">New Paper on Encryption Workarounds - Schneier on Security</a>

<ul>
<li><a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2938033">Encryption Workarounds by Orin S. Kerr, Bruce Schneier :: SSRN</a></li>
</ul></li>
</ul>

<h2 id="参考図書">参考図書</h2>

<div class="hreview" ><a class="item url" href="http://www.amazon.co.jp/exec/obidos/ASIN/B015643CPE/baldandersinf-22/"><img src="http://ecx.images-amazon.com/images/I/51t6yHHVwEL._SL160_.jpg" alt="photo" class="photo"  /></a><dl ><dt class="fn"><a class="item url" href="http://www.amazon.co.jp/exec/obidos/ASIN/B015643CPE/baldandersinf-22/">暗号技術入門 第3版　秘密の国のアリス</a></dt><dd>結城 浩 </dd><dd>SBクリエイティブ 2015-08-25</dd><dd>評価<abbr class="rating" title="5"><img src="http://g-images.amazon.com/images/G/01/detail/stars-5-0.gif" alt="" /></abbr> </dd></dl><p class="similar"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B0148FQNVC/baldandersinf-22/" target="_top"><img src="http://images.amazon.com/images/P/B0148FQNVC.09._SCTHUMBZZZ_.jpg"  alt="自作エミュレータで学ぶx86アーキテクチャ　コンピュータが動く仕組みを徹底理解！"  /></a> <a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00W6NCLJM/baldandersinf-22/" target="_top"><img src="http://images.amazon.com/images/P/B00W6NCLJM.09._SCTHUMBZZZ_.jpg"  alt="数学ガールの秘密ノート/丸い三角関数"  /></a> <a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00Y9EYOIW/baldandersinf-22/" target="_top"><img src="http://images.amazon.com/images/P/B00Y9EYOIW.09._SCTHUMBZZZ_.jpg"  alt="数学ガールの秘密ノート/微分を追いかけて"  /></a> <a href="http://www.amazon.co.jp/exec/obidos/ASIN/B012BYBTZC/baldandersinf-22/" target="_top"><img src="http://images.amazon.com/images/P/B012BYBTZC.09._SCTHUMBZZZ_.jpg"  alt="情報セキュリティ白書2015: サイバーセキュリティ新時代：あらゆる変化へ柔軟な対応を"  /></a> <a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00W6NCLL0/baldandersinf-22/" target="_top"><img src="http://images.amazon.com/images/P/B00W6NCLL0.09._SCTHUMBZZZ_.jpg"  alt="数学ガールの秘密ノート/数列の広場"  /></a> </p>
<p class="description">SHA-3 や Bitcoin/Blockchain など新しい知見や技術要素を大幅追加。暗号技術を使うだけならこれ1冊でとりあえず無問題。</p>
<p class="gtools" >reviewed by <a href='#maker' class='reviewer'>Spiegel</a> on <abbr class="dtreviewed" title="2015-09-20">2015-09-20</abbr> (powered by <a href="http://www.goodpic.com/mt/aws/index.html" >G-Tools</a>)</p>
</div>
<div class="footnotes">

<hr />

<ol>
<li id="fn:https">念のため簡単に説明しておくと， HTTPS (Hypertext Transfer Protocol Secure) 暗号通信は WWW (World Wide Web) におけるクライアント-サーバ間の通信経路を暗号化する仕組みである。具体的には TLS (Transport Layer Security) 等のプロトコルを用い公開鍵暗号方式を使ってセッション鍵を生成する。また公開鍵暗号方式の公開鍵は X.509 方式の公開鍵基盤によって管理される。
 <a class="footnote-return" href="#fnref:https"><sup>[return]</sup></a></li>
</ol>
</div>

</div></section>

</article>
</main>
<nav class="page-nav">
<div class="prev-page">&laquo; <a href="/remark/2017/03/wish-list-201703/">欲しいものリスト2017年3月版</a></div>
<div class="next-page"><a href="/remark/2017/03/common-sense-of-ai/">人工知能に「常識」は必要なのか？</a> &raquo;</div>
</nav>

<aside id='tech-terms'>
<style scoped>
#tech-terms h1 {
  border: solid thin gray;
  margin: 0 0 1rem 0;
  padding: 0 0.5rem 2px 2px;
}
</style>
<h1>Technical Terms</h1>
<div class="cloud" style="font-size:smaller;">
<script type="text/javascript" src="http://e-words.jp/embed.x?e=utf8"></script>
<p class="right">Powered by <a href="hhttp://e-words.jp/p/s-embed.html">e-Words</a></p>
</div>
</aside>
<aside id='feedback'>
<style scoped>
#feedback h1 {
  border: solid thin gray;
  margin: 0 0 1rem 0;
  padding: 0 0.5rem 2px 2px;
}
</style>
<h1>Feedback</h1>
<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "textbaldandersinfo" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</aside>

<footer>

	<div class="userinfo">
		<div class="userinfo-avater">
			
				<a href="http://www.baldanders.info/spiegel/profile/"><img src="/images/avatar.jpg" width="48" height="48" alt="avatar"></a>
			
		</div>
		<div class="userinfo-info" id="maker" itemprop='author' itemscope itemtype='http://schema.org/Person'>
			
				Written by <a href="http://www.baldanders.info/spiegel/profile/" rel="cc:attributionURL" property="cc:attributionName" itemprop='name'>Spiegel</a> in <time property='dc:dateCopyrighted'>2017-03-21</time> (revised in <time property='dc:modified'>2017-03-27</time>).
				
	<a rel='cc:license' href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank"><i class="cc cc-cc"></i>&nbsp;<i class="cc cc-by"></i>&nbsp;<i class="cc cc-sa"></i></a>

			
			
	<ul class="social">
		<li><a href="https://github.com/spiegel-im-spiegel" target="_blank"><i class="fa fa-github"></i></a></li>
		<li><a href="https://twitter.com/spiegel_2007" target="_blank"><i class="fa fa-twitter"></i></a></li>
		
		<li><a href="http://spiegel-im-spiegel.tumblr.com/" target="_blank"><i class="fa fa-tumblr"></i></a></li>
		<li><a href="http://instagram.com/spiegel_2007" target="_blank"><i class="fa fa-instagram"></i></a></li>
		<li><a href="https://www.flickr.com/photos/spiegel/" target="_blank"><i class="fa fa-flickr"></i></a></li>
		<li><a href="https://www.facebook.com/spiegel.im.spiegel" target="_blank"><i class="fa fa-facebook"></i></a></li>
		<li><a href="https://jp.linkedin.com/in/spiegelimspiegel" target="_blank"><i class="fa fa-linkedin"></i></a></li>
		
	</ul>
	<ul class="social">
		<li><a href="http://www.facebook.com/share.php?u=http%3a%2f%2ftext.baldanders.info%2fremark%2f2017%2f03%2fsecurity-risk-of-https-interception%2f" rel=”nofollow” target="_blank"><i class="fa fa-facebook-square fa-2x" aria-hidden="true"></i></a></li>
		<li><a href="http://twitter.com/share?text=HTTPS%20%e9%80%9a%e4%bf%a1%e7%9b%a3%e8%a6%96%e6%a9%9f%e5%99%a8%e3%81%ae%e3%83%aa%e3%82%b9%e3%82%af&amp;url=http%3a%2f%2ftext.baldanders.info%2fremark%2f2017%2f03%2fsecurity-risk-of-https-interception%2f" rel=”nofollow” target="_blank"><i class="fa fa-twitter-square fa-2x" aria-hidden="true"></i></a></li>
		<li><a href="https://flattr.com/submit/auto?user_id=spiegel&amp;url=http%3a%2f%2ftext.baldanders.info%2fremark%2f2017%2f03%2fsecurity-risk-of-https-interception%2f&amp;title=HTTPS%20%e9%80%9a%e4%bf%a1%e7%9b%a3%e8%a6%96%e6%a9%9f%e5%99%a8%e3%81%ae%e3%83%aa%e3%82%b9%e3%82%af" target="_blank"><img src="//button.flattr.com/flattr-badge-large.png" alt="Flattr this" title="Flattr this"></a></li>
	</ul>


		</div>
	</div>

<nav>
<ul class='cloud center'>
<li><a href='https://github.com/spiegel-im-spiegel/spiegel-im-spiegel.github.io'>Repository</a></li>
<li><a href='/reviews/'>Reviews</a></li>
<li><a href='/about-feeds/'>Feeds</a></li>
<li><a href='/site-policy/'>Site Policy</a></li>
<li><a href='https://validator.w3.org/nu/?doc=http%3a%2f%2ftext.baldanders.info%2fremark%2f2017%2f03%2fsecurity-risk-of-https-interception%2f&amp;showoutline=yes'>Debug</a></li>
</ul>
<ul class='cloud center'>
<li><a href='http://www.baldanders.info/'>Baldanders.info</a></li>
<li><a href='https://scrapbox.io/spiegel-branch/'>Scrapbox</a></li>
<li><a href='http://qiita.com/spiegel-im-spiegel'>Qiita</a></li>
</ul>
<ul class='cloud center'>
<li>Powered by <a href='https://gohugo.io/'>Hugo 0.29</a> and <a href="https://github.com/spiegel-im-spiegel/hugo-theme-text">Text</a>.</li>
</ul>
</nav>
</footer>

</div>
<script src="/highlightjs/highlight.pack.js"></script>
<script>
  hljs.configure({
    tabReplace: "    ",	
  });
  hljs.initHighlightingOnLoad();
</script>

</body>
</html>
