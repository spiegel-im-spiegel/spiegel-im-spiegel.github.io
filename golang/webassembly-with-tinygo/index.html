<!DOCTYPE html>
<html lang="ja">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="generator" content="Hugo 0.88.0" />
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
<link rel="apple-touch-icon" type="image/png" sizes="144x144" href="/apple-icon-144x144.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/android-icon-192x192.png">
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="https://text.baldanders.info/golang/webassembly-with-tinygo/">
<script src="//kit.fontawesome.com/152e339e63.js"></script>
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Inconsolata%3a500,700%7cNoto+Sans+JP%3a500,700%7cNoto+Sans%3a500,700%7cNoto+Serif%7cNoto+Serif+JP&display=swap" type='text/css'>
<link rel="stylesheet" href="/css/local-font.css" type='text/css'>
<link rel="stylesheet" href="/css/baldanders-info-dark.css" type='text/css'>

<link rel="alternate" href="https://text.baldanders.info/index.xml" type="application/rss+xml" title="text.Baldanders.info">
<link rel="alternate" href="https://text.baldanders.info/index.json" type="application/json" title="text.Baldanders.info">
<meta name="google-site-verification" content="jTjBCslPtf8gwVatiY-GDgGv7pV5csa8aUOw1MRPUD4">
<title>TinyGo ã§ WebAssembly | text.Baldanders.info</title>
<meta property="og:title" content="TinyGo ã§ WebAssembly">
<meta name="description" content="Go ãŠã‚ˆã³ TinyGo ã‚’ä½¿ã£ã¦ WebAssembly ã¸ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’è¡Œã„ Web ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§å‹•ä½œã•ã›ã‚‹ã¨ã“ã‚ã¾ã§ã‚„ã£ã¦ã¿ã‚‹">
<meta property="og:description" content="Go ãŠã‚ˆã³ TinyGo ã‚’ä½¿ã£ã¦ WebAssembly ã¸ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’è¡Œã„ Web ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§å‹•ä½œã•ã›ã‚‹ã¨ã“ã‚ã¾ã§ã‚„ã£ã¦ã¿ã‚‹">
<meta property="og:image" content="https://text.baldanders.info/images/attention/go-logo_blue.png">
<meta name="author" content="Spiegel">


<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@spiegel_2007">
<meta name="twitter:creator" content="@spiegel_2007">
<meta name="keywords" content="programming, golang, tinygo, webassembly">
<link rel='prev' href='https://text.baldanders.info/golang/special-forms/' title='ç‰¹æ®Šå½¢å¼ã«ã‚ˆã‚‹å¼è©•ä¾¡ã«ã¤ã„ã¦' />
<link rel='next' href='https://text.baldanders.info/golang/wasi-with-tinygo/' title='TinyGo ã§ WASI ã€å¤±æ•—ç·¨ã€‘' />

<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "WebSite",
	"@id": "https://text.baldanders.info/",
	"inLanguage": "ja",
	"name": "text.Baldanders.info",
    "url": "https://text.baldanders.info/",
	"publisher": {
		"@id": "https://text.baldanders.info/#org"
	},
	"author": {
		"@id": "https://text.baldanders.info/#maker"
	},
	"image": "https://text.baldanders.info/images/attention/site.jpg",
	"description": "å¸°ã£ã¦ããŸã€Œã—ã£ã½ã®ã•ãã£ã¡ã‚‡ã€"
}
</script>
<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "Organization",
	"@id": "https://text.baldanders.info/#org",
	"name": "Spiegel",
	"logo": {
		"@type": "ImageObject",
		"@id": "https://text.baldanders.info/#logo",
		"url": "https://text.baldanders.info/images/avatar.jpg"
	}
}
</script>
<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "Person",
	"@id": "https://text.baldanders.info/#maker",
	"name": "Spiegel",
	"url": "https://baldanders.info/profile/",
	"image": "https://text.baldanders.info/images/avatar.jpg"
}
</script>
<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "Blog",
	"@id": "https://text.baldanders.info/golang/",
	"url": "https://text.baldanders.info/golang/",
	"inLanguage": "ja",
	"name": "ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èª Go",
	"description": "Go è¨€èªãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã«é–¢ã™ã‚‹è©±é¡Œã€‚",
	"image": "https://text.baldanders.info/images/attention/go-logo_blue.png",
	"publisher": {
		"@id": "https://text.baldanders.info/#org"
	},
	"author": {
		"@id": "https://text.baldanders.info/#maker"
	}
}
</script>
<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "BreadcrumbList",
	"@id": "https://text.baldanders.info/golang/webassembly-with-tinygo/#breadcrumb-list",
	"itemListElement": [
		{
			"@type": "ListItem",
			"position": 1,
			"item": {
				"@id": "https://text.baldanders.info/"
			}
		},
		{
			"@type": "ListItem",
			"position": 2,
			"item": {
				"@id": "https://text.baldanders.info/golang/"
			}
		}
	]
}
</script>
<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "BlogPosting",
	"@id": "https://text.baldanders.info/golang/webassembly-with-tinygo/",
	"url": "https://text.baldanders.info/golang/webassembly-with-tinygo/",
	"mainEntityOfPage": "https://text.baldanders.info/golang/webassembly-with-tinygo/",
	"inLanguage": "ja",
	"name": "TinyGo ã§ WebAssembly",
	"description": "Go ãŠã‚ˆã³ TinyGo ã‚’ä½¿ã£ã¦ WebAssembly ã¸ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’è¡Œã„ Web ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§å‹•ä½œã•ã›ã‚‹ã¨ã“ã‚ã¾ã§ã‚„ã£ã¦ã¿ã‚‹",
	"headline": "Go ãŠã‚ˆã³ TinyGo ã‚’ä½¿ã£ã¦ WebAssembly ã¸ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’è¡Œã„ Web ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§å‹•ä½œã•ã›ã‚‹ã¨ã“ã‚ã¾ã§ã‚„ã£ã¦ã¿ã‚‹",
	"keywords": "programming, golang, tinygo, webassembly",
	"image": "https://text.baldanders.info/images/attention/go-logo_blue.png",
	"datePublished": "2021-03-11T12:01:29+00:00",
	"dateModified": "2021-08-12T21:22:05+00:00",
	"publisher": {
		"@id": "https://text.baldanders.info/#org"
	},
	"author": {
		"@id": "https://text.baldanders.info/#maker"
	},
	"license": "https://creativecommons.org/licenses/by-sa/4.0/"
}
</script>
</head>
<body>

<div id='container'>

<main>
<nav class="breadcrumb">
<a href="https://text.baldanders.info/">text.Baldanders.info</a> &raquo; <a href="/golang/">ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èª Go</a>
</nav>
<article>
<h1>TinyGo ã§ WebAssembly</h1>
<nav class="tags">
	<div><a href='/tags/'>Tags</a>: #<a href="/tags/golang/">golang</a> #<a href="/tags/programming/">programming</a> #<a href="/tags/tinygo/">tinygo</a> #<a href="/tags/webassembly/">webassembly</a></div>
	<div class="cloud">
		<span class="share-color" title="Share this entry"><i class="fas fa-share-square"></i></span>&nbsp;:
		&nbsp;<a href="https://getpocket.com/edit?url=https%3a%2f%2ftext.baldanders.info%2fgolang%2fwebassembly-with-tinygo%2f&amp;title=TinyGo%20%e3%81%a7%20WebAssembly" target="_blank"><span class="pocket-color"><i class="fab fa-get-pocket" aria-hidden="true"></i></span></a>
		&nbsp;<a href="http://www.facebook.com/share.php?u=https%3a%2f%2ftext.baldanders.info%2fgolang%2fwebassembly-with-tinygo%2f" target="_blank"><span class="facebook-color"><i class="fab fa-facebook-square" aria-hidden="true"></i></span></a>&nbsp;<a href="http://twitter.com/share?text=TinyGo%20%e3%81%a7%20WebAssembly+by+@spiegel_2007&amp;url=https%3a%2f%2ftext.baldanders.info%2fgolang%2fwebassembly-with-tinygo%2f" target="_blank"><span class="twitter-color"><i class="fab fa-twitter-square" aria-hidden="true"></i></span></a></div>
</nav>
<nav class="history">History in
  <a href="https://github.com/spiegel-im-spiegel/spiegel-im-spiegel.github.io/commits/master/golang/webassembly-with-tinygo/index.html">GitHub Page</a>
</nav>

<section>
<p><a href="https://tinygo.org/" title="TinyGo - Go on Microcontrollers and WASM">TinyGo</a> ã¯æœ¬å®¶ <a href="https://golang.org/" title="The Go Programming Language">Go</a> ã®ã‚µãƒ–ã‚»ãƒƒãƒˆã¨è¨€ãˆã‚‹ã‚‚ã®ã§ <a href="https://llvm.org/" title="The LLVM Compiler Infrastructure Project">LLVM</a> ã‚’ä½¿ã£ãŸçµ„ã¿è¾¼ã¿ç”¨é€”ç‰¹åŒ–ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã§ã‚ã‚‹ã€‚
ã—ã‹ã‚‚ <a href="https://llvm.org/" title="The LLVM Compiler Infrastructure Project">LLVM</a> ãŒ <a href="https://webassembly.org/" title="WebAssembly">WebAssembly</a> ãƒã‚¤ãƒŠãƒªã‚’ç›´æ¥å‡ºåŠ›ã§ãã‚‹ã¨ã„ã†ã“ã¨ã‚‚ã‚ã£ã¦ <a href="https://tinygo.org/" title="TinyGo - Go on Microcontrollers and WASM">TinyGo</a> ã¨ <a href="https://webassembly.org/" title="WebAssembly">WebAssembly</a> ã®ç›¸æ€§ã¯æœ¬å®¶ <a href="https://golang.org/" title="The Go Programming Language">Go</a> ä»¥ä¸Šã¨è¨€ãˆã‚‹ã€‚</p>
<p>ã¨ã„ã†ã‚ã‘ã§ä»Šå›ã¯ï¼Œ <a href="https://golang.org/" title="The Go Programming Language">Go</a> ãŠã‚ˆã³ <a href="https://tinygo.org/" title="TinyGo - Go on Microcontrollers and WASM">TinyGo</a> ã‚’ä½¿ã£ã¦ <a href="https://webassembly.org/" title="WebAssembly">WebAssembly</a> ã¸ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’è¡Œã„ï¼Œ Web ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§å‹•ä½œã•ã›ã‚‹ã¨ã“ã‚ã¾ã§ã‚„ã£ã¦ã¿ã‚‹ã“ã¨ã«ã™ã‚‹ã€‚</p>
<h2><a href="https://tinygo.org/" title="TinyGo - Go on Microcontrollers and WASM">TinyGo</a> ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h2>
<p><a href="https://tinygo.org/" title="TinyGo - Go on Microcontrollers and WASM">TinyGo</a> ãŒå‹•ä½œã™ã‚‹ãŸã‚ã«ã¯ï¼Œã‚ã‚‰ã‹ã˜ã‚æœ¬å®¶ <a href="https://golang.org/" title="The Go Programming Language">Go</a> ã®ãƒ„ãƒ¼ãƒ«ãƒã‚§ãƒ¼ãƒ³ãŒå°å…¥æ¸ˆã¿ã§ã‚ã‚‹ã“ã¨ãŒå‰æã¨ãªã‚‹ã€‚
ã“ã®è¨˜äº‹ã§ã¯ <a href="https://golang.org/" title="The Go Programming Language">Go</a> ã¯å°å…¥æ¸ˆã¿ã§ã‚ã‚‹ã¨ã—ã¦è©±ã‚’é€²ã‚ã‚‹ã€‚</p>
<p><a href="https://tinygo.org/" title="TinyGo - Go on Microcontrollers and WASM">TinyGo</a> ã¯ä»¥ä¸‹ã®ãƒªãƒã‚¸ãƒˆãƒªã‹ã‚‰æœ€æ–°ç‰ˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰&amp;ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚</p>
<ul>
<li><a href="https://github.com/tinygo-org/tinygo">tinygo-org/tinygo: Go compiler for small places. Microcontrollers, WebAssembly, and command-line tools. Based on LLVM.</a></li>
</ul>
<p>2021-03-11 æ™‚ç‚¹ã§ã®æœ€æ–°ç‰ˆã¯ 0.17.0 ã§ã‚ã‚‹ã€‚
<a href="https://golang.org/" title="The Go Programming Language">Go</a> 1.16 ä»¥é™ãŒæ¨å¥¨ã‚‰ã—ã„ã€‚</p>
<h3>Ubuntu ã®å ´åˆ</h3>
<p>Ubuntu ã® APT ã‚„ Snap ã®å…¬å¼ãƒªãƒã‚¸ãƒˆãƒªã«ã¯ãªã„ã®ã§ï¼Œ deb ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ï¼Œæ‰‹å‹•ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">$ curl -L https://github.com/tinygo-org/tinygo/releases/download/v0.17.0/tinygo_0.17.0_amd64.deb -O
$ sudo dpkg -i tinygo_0.17.0_amd64.deb
$ tinygo version
tinygo version 0.17.0 linux/amd64 (using go version go1.16.1 and LLVM version 11.0.0)
</code></pre></div><p>ã¡ãªã¿ã« WSL/WSL2 ä¸Šã® Ubuntu ã«ã‚‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯èƒ½ã ãã†ã ã€‚</p>
<h3>Windows ã®å ´åˆ</h3>
<p>Windows ãªã‚‰ <a href="https://scoop.sh/" title="Scoop">Scoop</a> ã‚’ä½¿ã†ã®ãŒæœ€ã‚‚ç°¡å˜ã§ã‚ã‚‹ã€‚
<a href="https://scoop.sh/" title="Scoop">Scoop</a> ãªã‚‰æœ¬å®¶ <a href="https://golang.org/" title="The Go Programming Language">Go</a> ã‚‚ç°¡å˜ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹ã— <a href="https://tinygo.org/" title="TinyGo - Go on Microcontrollers and WASM">TinyGo</a> ç”¨ã®å‘¨è¾ºãƒ„ãƒ¼ãƒ«ã‚‚ <a href="https://scoop.sh/" title="Scoop">Scoop</a> ã§ç°¡å˜ã«å°å…¥ã§ãã‚‹ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">$ scoop install tinygo
$ tinygo version
tinygo version 0.17.0 windows/amd64 (using go version go1.16.1 and LLVM version 11.0.0)
</code></pre></div><h3>Docker ã®å ´åˆ</h3>
<p>Docker ç’°å¢ƒã‚‚ç”¨æ„ã•ã‚Œã¦ã„ã‚‹ãã†ã ã€‚
è©³ã—ãã¯ã“ã¡ã‚‰ã€‚</p>
<ul>
<li><a href="https://tinygo.org/getting-started/using-docker/">Docker :: TinyGo - Go on Microcontrollers and WASM</a></li>
</ul>
<h2>ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ</h2>
<p>ä»Šå›ã®ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆã¯ã“ã‚“ãªæ„Ÿã˜ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">$ tree .
.
â”œâ”€â”€ hello
â”‚   â”œâ”€â”€ hello.go
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ wasm.js
â”‚   â””â”€â”€ wasm_exec.js
â””â”€â”€ main.go
</code></pre></div><p><code>main.go</code> ã¯ç°¡æ˜“ã‚µãƒ¼ãƒã®ã‚³ãƒ¼ãƒ‰ã§ï¼Œã“ã‚“ãªæ„Ÿã˜ã«ãªã£ã¦ã„ã‚‹ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&#34;embed&#34;</span>
    <span class="s">&#34;fmt&#34;</span>
    <span class="s">&#34;io/fs&#34;</span>
    <span class="s">&#34;net/http&#34;</span>
    <span class="s">&#34;os&#34;</span>
    <span class="s">&#34;strings&#34;</span>
<span class="p">)</span>

<span class="c1">//go:embed hello
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">assets</span> <span class="nx">embed</span><span class="p">.</span><span class="nx">FS</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">addr</span> <span class="o">:=</span> <span class="s">&#34;localhost:3000&#34;</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Open http://%s/\n&#34;</span><span class="p">,</span> <span class="nx">addr</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Press ctrl+c to stop&#34;</span><span class="p">)</span>

    <span class="nx">root</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">fs</span><span class="p">.</span><span class="nf">Sub</span><span class="p">(</span><span class="nx">assets</span><span class="p">,</span> <span class="s">&#34;hello&#34;</span><span class="p">)</span>
    <span class="nx">fs</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nf">FileServer</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nf">FS</span><span class="p">(</span><span class="nx">root</span><span class="p">))</span>
    <span class="nx">http</span><span class="p">.</span><span class="nf">Handle</span><span class="p">(</span><span class="s">&#34;/&#34;</span><span class="p">,</span> <span class="nx">http</span><span class="p">.</span><span class="nf">FileServer</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nf">FS</span><span class="p">(</span><span class="nx">root</span><span class="p">)))</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nf">ListenAndServe</span><span class="p">(</span><span class="nx">addr</span><span class="p">,</span> <span class="nx">http</span><span class="p">.</span><span class="nf">HandlerFunc</span><span class="p">(</span><span class="kd">func</span><span class="p">(</span><span class="nx">resp</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">req</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">resp</span><span class="p">.</span><span class="nf">Header</span><span class="p">().</span><span class="nf">Add</span><span class="p">(</span><span class="s">&#34;Cache-Control&#34;</span><span class="p">,</span> <span class="s">&#34;no-cache&#34;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">HasSuffix</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">URL</span><span class="p">.</span><span class="nx">Path</span><span class="p">,</span> <span class="s">&#34;.wasm&#34;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">resp</span><span class="p">.</span><span class="nf">Header</span><span class="p">().</span><span class="nf">Set</span><span class="p">(</span><span class="s">&#34;content-type&#34;</span><span class="p">,</span> <span class="s">&#34;application/wasm&#34;</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="nx">fs</span><span class="p">.</span><span class="nf">ServeHTTP</span><span class="p">(</span><span class="nx">resp</span><span class="p">,</span> <span class="nx">req</span><span class="p">)</span>
    <span class="p">}));</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nf">Fprintln</span><span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">Stderr</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p><a href="https://golang.org/pkg/embed/" title="embed - The Go Programming Language"><code>embed</code></a> ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ <code>//go:embed</code> ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ãŒä¾¿åˆ©ï¼ ç°¡æ˜“ã‚µãƒ¼ãƒã®ã‚³ãƒ¼ãƒ‰ã«ã¤ã„ã¦ã¯æ‹™æ–‡ã€Œ<a href="/golang/embeded-filesystem/">ç´™èŠå±…ç”¨ã®ç°¡æ˜“ã‚µãƒ¼ãƒã‚’æ›¸ãã€Go 1.16 ç‰ˆã€‘</a> ã€ã‚’å‚ç…§ã®ã“ã¨ã€‚
ä»Šå›ç”¨ã®è¨­å®šã¨ã—ã¦ã¯ <code>*.wasm</code> ãƒ•ã‚¡ã‚¤ãƒ«ã® Content-Type ã‚’ <code>application/wasm</code> ã«ã™ã‚‹ã“ã¨ãã‚‰ã„ã‹ãªã€‚
ã‚ã¨ã¯ <code>no-cache</code> ã®è¨­å®šã­ã€‚</p>
<p><code>wasm_exec.js</code> ãƒ•ã‚¡ã‚¤ãƒ«ã¯ <a href="https://golang.org/" title="The Go Programming Language">Go</a> ãŠã‚ˆã³ <a href="https://tinygo.org/" title="TinyGo - Go on Microcontrollers and WASM">TinyGo</a> ãŒç”¨æ„ã—ã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã§ï¼Œä»¥ä¸‹ã‹ã‚‰ã‚³ãƒ”ã£ã¦ãã®ã¾ã¾ä½¿ãˆã°ã‚ˆã„ã€‚</p>
<table>
<thead>
<tr>
<th>å‡¦ç†ç³»</th>
<th>ãƒ‘ã‚¹</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://golang.org/" title="The Go Programming Language">Go</a></td>
<td><code>$GOROOT/misc/wasm/wasm_exec.js</code></td>
</tr>
<tr>
<td><a href="https://tinygo.org/" title="TinyGo - Go on Microcontrollers and WASM">TinyGo</a></td>
<td><code>$TINYGOROOT/targets/wasm_exec.js</code></td>
</tr>
</tbody>
</table>
<p><code>$GOROOT</code> ãŠã‚ˆã³ <code>$TINYGOROOT</code> ã®å€¤ã¯ï¼Œä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§å–å¾—ã§ãã‚‹ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">$ tinygo env
GOOS=&#34;linux&#34;
GOARCH=&#34;amd64&#34;
GOROOT=&#34;/usr/local/go1.16.1&#34;
GOPATH=&#34;/home/username/go&#34;
GOCACHE=&#34;/home/username/.cache/tinygo&#34;
CGO_ENABLED=&#34;1&#34;
TINYGOROOT=&#34;/usr/local/lib/tinygo&#34;
</code></pre></div><h2>ã¿ã‚“ãªå¤§å¥½ã Hello World</h2>
<p>ã•ã¦ <code>hello/hello.go</code> ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ã ãŒï¼Œã¾ãšã¯ã“ã‚“ãªæ„Ÿã˜ã§ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="c1">// +build js,wasm
</span><span class="c1"></span>
<span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="s">&#34;syscall/js&#34;</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">ch</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kd">struct</span><span class="p">{})</span>
    <span class="nx">js</span><span class="p">.</span><span class="nf">Global</span><span class="p">().</span><span class="nf">Get</span><span class="p">(</span><span class="s">&#34;document&#34;</span><span class="p">).</span><span class="nf">Call</span><span class="p">(</span><span class="s">&#34;getElementById&#34;</span><span class="p">,</span> <span class="s">&#34;hello&#34;</span><span class="p">).</span><span class="nf">Set</span><span class="p">(</span><span class="s">&#34;innerHTML&#34;</span><span class="p">,</span> <span class="s">&#34;Hello, World!&#34;</span><span class="p">)</span>
    <span class="o">&lt;-</span><span class="nx">ch</span> <span class="c1">// Code must not finish
</span><span class="c1"></span><span class="p">}</span>
</code></pre></div><p>JavaScript ã® DOM æ§‹é€ ã«æ…£ã‚Œã¦ã„ã‚‹äººãªã‚‰ãã‚“ãªã«é›£ã—ããªã„ã ã‚ã†ã€‚
ID å <code>hello</code> ã®è¦ç´ ã«æ–‡å­—åˆ— <code>Hello, World!</code> ã‚’çªã£è¾¼ã‚€ã ã‘ã®ç°¡å˜ãªãŠä»•äº‹ï¼ˆç¬‘ï¼‰</p>
<p>ã“ã‚Œã‚’ <a href="https://golang.org/" title="The Go Programming Language">Go</a> ãŠã‚ˆã³ <a href="https://tinygo.org/" title="TinyGo - Go on Microcontrollers and WASM">TinyGo</a> ã®å„ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦ã¿ã‚‹ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">$ GOOS=js GOARCH=wasm go build -o hello1.wasm -trimpath
$ tinygo build -o hello2.wasm -target wasm ./hello.go
</code></pre></div><p>å‰è€…ãŒæœ¬å®¶ <a href="https://golang.org/" title="The Go Programming Language">Go</a> ã«ã‚ˆã‚‹ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã§ï¼Œå¾Œè€…ãŒ <a href="https://tinygo.org/" title="TinyGo - Go on Microcontrollers and WASM">TinyGo</a> ã«ã‚ˆã‚‹ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã ã€‚
ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«çµæœã¯ä»¥ä¸‹ã®é€šã‚Šã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">$ ll *.wasm
-rwxrwxr-x 1 username username 1364695  3æœˆ 10 23:59 hello1.wasm*
-rwxrwxr-x 1 username username   67375  3æœˆ 10 23:59 hello2.wasm*
</code></pre></div><p>ãŠã†ãµã€‚
ã“ã‚“ãªã«é•ã†ã®ã‹ã€‚</p>
<p>æœ¬å®¶ <a href="https://golang.org/" title="The Go Programming Language">Go</a> ã®ã‚³ãƒ¼ãƒ‰ãŒå¤§ãã„ã®ã¯ï¼Œè‰¯ãã‚‚æ‚ªãã‚‚ POSIX äº’æ›ç’°å¢ƒã¸ã®ä¾å­˜åº¦ãŒé«˜ãçµ„ã¿è¾¼ã¿ç”¨é€”ã«ä½¿ã†ã«ã¯ä½™è¨ˆãªã‚³ãƒ¼ãƒ‰ã‚’æŠ±ãˆè¾¼ã‚“ã§ã—ã¾ã†ã¨ã„ã†äº‹æƒ…ãŒã‚ã‚‹ã€‚</p>
<p>ä¸€æ–¹ <a href="https://tinygo.org/" title="TinyGo - Go on Microcontrollers and WASM">TinyGo</a> ã¯ <a href="https://llvm.org/" title="The LLVM Compiler Infrastructure Project">LLVM</a> ã®åˆ¶ç´„ã‚’å—ã‘ã‚‹ãŸã‚ï¼Œã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚„ä¸¦è¡Œå‡¦ç†ãªã©ã§æœ¬å®¶ <a href="https://golang.org/" title="The Go Programming Language">Go</a> ã¨ã¯ç•°ãªã‚‹æŒ™å‹•ã«ãªã‚‹ï¼ˆä»–ã«ã‚‚ã„ãã¤ã‹ã®æ¨™æº–ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒä½¿ãˆãªã„å ´åˆãŒã‚ã‚‹ã‚‰ã—ã„ï¼‰ã€‚</p>
<p>ãŸã¨ãˆã°å…ˆã»ã©ã®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">ch</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kd">struct</span><span class="p">{})</span>
    <span class="nx">js</span><span class="p">.</span><span class="nf">Global</span><span class="p">().</span><span class="nf">Get</span><span class="p">(</span><span class="s">&#34;document&#34;</span><span class="p">).</span><span class="nf">Call</span><span class="p">(</span><span class="s">&#34;getElementById&#34;</span><span class="p">,</span> <span class="s">&#34;hello&#34;</span><span class="p">).</span><span class="nf">Set</span><span class="p">(</span><span class="s">&#34;innerHTML&#34;</span><span class="p">,</span> <span class="s">&#34;Hello, World!&#34;</span><span class="p">)</span>
<span class="hl">    <span class="o">&lt;-</span><span class="nx">ch</span> <span class="c1">// Code must not finish
</span></span><span class="c1"></span><span class="p">}</span>
</code></pre></div><p>ã®æœ€å¾Œã‚’è¦‹ã‚‹ã¨ï¼Œãƒãƒ£ãƒãƒ«å—ä¿¡çŠ¶æ…‹ã§å‡¦ç†ãŒæ­¢ã¾ã£ã¦ã„ã‚‹ãŒï¼ˆã¨ã„ã†ã‹æ­¢ã‚ã‚‹ãŸã‚ã«ã‚ã–ã‚ã–ã“ã®ã‚ˆã†ã«æ›¸ã„ã¦ã„ã‚‹ã®ã ãŒï¼‰ï¼Œã“ã‚ŒãŒãªã„ã¨ <a href="https://tinygo.org/" title="TinyGo - Go on Microcontrollers and WASM">TinyGo</a> ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãŒã‚¨ãƒ©ãƒ¼ã‚’åãå ´åˆãŒã‚ã‚‹ã‚ˆã†ã ã€‚</p>
<h3><a href="https://webassembly.org/" title="WebAssembly">WebAssembly</a> ã‚³ãƒ¼ãƒ‰ã®ãƒã‚¤ãƒ³ãƒ‰</h3>
<p><code>hello/wasm.js</code> ãƒ•ã‚¡ã‚¤ãƒ«ã¯ç”Ÿæˆã—ãŸ <a href="https://webassembly.org/" title="WebAssembly">WebAssembly</a> ã‚³ãƒ¼ãƒ‰ã‚’ JavaScript å´ã«ãƒã‚¤ãƒ³ãƒ‰ã™ã‚‹ã‚‚ã®ã§ã‚ã‚‹ã€‚
ä»Šå›ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ã„ã¦ã¿ãŸã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">initWASM</span><span class="p">(</span><span class="nx">url</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">go</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Go</span><span class="p">();</span>

    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;instantiateStreaming&#39;</span> <span class="k">in</span> <span class="nx">WebAssembly</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">WebAssembly</span><span class="p">.</span><span class="nx">instantiateStreaming</span><span class="p">(</span><span class="nx">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">),</span> <span class="nx">go</span><span class="p">.</span><span class="nx">importObject</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">go</span><span class="p">.</span><span class="nx">run</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">instance</span><span class="p">);</span>
        <span class="p">})</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">fetch</span><span class="p">(</span><span class="nx">WASM_URL</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">resp</span> <span class="p">=&gt;</span>
            <span class="nx">resp</span><span class="p">.</span><span class="nx">arrayBuffer</span><span class="p">()</span>
        <span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">bytes</span> <span class="p">=&gt;</span>
            <span class="nx">WebAssembly</span><span class="p">.</span><span class="nx">instantiate</span><span class="p">(</span><span class="nx">bytes</span><span class="p">,</span> <span class="nx">go</span><span class="p">.</span><span class="nx">importObject</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">go</span><span class="p">.</span><span class="nx">run</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">instance</span><span class="p">);</span>
            <span class="p">})</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>ã“ã‚Œã§</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">initWASM</span><span class="p">(</span><span class="s1">&#39;hello2.wasm&#39;</span><span class="p">);</span>
</code></pre></div><p>ã¨ã„ã†æ„Ÿã˜ã«ä»»æ„ã® <a href="https://webassembly.org/" title="WebAssembly">WebAssembly</a> ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–ã‚Šè¾¼ã‚ã‚‹ã€‚</p>
<h3>HTML ã®å†…å®¹</h3>
<p>ä»¥ä¸Šã‚’è¸ã¾ãˆã¦ <code>hello/index.html</code> ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ãŸã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;utf-8&#34;</span><span class="p">/&gt;</span>
<span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Hello<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;wasm_exec.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;wasm.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;hello&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="nx">initWASM</span><span class="p">(</span><span class="s2">&#34;hello2.wasm&#34;</span><span class="p">);</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div><h3>å®Ÿè¡Œçµæœ</h3>
<p>ã§ã¯ï¼Œã„ã‚ˆã„ã‚ˆå‹•ã‹ã—ã¦ã¿ã‚ˆã†ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">$ go run main.go
Open http://localhost:3000/
Press ctrl+c to stop
</code></pre></div><p>è©²å½“ã® URL ã‚’é–‹ãã¨</p>
<figure style='margin:0 auto;text-align:center;'><a href="./hello1.png"><img src="./hello1.png" srcset="./hello1.png 500w" sizes="(min-width:600px) 500px, 80vw" alt="Hello"></a><figcaption><div><a href="./hello1.png">Hello</a></div></figcaption>
</figure>
<p>ã‚ˆãƒ¼ã—ï¼Œã¡ã‚ƒã‚“ã¨è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ãªã€‚
ã“ã“ã¾ã§ã¯æ¥½å‹ã€‚</p>
<h2><a href="https://webassembly.org/" title="WebAssembly">WebAssembly</a> ã®æ©Ÿèƒ½ã‚’ JavaScript ã‹ã‚‰å‘¼ã³å‡ºã™</h2>
<p>ä»¥ä¸Šã®ã‚³ãƒ¼ãƒ‰ã¯ <a href="https://webassembly.org/" title="WebAssembly">WebAssembly</a> å´ã‹ã‚‰ HTML è¦ç´ ã«å€¤ã‚’ã‚»ãƒƒãƒˆã—ã¦ã„ãŸãŒï¼Œã“ã‚Œã§ã¯ã‚ã¾ã‚Šå¿œç”¨ã§ããªã„ã ã‚ã†ã€‚
ãªã®ã§ï¼Œä»Šåº¦ã¯ JavaScript å´ã‹ã‚‰ <a href="https://webassembly.org/" title="WebAssembly">WebAssembly</a> ã®æ©Ÿèƒ½ã‚’å‘¼ã³å‡ºã™ã“ã¨ã‚’è€ƒãˆã‚‹ã€‚</p>
<p>ã¾ãšã¯ <code>hello/hello.go</code> ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰æ›´ã™ã‚‹ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="c1">// +build js,wasm
</span><span class="c1"></span>
<span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&#34;strings&#34;</span>
    <span class="s">&#34;syscall/js&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">say</span><span class="p">(</span><span class="nx">this</span> <span class="nx">js</span><span class="p">.</span><span class="nx">Value</span><span class="p">,</span> <span class="nx">args</span> <span class="p">[]</span><span class="nx">js</span><span class="p">.</span><span class="nx">Value</span><span class="p">)</span> <span class="kd">interface</span><span class="p">{}</span> <span class="p">{</span>
    <span class="nx">ss</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{}</span>
    <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">jss</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">args</span> <span class="p">{</span>
        <span class="k">if</span> <span class="nx">s</span> <span class="o">:=</span> <span class="nf">jsString</span><span class="p">(</span><span class="nx">jss</span><span class="p">);</span> <span class="nx">s</span> <span class="o">!=</span> <span class="s">&#34;&#34;</span> <span class="p">{</span>
            <span class="nx">ss</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">ss</span><span class="p">,</span> <span class="nx">s</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">js</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="s">&#34;Hello, &#34;</span> <span class="o">+</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">Join</span><span class="p">(</span><span class="nx">ss</span><span class="p">,</span> <span class="s">&#34;, &#34;</span><span class="p">))</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">jsString</span><span class="p">(</span><span class="nx">j</span> <span class="nx">js</span><span class="p">.</span><span class="nx">Value</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nx">j</span><span class="p">.</span><span class="nf">IsUndefined</span><span class="p">()</span> <span class="o">||</span> <span class="nx">j</span><span class="p">.</span><span class="nf">IsNull</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&#34;&#34;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">j</span><span class="p">.</span><span class="nf">String</span><span class="p">()</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">ch</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kd">struct</span><span class="p">{})</span>
    <span class="nx">js</span><span class="p">.</span><span class="nf">Global</span><span class="p">().</span><span class="nf">Set</span><span class="p">(</span><span class="s">&#34;say&#34;</span><span class="p">,</span> <span class="nx">js</span><span class="p">.</span><span class="nf">FuncOf</span><span class="p">(</span><span class="nx">say</span><span class="p">))</span>
    <span class="o">&lt;-</span><span class="nx">ch</span> <span class="c1">// Code must not finish
</span><span class="c1"></span><span class="p">}</span>
</code></pre></div><p>JavaScript ã‹ã‚‰å‘¼ã³å‡ºã™é–¢æ•°ã¯</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span><span class="p">(</span><span class="nx">this</span> <span class="nx">js</span><span class="p">.</span><span class="nx">Value</span><span class="p">,</span> <span class="nx">args</span> <span class="p">[]</span><span class="nx">js</span><span class="p">.</span><span class="nx">Value</span><span class="p">)</span> <span class="kd">interface</span><span class="p">{}</span>
</code></pre></div><p>ã®é–¢æ•°å‹ã«ã™ã‚‹æ±ºã¾ã‚Šã®ã‚ˆã†ã ã€‚
ã¾ãŸè¿”ã‚Šå€¤ã¯ <a href="https://golang.org/pkg/syscall/js/" title="js - The Go Programming Language"><code>js</code></a><code>.Value</code> å‹ã«ã—ã¦è¿”ã™ã®ã ãŒï¼Œå®Ÿéš›ã® <a href="https://golang.org/" title="The Go Programming Language">Go</a> ã®å‹ã¨ JavaScript ã®å‹ã®å¯¾å¿œã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã‚‰ã—ã„ã€‚</p>
<figure lang="en">
<blockquote class="nobox"><table>
<thead>
<tr>
<th>Go</th>
<th>JavaScript</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>js.Value</code></td>
<td>[its value]</td>
</tr>
<tr>
<td><code>js.Func</code></td>
<td><code>function</code></td>
</tr>
<tr>
<td><code>nil</code></td>
<td><code>null</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>boolean</code></td>
</tr>
<tr>
<td>integers and floats</td>
<td><code>number</code></td>
</tr>
<tr>
<td><code>string</code></td>
<td><code>string</code></td>
</tr>
<tr>
<td><code>[]interface{}</code></td>
<td><code>new array</code></td>
</tr>
<tr>
<td><code>map[string]interface{}</code></td>
<td><code>new object</code></td>
</tr>
</tbody>
</table>
</blockquote>
<figcaption><div>via <q><a href="https://golang.org/pkg/syscall/js/#ValueOf">js - The Go Programming Language</a></q></div></figcaption>
</figure>
<p>ã•ã‚‰ã« <code>main()</code> é–¢æ•°å†…ã®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">js</span><span class="p">.</span><span class="nf">Global</span><span class="p">().</span><span class="nf">Set</span><span class="p">(</span><span class="s">&#34;say&#34;</span><span class="p">,</span> <span class="nx">js</span><span class="p">.</span><span class="nf">FuncOf</span><span class="p">(</span><span class="nx">say</span><span class="p">))</span>
</code></pre></div><p>ã«ã‚ˆã£ã¦ <a href="https://golang.org/" title="The Go Programming Language">Go</a> ã® <code>say()</code> é–¢æ•°ã¯ JavaScript ã® <code>global.say()</code> é–¢æ•°ã«ç´ä»˜ã‘ã‚‰ã‚Œã‚‹ã€‚</p>
<p><code>hello/wasm.js</code> ãƒ•ã‚¡ã‚¤ãƒ«ã¯ãã®ã¾ã¾ã§OKã€‚
<code>hello/index.html</code> ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãæ›ãˆã‚‹ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;utf-8&#34;</span><span class="p">/&gt;</span>
<span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Hello<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;wasm_exec.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;wasm.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
	<span class="p">&lt;</span><span class="nt">button</span><span class="p">&gt;</span>Hello<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
	<span class="p">&lt;</span><span class="nt">p</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;hello&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
	<span class="nx">initWASM</span><span class="p">(</span><span class="s1">&#39;hello2.wasm&#39;</span><span class="p">);</span>
	<span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;button&#39;</span><span class="p">).</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="nx">event</span> <span class="p">=&gt;</span> <span class="p">{</span>
		<span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;hello&#34;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">global</span><span class="p">.</span><span class="nx">say</span><span class="p">(</span><span class="s2">&#34;Alice&#34;</span><span class="p">,</span> <span class="s2">&#34;Bob&#34;</span><span class="p">,</span> <span class="s2">&#34;Chris&#34;</span><span class="p">);</span>
	<span class="p">});</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div><p>ã“ã‚Œã§ <code>[Hello]</code> ãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ <code>global.say()</code> é–¢æ•°ãŒç™ºç«ã™ã‚‹ã¯ãšã§ã‚ã‚‹ã€‚
å®Ÿè¡Œã—ã¦ã¿ã‚ˆã†ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">$ go run main.go
Open http://localhost:3000/
Press ctrl+c to stop
</code></pre></div><p>ã“ã®çŠ¶æ…‹ã§ç”»é¢ã‚’è¡¨ç¤ºã™ã‚‹ã¨</p>
<figure style='margin:0 auto;text-align:center;'><a href="./hello-button1.png"><img src="./hello-button1.png" srcset="./hello-button1.png 500w" sizes="(min-width:600px) 500px, 80vw" alt="Hello Button (1)"></a><figcaption><div><a href="./hello-button1.png">Hello Button (1)</a></div></figcaption>
</figure>
<p>ã•ã‚‰ã«ãƒœã‚¿ãƒ³ã‚’æŠ¼ä¸‹ã™ã‚‹ã¨</p>
<figure style='margin:0 auto;text-align:center;'><a href="./hello-button2.png"><img src="./hello-button2.png" srcset="./hello-button2.png 500w" sizes="(min-width:600px) 500px, 80vw" alt="Hello Button (2)"></a><figcaption><div><a href="./hello-button2.png">Hello Button (2)</a></div></figcaption>
</figure>
<p>ã‚ˆãƒ¼ã—ï¼Œã†ã‚€ã†ã‚€ï¼Œã‚ˆãƒ¼ã—ã€‚</p>
<p>ã“ã‚Œãªã‚‰å¿œç”¨ãŒåŠ¹ããã†ã‹ãªã€‚
ä»Šå›ã¯ã“ã“ã¾ã§ã€‚</p>
<h2>ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯</h2>
<ul>
<li><a href="https://github.com/golang/go/wiki/WebAssembly">WebAssembly Â· golang/go Wiki Â· GitHub</a></li>
<li><a href="https://wasmer.io/posts/wasmer-go-embedding-1.0">Wasmer Go embedding 1.0 lift-off</a>
<ul>
<li><a href="https://github.com/wasmerio/wasmer-go">GitHub - wasmerio/wasmer-go: ğŸ¹ğŸ•¸ï¸ WebAssembly runtime for Go</a></li>
</ul>
</li>
<li><a href="https://wasmbyexample.dev/examples/webassembly-linear-memory/webassembly-linear-memory.go.en-us.html">Wasm By Example</a></li>
<li><a href="https://bearmini.hatenablog.com/entry/2019/12/23/173924">Go è£½ WebAssembly ãƒ›ã‚¹ãƒˆç’°å¢ƒãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ wax ã®ã”ç´¹ä»‹ - bearmini&rsquo;s blog</a></li>
<li><a href="https://buildersbox.corp-sansan.com/entry/2019/02/14/113000">Go Ã— WebAssemblyã§é›»å“ã®Webã‚¢ãƒ—ãƒªã‚’ä½œã£ã¦ã¿ãŸ - Sansan Builders Blog</a></li>
<li><a href="https://qiita.com/takewell/items/c99b44d912448e9170e6">WASI (WebAssembly system interface) ã‚’ Wasmtime ã¨ Node.js ã§è©¦ã™ - Qiita</a></li>
<li><a href="https://zenn.dev/ikawaha/articles/20210331-e661ac866f5ff0fc5eb8">Go ã®å½¢æ…‹ç´ è§£æå™¨ã‚’ wasm ã§åˆ©ç”¨ã™ã‚‹</a> : ã“ã®ã‚³ãƒ¼ãƒ‰ä¾‹ã¯å‚è€ƒã«ãªã‚‹</li>
</ul>
<h2>å‚è€ƒå›³æ›¸</h2>
<div class="hreview">
  <div class="photo"><a href="https://www.amazon.co.jp/dp/B08T7D2LFR?tag=baldandersinf-22&amp;linkCode=ogi&amp;th=1&amp;psc=1"><img src="https://m.media-amazon.com/images/I/51hVE3r&#43;6XL._SL160_.jpg" width="113" alt="photo"></a></div>
  <dl>
    <dt class="item"><a class="fn url" href="https://www.amazon.co.jp/dp/B08T7D2LFR?tag=baldandersinf-22&amp;linkCode=ogi&amp;th=1&amp;psc=1">ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãƒ‡ã‚¶ã‚¤ãƒ³ 2021å¹´3æœˆå·</a></dt>
    <dd>è°·æœ¬ å¿ƒ (è‘—), æ°´å³¶ å®å¤ª (è‘—), å¢—ç”° äº¨ (è‘—), å±±æœ¬ æ‚ æ»‹ (è‘—), æŠ˜åŸ ãƒ¬ã‚ªãƒŠãƒ«ãƒ‰è³¢ (è‘—), ç±³ç”° æ­¦ (è‘—), æ¸…æ°´ æ´‹æ²» (è‘—), çµåŸ æµ© (è‘—), åˆ€æ ¹ è«’ (è‘—), å¤§ä¸² è‚‡ (è‘—), æ¾æœ¬ ç›´äºº (è‘—), ã‚¯ãƒ©ã‚¹ãƒ¡ã‚½ãƒƒãƒ‰ æœ¨æ‘(ä½œ) (è‘—), ã‚¨ã‚¯ã‚¹ãƒ‡ã‚¶ã‚¤ãƒ³ ninnzinn(ç”») (è‘—), ãã¤ãªã‚Šã‚‡ã†ã™ã‘ (è‘—), åºƒæœ¨ å¤§åœ° (è‘—), ä¸­å³¶ æ˜æ—¥é¦™ (è‘—), é‡‘è°· æ‹“å“‰ (è‘—), é«˜æ©‹ æ°¸æˆ (è‘—), å¹³å²¡ æ­£å¯¿ (è‘—), æ¢¶åŸ ç›´äºº(ç›£ä¿®) (è‘—), å¹³æ«› è²´ç«  (è‘—), æ˜Ÿå· çœŸéº» (è‘—), ã‘ã‚“ã¡ã‚‡ã‚“(å¤§æ§» å…¼è³‡) (è‘—), å¤§å¶‹ å¥å®¹ (è‘—), è·æ¥­ã€Œæˆ¸å€‰å½©ã€ (è‘—), mattn (è‘—), å°é‡ è¼ä¹Ÿ (è‘—), æ¿±ç”° åº·è²´ (è‘—), æ£®è‹¥ å’Œé›„ (è‘—), å¤å· èœæ‘˜ (è‘—), å˜‰å±± é™½ä¸€ (è‘—), å¹³é‡ å°šå¿— (è‘—), æ‰å±± è²´ç«  (è‘—), Software Designç·¨é›†éƒ¨ (ç·¨é›†)</dd>
    <dd>æŠ€è¡“è©•è«–ç¤¾ 2021-02-18 (Release 2021-02-18)</dd>
    <dd>é›‘èªŒ</dd>
    <dd>B08T7D2LFR (ASIN), 4910058270316 (EAN)</dd>
    <dd>è©•ä¾¡<abbr class="rating fa-sm" title="3">&nbsp;<i class="fas fa-star"></i>&nbsp;<i class="fas fa-star"></i>&nbsp;<i class="fas fa-star"></i>&nbsp;<i class="far fa-star"></i>&nbsp;<i class="far fa-star"></i></abbr></dd>
  </dl>
  <p class="description">ç¬¬2ç‰¹é›†ãŒã€ŒWebAssembly å…¥é–€ã€è¿‘å¹´ã®å‹•å‘ã‚’æŠŠæ¡ã™ã‚‹ã«ã¯ä¸åº¦ã„ã„ã ã‚ã†ã€‚</p>
  <p class="powered-by">reviewed by <a href='#maker' class='reviewer'>Spiegel</a> on <abbr class="dtreviewed" title="2021-03-21">2021-03-21</abbr> (powered by <a href="https://affiliate.amazon.co.jp/assoc_credentials/home">PA-APIv5</a>)</p>
</div> <!-- ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãƒ‡ã‚¶ã‚¤ãƒ³ 2021å¹´3æœˆå· -->
<div class="hreview">
  <div class="photo"><a href="https://www.amazon.co.jp/dp/B099928SJD?tag=baldandersinf-22&amp;linkCode=ogi&amp;th=1&amp;psc=1"><img src="https://m.media-amazon.com/images/I/416Stewy0NS._SL160_.jpg" width="123" alt="photo"></a></div>
  <dl>
    <dt class="item"><a class="fn url" href="https://www.amazon.co.jp/dp/B099928SJD?tag=baldandersinf-22&amp;linkCode=ogi&amp;th=1&amp;psc=1">ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªGo</a></dt>
    <dd>ã‚¢ãƒ©ãƒ³ãƒ»ãƒ‰ãƒãƒãƒ³ (è‘—), ãƒ–ãƒ©ã‚¤ã‚¢ãƒ³ãƒ»ã‚«ãƒ¼ãƒ‹ãƒãƒ³ (è‘—), æŸ´ç”°èŠ³æ¨¹ (è‘—)</dd>
    <dd>ä¸¸å–„å‡ºç‰ˆ 2016-06-20 (Release 2021-07-13)</dd>
    <dd>Kindleç‰ˆ</dd>
    <dd>B099928SJD (ASIN)</dd>
    <dd>è©•ä¾¡<abbr class="rating fa-sm" title="5">&nbsp;<i class="fas fa-star"></i>&nbsp;<i class="fas fa-star"></i>&nbsp;<i class="fas fa-star"></i>&nbsp;<i class="fas fa-star"></i>&nbsp;<i class="fas fa-star"></i></abbr></dd>
  </dl>
  <p class="description">Kindle ç‰ˆå‡ºãŸï¼ ä¸€éƒ¨å†…å®¹ãŒå¤ã³ã¦ã—ã¾ã£ãŸãŒï¼Œã“ã®æœ¬ã¯ Go è¨€èªã®æ•™ç§‘æ›¸ã¨è¨€ã£ã¦ã‚‚ã„ã„ã ã‚ã†ã€‚æ„Ÿæƒ³ã¯<a href="/remark/2016/07/go-programming-language/" >ã“ã¡ã‚‰</a>ã€‚</p>
  <p class="powered-by">reviewed by <a href='#maker' class='reviewer'>Spiegel</a> on <abbr class="dtreviewed" title="2021-05-22">2021-05-22</abbr> (powered by <a href="https://affiliate.amazon.co.jp/assoc_credentials/home">PA-APIv5</a>)</p>
</div> <!-- ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªGo -->

</section>

</article>
</main>
<nav class="page-nav">
<div class="prev-page">&laquo; <a href="/golang/special-forms/">ç‰¹æ®Šå½¢å¼ã«ã‚ˆã‚‹å¼è©•ä¾¡ã«ã¤ã„ã¦</a></div>
<div class="next-page"><a href="/golang/wasi-with-tinygo/">TinyGo ã§ WASI ã€å¤±æ•—ç·¨ã€‘</a> &raquo;</div>
</nav>

<aside class="feedback" id='feedback'>
<h1>Feedback</h1>
<p>GitHub ã«<a href="https://github.com/spiegel-im-spiegel/github-pages-env/discussions">ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ç”¨ã®ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ãƒšãƒ¼ã‚¸</a>ã‚’ç”¨æ„ã—ã¾ã—ãŸã€‚
æ›¸ãè¾¼ã¿ã«ã¯ GitHub ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒå¿…è¦ã§ã™ãŒï¼ŒãŠæ°—è»½ã«ã”åˆ©ç”¨ãã ã•ã„ã€‚</p>
<p>ä»–ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯æ‰‹æ®µã¨ã—ã¦ Twitter, Facebook ã¾ãŸã¯é›»å­ãƒ¡ãƒ¼ãƒ«ã‚‚åˆ©ç”¨ã§ãã¾ã™ã€‚é›»å­ãƒ¡ãƒ¼ãƒ«ã‚’åˆ©ç”¨ã™ã‚‹éš›ã®å…¬é–‹éµã¯<a href="https://baldanders.info/profile/">ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«</a>ã‹ã‚‰å–å¾—ã§ãã¾ã™ã€‚</p>
</aside>
<footer>


<div class="userinfo">
	<div class="userinfo-avater">
		<a href="https://baldanders.info/profile/"><img src="https://text.baldanders.info/images/avatar.jpg" width="48" height="48" alt="avatar" id="logo"></a>
	</div>
	<div class="userinfo-info" id="maker">
		Text by <a href="https://baldanders.info/profile/" rel="cc:attributionURL" property="cc:attributionName">Spiegel</a>
		in <time property='dc:dateCopyrighted'>2021-03-11</time> (revised in 2021-08-13)
		<a rel='cc:license' href="https://creativecommons.org/licenses/by-sa/4.0/"><i class="fab fa-creative-commons"></i>&nbsp;<i class="fab fa-creative-commons-by"></i>&nbsp;<i class="fab fa-creative-commons-sa"></i></a>
		<ul class="social"><li><a href="https://github.com/spiegel-im-spiegel"><span class="github-color"><i class="fab fa-github"></i></span></a></li><li><a href="https://www.flickr.com/photos/spiegel/"><span class="flickr-color"><i class="fab fa-flickr"></i></span></a></li><li><a href="https://twitter.com/spiegel_2007"><span class="twitter-color"><i class="fab fa-twitter"></i></span></a></li></ul>
	</div>
</div>

<nav>
<ul class='cloud center'>
<li><a href='https://github.com/spiegel-im-spiegel/spiegel-im-spiegel.github.io'>Repository</a></li>
<li><a href='/reviews/'>Reviews</a></li>
<li><a href='/about-feeds/'>Feeds</a></li>
<li><a href='/site-policy/'>Policy</a></li>
<li><a href='https://validator.w3.org/nu/?doc=https%3a%2f%2ftext.baldanders.info%2fgolang%2fwebassembly-with-tinygo%2f&amp;showoutline=yes'>Debug</a></li>
</ul>
<ul class='cloud center'>
<li><a href='https://baldanders.info/'>Home</a></li>
<li><a href='https://photo.baldanders.info/'>Photos</a></li>
<li><a href='https://slide.baldanders.info/'>Slide</a></li>
<li><a href='https://zenn.dev/spiegel'>Zenn</a></li>
</ul>
<ul class='cloud center'>
<li>Powered by <a href='https://gohugo.io/'>Hugo 0.88.0</a> and <a href="https://github.com/spiegel-im-spiegel/hugo-theme-baldanders-info
">Theme of Baldanders.info</a>.</li>
</ul>
</nav>
</footer>
</div>

</body>
</html>
