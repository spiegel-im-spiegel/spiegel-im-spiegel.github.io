<!DOCTYPE html>
<html lang="ja">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="generator" content="Hugo 0.109.0">
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
<link rel="apple-touch-icon" type="image/png" sizes="144x144" href="/apple-icon-144x144.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/android-icon-192x192.png">
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="https://text.baldanders.info/golang/mirror-index-and-checksum-database-for-go-module/">
<script src="//kit.fontawesome.com/152e339e63.js"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=BIZ+UDGothic:wght@400;700&family=BIZ+UDMincho&family=Inconsolata:wght@400;700&family=Noto+Color+Emoji&family=Noto+Sans:wght@400;700&family=Noto+Serif&display=swap" rel="stylesheet">
<link rel="stylesheet" href="/css/local-font.css" type='text/css'>
<link rel="stylesheet" href="/css/baldanders-info-dark.css" type='text/css'>

<link rel="alternate" href="https://text.baldanders.info/index.xml" type="application/rss+xml" title="text.Baldanders.info">
<link rel="alternate" href="https://text.baldanders.info/index.json" type="application/json" title="text.Baldanders.info">
<meta name="google-site-verification" content="jTjBCslPtf8gwVatiY-GDgGv7pV5csa8aUOw1MRPUD4">
<title>Go モジュールのミラーリング・サービス【正式版】 | text.Baldanders.info</title>
<meta property="og:title" content="Go モジュールのミラーリング・サービス【正式版】">
<meta name="description" content="Google による Go モジュールの公式ミラーリング・サービスが正式リリースした。">
<meta property="og:description" content="Google による Go モジュールの公式ミラーリング・サービスが正式リリースした。">
<meta property="og:image" content="https://text.baldanders.info/images/attention/go-logo_blue.png">
<meta name="author" content="Spiegel">


<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@spiegel_2007">
<meta name="twitter:creator" content="@spiegel_2007">
<link rel="me" href="https://fedibird.com/@spiegel">
<meta name="keywords" content="golang, module, engineering, management">
<link rel='prev' href='https://text.baldanders.info/golang/go-env/' title='Go 言語の環境変数管理' />
<link rel='next' href='https://text.baldanders.info/golang/formatting/' title='書式 %v のカスタマイズ' />

<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "WebSite",
	"@id": "https://text.baldanders.info/",
	"inLanguage": "ja",
	"name": "text.Baldanders.info",
    "url": "https://text.baldanders.info/",
	"publisher": {
		"@id": "https://text.baldanders.info/#org"
	},
	"author": {
		"@id": "https://text.baldanders.info/#maker"
	},
	"image": "https://text.baldanders.info/images/attention/site.jpg",
	"description": "帰ってきた「しっぽのさきっちょ」"
}
</script>
<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "Organization",
	"@id": "https://text.baldanders.info/#org",
	"name": "Spiegel",
	"logo": {
		"@type": "ImageObject",
		"@id": "https://text.baldanders.info/#logo",
		"url": "https://text.baldanders.info/images/avatar.jpg"
	}
}
</script>
<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "Person",
	"@id": "https://text.baldanders.info/#maker",
	"name": "Spiegel",
	"url": "https://baldanders.info/profile/",
	"image": "https://text.baldanders.info/images/avatar.jpg"
}
</script>
<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "Blog",
	"@id": "https://text.baldanders.info/golang/",
	"url": "https://text.baldanders.info/golang/",
	"inLanguage": "ja",
	"name": "プログラミング言語 Go",
	"description": "Go 言語プログラミングに関する話題。",
	"image": "https://text.baldanders.info/images/attention/go-logo_blue.png",
	"publisher": {
		"@id": "https://text.baldanders.info/#org"
	},
	"author": {
		"@id": "https://text.baldanders.info/#maker"
	}
}
</script>
<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "BreadcrumbList",
	"@id": "https://text.baldanders.info/golang/mirror-index-and-checksum-database-for-go-module/#breadcrumb-list",
	"itemListElement": [
		{
			"@type": "ListItem",
			"position": 1,
			"item": {
				"@id": "https://text.baldanders.info/"
			}
		},
		{
			"@type": "ListItem",
			"position": 2,
			"item": {
				"@id": "https://text.baldanders.info/golang/"
			}
		}
	]
}
</script>
<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "BlogPosting",
	"@id": "https://text.baldanders.info/golang/mirror-index-and-checksum-database-for-go-module/",
	"url": "https://text.baldanders.info/golang/mirror-index-and-checksum-database-for-go-module/",
	"mainEntityOfPage": "https://text.baldanders.info/golang/mirror-index-and-checksum-database-for-go-module/",
	"inLanguage": "ja",
	"name": "Go モジュールのミラーリング・サービス【正式版】",
	"description": "Google による Go モジュールの公式ミラーリング・サービスが正式リリースした。",
	"headline": "Google による Go モジュールの公式ミラーリング・サービスが正式リリースした。",
	"keywords": "golang, module, engineering, management",
	"image": "https://text.baldanders.info/images/attention/go-logo_blue.png",
	"datePublished": "2019-09-01T10:39:57+00:00",
	"dateModified": "2021-12-04T02:40:05+00:00",
	"publisher": {
		"@id": "https://text.baldanders.info/#org"
	},
	"author": {
		"@id": "https://text.baldanders.info/#maker"
	},
	"license": "https://creativecommons.org/licenses/by-sa/4.0/"
}
</script>
</head>
<body>

<div id='container'>

<main>
<nav class="breadcrumb">
<a href="https://text.baldanders.info/">text.Baldanders.info</a> &raquo; <a href="/golang/">プログラミング言語 Go</a>
</nav>
<article>
<h1>Go モジュールのミラーリング・サービス【正式版】</h1>
<nav class="tags">
	<div><a href='/tags/'>Tags</a>: #<a href="/tags/engineering/">engineering</a> #<a href="/tags/golang/">golang</a> #<a href="/tags/management/">management</a> #<a href="/tags/module/">module</a></div>
	<div class="cloud">
		<span class="share-color" title="Share this entry"><i class="fas fa-share-square"></i></span>&nbsp;:
		&nbsp;<a href="https://getpocket.com/edit?url=https%3a%2f%2ftext.baldanders.info%2fgolang%2fmirror-index-and-checksum-database-for-go-module%2f&amp;title=Go%20%e3%83%a2%e3%82%b8%e3%83%a5%e3%83%bc%e3%83%ab%e3%81%ae%e3%83%9f%e3%83%a9%e3%83%bc%e3%83%aa%e3%83%b3%e3%82%b0%e3%83%bb%e3%82%b5%e3%83%bc%e3%83%93%e3%82%b9%e3%80%90%e6%ad%a3%e5%bc%8f%e7%89%88%e3%80%91" target="_blank"><span class="pocket-color"><i class="fab fa-get-pocket" aria-hidden="true"></i></span></a>
		&nbsp;<a href="http://www.facebook.com/share.php?u=https%3a%2f%2ftext.baldanders.info%2fgolang%2fmirror-index-and-checksum-database-for-go-module%2f" target="_blank"><span class="facebook-color"><i class="fab fa-facebook-square" aria-hidden="true"></i></span></a>&nbsp;<a href="http://twitter.com/share?text=Go%20%e3%83%a2%e3%82%b8%e3%83%a5%e3%83%bc%e3%83%ab%e3%81%ae%e3%83%9f%e3%83%a9%e3%83%bc%e3%83%aa%e3%83%b3%e3%82%b0%e3%83%bb%e3%82%b5%e3%83%bc%e3%83%93%e3%82%b9%e3%80%90%e6%ad%a3%e5%bc%8f%e7%89%88%e3%80%91+by+@spiegel_2007&amp;url=https%3a%2f%2ftext.baldanders.info%2fgolang%2fmirror-index-and-checksum-database-for-go-module%2f" target="_blank"><span class="twitter-color"><i class="fab fa-twitter-square" aria-hidden="true"></i></span></a>&nbsp;<a href="https://donshare.net/share.html?text=Go%20%e3%83%a2%e3%82%b8%e3%83%a5%e3%83%bc%e3%83%ab%e3%81%ae%e3%83%9f%e3%83%a9%e3%83%bc%e3%83%aa%e3%83%b3%e3%82%b0%e3%83%bb%e3%82%b5%e3%83%bc%e3%83%93%e3%82%b9%e3%80%90%e6%ad%a3%e5%bc%8f%e7%89%88%e3%80%91+by+@spiegel%40fedibird.com+https%3a%2f%2ftext.baldanders.info%2fgolang%2fmirror-index-and-checksum-database-for-go-module%2f" target="_blank"><span class="mastodon-color"><i class="fa-brands fa-mastodon"></i></span></a></div>
</nav>
<nav class="history">History in
  <a href="https://github.com/spiegel-im-spiegel/spiegel-im-spiegel.github.io/commits/master/golang/mirror-index-and-checksum-database-for-go-module/index.html">GitHub Page</a>
</nav>

<section>
<p>（この記事は「<a href="https://text.baldanders.info/release/2019/05/mirror-index-and-checksum-database-for-go-module/">Go モジュールのミラーリングとインデックス化</a>」を全面改訂したものです）</p>
<p>Google による <a href="https://go.dev/">Go</a> モジュールの公式ミラーリング・サービスが正式リリースした。</p>
<ul>
<li><a href="https://blog.golang.org/module-mirror-launch">Module Mirror and Checksum Database Launched - The Go Blog</a>
<ul>
<li><a href="https://proxy.golang.org/"><code>proxy.golang.org</code></a></li>
<li><a href="https://sum.golang.org/"><code>sum.golang.org</code></a></li>
<li><a href="https://index.golang.org/"><code>index.golang.org</code></a></li>
</ul>
</li>
</ul>
<h2>モジュール・ミラー</h2>
<p>ミラー・サーバ <a href="https://proxy.golang.org/"><code>proxy.golang.org</code></a> は <a href="https://golang.org/" title="The Go Programming Language">Go 言語</a>のモジュールをミラーリングする一種のプロキシ・サーバとして機能する。
ただし，単純な透過プロキシではなく必要なバージョンのみ取ってこれるようになっているようだ。</p>
<figure style='margin:0 auto;text-align:center;'><a href="https://blog.golang.org/module-mirror-launch"><img src="https://blog.golang.org/module-mirror-launch/proxy-protocol.png" srcset="https://blog.golang.org/module-mirror-launch/proxy-protocol.png 2106w" sizes="(min-width:600px) 500px, 80vw" alt="Module Mirror and Checksum Database Launched" loading="lazy"></a><figcaption><div><a href="https://blog.golang.org/module-mirror-launch">Module Mirror and Checksum Database Launched</a></div></figcaption>
</figure>
<p>ミラー・サーバは環境変数 <code>GOPROXY</code> で URL を指定する。
<code>GOPROXY</code> の既定値は <a href="https://go.dev/">Go</a> 1.13 では以下のようになっている。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">$ go env | grep GOPROXY
</span></span><span class="line"><span class="cl">GOPROXY=&#34;https://proxy.golang.org,direct&#34;
</span></span></code></pre></div><p>ミラー・サーバは複数指定できる（指定する場合はカンマで区切る）。
ミラーリングを無効にする場合は <code>GOPROXY</code> に <code>direct</code> のみを指定する。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">go env -w GOPROXY=direct
</span></span></code></pre></div><p>ミラーリングが有効な状態で特定の非公開モジュールを使う場合は <code>GOPRIVATE</code> に非公開モジュールのパスを指定する。</p>
<h2>チェックサム・データベース</h2>
<p><a href="https://golang.org/" title="The Go Programming Language">Go 言語</a>では利用するモジュールの完全性（integrity）を担保するために <code>go.sum</code> ファイルにモジュールの SHA-256 チェックサム値を格納しているが，最初にモジュールをフェッチする場合はチェックサム値が分からないため無条件に信頼せざるを得ない。</p>
<p>公開されているモジュールのチェックサム値がデータベース化されていれば未知のモジュールに対しても（チェックサム・データベースを参照することで）ある程度の信頼性を確保できるだろう。</p>
<p>チェックサム・データベースは環境変数 <code>GOSUMDB</code> で指定する。
<code>GOSUMDB</code> の既定値は <a href="https://go.dev/">Go</a> 1.13 では以下のようになっている。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">$ go env | grep GOSUMDB
</span></span><span class="line"><span class="cl">GOSUMDB=&#34;sum.golang.org&#34;
</span></span></code></pre></div><p>チェックサム・データベースを無効にする場合は <code>GOSUMDB</code> に <code>off</code> をセットする。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">go env -w GOSUMDB=off
</span></span></code></pre></div><p>また特定のモジュールを検索対象から除外する場合は，ミラーリング除外のときと同じく <code>GOPRIVATE</code> が使える。</p>
<p>公式チェックサム・データベース <a href="https://sum.golang.org/"><code>sum.golang.org</code></a> は <a href="https://github.com/google/trillian" title="google/trillian: A transparent, highly scalable and cryptographically verifiable data store.">Trillian</a> による<a href="https://research.swtch.com/tlog" title="research!rsc: Transparent Logs for Skeptical Clients">透過ログ</a>（追記型データベース）で改竄に強いという特徴がある。</p>
<p>まぁ，最初から悪意のあるモジュールは排除しようがないが malicious code 混入は検知しやすくなるかも知れない。</p>
<h3>【2019-09-06 追記】 バージョンタグの管理に注意</h3>
<p>上で述べたように標準の <a href="https://sum.golang.org/"><code>sum.golang.org</code></a> は追記型のデータベースで，既存データの変更はできない仕様になっている。</p>
<p>たとえばパッケージ/モジュールのリポジトリにバージョンタグ（<code>v0.1.0</code> など）を付ける際に，うっかり間違ったコミットにタグを付けたとしても，一度 <a href="https://sum.golang.org/"><code>sum.golang.org</code></a> に登録されると取り消すことができない。
手動でタグの位置を変えても，モジュール読み込み時に</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">SECURITY ERROR
</span></span><span class="line"><span class="cl">This download does NOT match the one reported by the checksum server.
</span></span><span class="line"><span class="cl">The bits may have been replaced on the origin server, or an attacker may
</span></span><span class="line"><span class="cl">have intercepted the download attempt.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">For more information, see &#39;go help module-auth&#39;.
</span></span></code></pre></div><p>などと表示されビルドに失敗する。</p>
<p>少なくとも公開されているパッケージ/モジュールでは迂闊にバージョンタグを付け換えないよう，管理は慎重に行う必要がある。</p>
<h2>ミラーリング・サービスのプライバシー・ポリシー</h2>
<p>今回，正式稼働したミラーリング・サービスのプライバシー・ポリシーは以下のページある。</p>
<ul>
<li><a href="https://proxy.golang.org/privacy">Privacy: Go modules services</a></li>
</ul>
<p>以前はいきなり Google のページに飛ばされて「なんだかなぁ」という感じだったが，多少マシになったようである（笑）</p>
<p>これによると公式サービスでは以下の情報を収集しているようだ。</p>
<figure lang="en">
<blockquote><ul>
<li>Request timestamp</li>
<li>Client IP address</li>
<li>Full request URL, including:
<ul>
<li>service domain, e.g. proxy.golang.org</li>
<li>URI path being requested</li>
</ul>
</li>
<li>Response latency</li>
<li>Response bytes sent</li>
<li>Response code sent</li>
<li>The response returned by the go command when it runs in our systems</li>
<li>Whether the request hit our frontend cache</li>
<li>Whether the request hit a cache elsewhere in the system (but not the frontend)</li>
<li>Name of the Google machine that processed this request, e.g. machine101</li>
</ul>
</blockquote>
<figcaption><div>via <q><a href="https://proxy.golang.org/privacy">Privacy: Go modules services</a></q></div></figcaption>
</figure>
<p>取得した情報については</p>
<figure lang="en">
<blockquote><q>We do not store logged personally identifiable information such as IP addresses for more than 30 days. We also do not correlate or combine information from our request logs with any personal information that you have provided Google for other services.</q></blockquote>
<figcaption><div>via <q><a href="https://proxy.golang.org/privacy">Privacy: Go modules services</a></q></div></figcaption>
</figure>
<p>ということらしいが，最後の</p>
<figure lang="en">
<blockquote><q>We intend to aggregate and anonymize usage metrics to measure popularity for Go modules and share this popularity data with the Go community.</q></blockquote>
<figcaption><div>via <q><a href="https://proxy.golang.org/privacy">Privacy: Go modules services</a></q></div></figcaption>
</figure>
<p>てのがねぇ。
<a href="https://text.baldanders.info/remark/2018/04/handling-privacy/" title="誰がプライバシーを支配するのか">プライバシーに敵対的な企業</a>のサービスだと思うとあまり利用したくない気分なのだが（もちろん偏見），はてさて<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>。</p>
<h2>ブックマーク</h2>
<ul>
<li><a href="https://text.baldanders.info/release/2019/06/next-steps-toward-go-2/">Go 1.13 と 1.14 （Go 2 へ向けて）</a></li>
<li><a href="/golang/go-env/">Go 言語の環境変数管理</a></li>
</ul>
<h2>参考図書</h2>
<div class="hreview">
  <div class="photo"><a href="https://www.amazon.co.jp/dp/B099928SJD?tag=baldandersinf-22&amp;linkCode=ogi&amp;th=1&amp;psc=1"><img src="https://m.media-amazon.com/images/I/416Stewy0NS._SL160_.jpg" width="123" alt="photo"></a></div>
  <dl>
    <dt class="item"><a class="fn url" href="https://www.amazon.co.jp/dp/B099928SJD?tag=baldandersinf-22&amp;linkCode=ogi&amp;th=1&amp;psc=1">プログラミング言語Go</a></dt>
    <dd>アラン・ドノバン (著), ブライアン・カーニハン (著), 柴田芳樹 (著)</dd>
    <dd>丸善出版 2016-06-20 (Release 2021-07-13)</dd>
    <dd>Kindle版</dd>
    <dd>B099928SJD (ASIN)</dd>
    <dd>評価<abbr class="rating fa-sm" title="5">&nbsp;<i class="fas fa-star"></i>&nbsp;<i class="fas fa-star"></i>&nbsp;<i class="fas fa-star"></i>&nbsp;<i class="fas fa-star"></i>&nbsp;<i class="fas fa-star"></i></abbr></dd>
  </dl>
  <p class="description">Kindle 版出た！ 一部内容が古びてしまったが，この本は Go 言語の教科書と言ってもいいだろう。感想は<a href="/remark/2016/07/go-programming-language/" >こちら</a>。</p>
  <p class="powered-by">reviewed by <a href='#maker' class='reviewer'>Spiegel</a> on <abbr class="dtreviewed" title="2021-05-22">2021-05-22</abbr> (powered by <a href="https://affiliate.amazon.co.jp/assoc_credentials/home">PA-APIv5</a>)</p>
</div> <!-- プログラミング言語Go -->
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><a href="https://golang.org/" title="The Go Programming Language">Go 言語</a>にしろ（最近ブームが再燃している） Dart 言語にしろ，言語系のプロダクトやサービスは Google から切り離してほしいよなぁ。 Alphabet の傘下から外れろとまでは言わないから。&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

</section>

</article>
</main>
<nav class="page-nav">
<div class="prev-page">&laquo; <a href="/golang/go-env/">Go 言語の環境変数管理</a></div>
<div class="next-page"><a href="/golang/formatting/">書式 %v のカスタマイズ</a> &raquo;</div>
</nav>

<aside class="feedback" id='feedback'>
<h1>Feedback</h1>
<p>GitHub に<a href="https://github.com/spiegel-im-spiegel/github-pages-env/discussions">フィードバック用のディスカッションページ</a>を用意しました。
書き込みには GitHub のアカウントが必要ですが，お気軽にご利用ください。</p>
<p>他のフィードバック手段として Twitter, Facebook または電子メールも利用できます。電子メールを利用する際の公開鍵は<a href="https://baldanders.info/profile/">プロフィール</a>から取得できます。</p>
</aside>
<footer>


<div class="userinfo">
	<div class="userinfo-avater">
		<a href="https://baldanders.info/profile/"><img src="https://text.baldanders.info/images/avatar.jpg" width="48" height="48" alt="avatar" id="logo"></a>
	</div>
	<div class="userinfo-info" id="maker">
		Text by <a href="https://baldanders.info/profile/" rel="cc:attributionURL" property="cc:attributionName">Spiegel</a>
		in <time property='dc:dateCopyrighted'>2019-09-01</time> (revised in 2021-12-04)
		<a rel='cc:license' href="https://creativecommons.org/licenses/by-sa/4.0/"><i class="fab fa-creative-commons"></i>&nbsp;<i class="fab fa-creative-commons-by"></i>&nbsp;<i class="fab fa-creative-commons-sa"></i></a>
		<ul class="social"><li><a rel="me" href="https://github.com/spiegel-im-spiegel"><span class="github-color"><i class="fab fa-github"></i></span></a></li><li><a rel="me" href="https://www.flickr.com/photos/spiegel/"><span class="flickr-color"><i class="fab fa-flickr"></i></span></a></li><li><a rel="me" href="https://twitter.com/spiegel_2007"><span class="twitter-color"><i class="fab fa-twitter"></i></span></a></li><li><a rel="me" href="https://fedibird.com/@spiegel"><span class="mastodon-color"><i class="fa-brands fa-mastodon"></i></span></a></li></ul>
	</div>
</div>

<nav>
<ul class='cloud center'>
<li><a href='/about-feeds/'>Feeds</a></li>
<li><a href='/reviews/'>Reviews</a></li>
<li><a href='/site-policy/'>Policy</a></li>
<li><a href='https://github.com/spiegel-im-spiegel/spiegel-im-spiegel.github.io'>Repository</a></li>
<li><a href='https://validator.w3.org/nu/?doc=https%3a%2f%2ftext.baldanders.info%2fgolang%2fmirror-index-and-checksum-database-for-go-module%2f&amp;showoutline=yes'>Debug</a></li>
</ul>
<ul class='cloud center'>
<li><a href='https://baldanders.info/'>Home</a></li>
<li><a href='https://photo.baldanders.info/'>Photos</a></li>
<li><a href='https://slide.baldanders.info/'>Slide</a></li>
<li><a href='https://zenn.dev/spiegel'>Zenn</a></li>
</ul>
<ul class='cloud center'>
<li>Powered by <a href='https://gohugo.io/'>Hugo 0.109.0</a> and <a href="https://github.com/spiegel-im-spiegel/hugo-theme-baldanders-info
">Theme of Baldanders.info</a>.</li>
</ul>
</nav>
</footer>
</div>

</body>
</html>
