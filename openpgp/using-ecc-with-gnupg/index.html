<!DOCTYPE html>
<html lang="ja">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="generator" content="Hugo 0.62.0" />
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
<link rel="canonical" href="https://text.baldanders.info/openpgp/using-ecc-with-gnupg/">
<script src="//kit.fontawesome.com/152e339e63.js"></script>
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Inconsolata%3a400,700%7cNoto+Sans+JP%3a400,700%7cNoto+Sans%3a400,700%7cNoto+Serif%7cNoto+Serif+JP&display=swap" type='text/css'>
<link rel="stylesheet" href="/css/local-font.css" type='text/css'>
<link rel="stylesheet" href="/css/main.css" type='text/css'>
<link rel="stylesheet" href="/css/baldanders-info.css" type='text/css'>
<link rel="stylesheet" href="/css/chroma-styles.css">
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
	processEscapes: true,
    tags: 'ams',
    macros: {
      ssqrt: ['\\sqrt{\\smash[b]{\\mathstrut #1}}', 1],
      tcdegree: ['\\unicode{xb0}'],
      tccelsius: ['\\unicode{x2103}'],
      tcperthousand: ['\\unicode{x2030}'],
      tcmu: ['\\unicode{x3bc}'],
      tcohm: ['\\unicode{x3a9}']
    }
  },
  
  
  
  
  
  chtml: {
    matchFontHeight: false,
    displayAlign: "left",
    displayIndent: "2em"
  }
};
</script>
<script src="//polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link rel="alternate" href="https://text.baldanders.info/index.xml" type="application/rss+xml" title="text.Baldanders.info">
<link rel="alternate" href="https://text.baldanders.info/index.json" type="application/json" title="text.Baldanders.info">
<meta name="google-site-verification" content="jTjBCslPtf8gwVatiY-GDgGv7pV5csa8aUOw1MRPUD4">
<title>そろそろ GnuPG でも ECC を標準で使うのがいいんじゃないかな — OpenPGP の実装 | text.Baldanders.info</title>
<meta property="og:title" content="そろそろ GnuPG でも ECC を標準で使うのがいいんじゃないかな — OpenPGP の実装 | text.Baldanders.info">
<meta name="description" content="手っ取り早く ECC 鍵を作りたいなら --quick-generate-key コマンドでアルゴリズムに future-default を指定すればよい。">
<meta property="og:description" content="手っ取り早く ECC 鍵を作りたいなら --quick-generate-key コマンドでアルゴリズムに future-default を指定すればよい。">
<meta property="og:image" content="https://text.baldanders.info/images/attention/openpgp.png">
<meta name="author" content="Spiegel">


<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@spiegel_2007">
<meta name="twitter:creator" content="@spiegel_2007">
<meta name="keywords" content="cryptography, openpgp, management, gnupg, ecc">
<link rel='prev' href='https://text.baldanders.info/openpgp/issuer-fingerprint-signature-subpacket-in-next-openpgp/' title='Issuer Fingerprint Signature Subpacket in Next OpenPGP' />
<link rel='next' href='https://text.baldanders.info/openpgp/git-extensions-and-libreoffice-6-with-openpgp/' title='Git Extensions と LibreOffice 6 と OpenPGP' />

<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "WebSite",
	"@id": "https://text.baldanders.info/",
	"inLanguage": "ja",
	"name": "text.Baldanders.info",
    "url": "https://text.baldanders.info/",
	"publisher": {
		"@id": "https://text.baldanders.info/#org"
	},
	"author": {
		"@id": "https://text.baldanders.info/#maker"
	},
	"image": "https://text.baldanders.info/images/attention/site.jpg",
	"description": "帰ってきた「しっぽのさきっちょ」"
}
</script>
<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "Organization",
	"@id": "https://text.baldanders.info/#org",
	"name": "Spiegel",
	"logo": {
		"@type": "ImageObject",
		"@id": "https://text.baldanders.info/#logo",
		"url": "https://text.baldanders.info/images/avatar.jpg"
	}
}
</script>
<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "Person",
	"@id": "https://text.baldanders.info/#maker",
	"name": "Spiegel",
	"url": "https://baldanders.info/profile/",
	"image": "https://text.baldanders.info/images/avatar.jpg"
}
</script>
<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "Blog",
	"@id": "https://text.baldanders.info/openpgp/",
	"url": "https://text.baldanders.info/openpgp/",
	"inLanguage": "ja",
	"name": "OpenPGP の実装",
	"description": "OpenPGP とその実装である GnuPG 等に関する話題。",
	"image": "https://text.baldanders.info/images/attention/openpgp.png",
	"publisher": {
		"@id": "https://text.baldanders.info/#org"
	},
	"author": {
		"@id": "https://text.baldanders.info/#maker"
	}
}
</script>
<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "BreadcrumbList",
	"@id": "https://text.baldanders.info/openpgp/using-ecc-with-gnupg/#breadcrumb-list",
	"itemListElement": [
		{
			"@type": "ListItem",
			"position": 1,
			"item": {
				"@id": "https://text.baldanders.info/"
			}
		},
		{
			"@type": "ListItem",
			"position": 2,
			"item": {
				"@id": "https://text.baldanders.info/openpgp/"
			}
		}
	]
}
</script>
<script type="application/ld+json">
{
	"@context": "http://schema.org",
	"@type": "BlogPosting",
	"@id": "https://text.baldanders.info/openpgp/using-ecc-with-gnupg/",
	"url": "https://text.baldanders.info/openpgp/using-ecc-with-gnupg/",
	"mainEntityOfPage": "https://text.baldanders.info/openpgp/using-ecc-with-gnupg/",
	"inLanguage": "ja",
	"name": "そろそろ GnuPG でも ECC を標準で使うのがいいんじゃないかな",
	"description": "手っ取り早く ECC 鍵を作りたいなら --quick-generate-key コマンドでアルゴリズムに future-default を指定すればよい。",
	"headline": "手っ取り早く ECC 鍵を作りたいなら --quick-generate-key コマンドでアルゴリズムに future-default を指定すればよい。",
	"keywords": "cryptography, openpgp, management, gnupg, ecc",
	"image": "https://text.baldanders.info/images/attention/openpgp.png",
	"datePublished": "2017-12-02T07:20:26+00:00",
	"dateModified": "2019-11-27T09:43:43+00:00",
	"publisher": {
		"@id": "https://text.baldanders.info/#org"
	},
	"author": {
		"@id": "https://text.baldanders.info/#maker"
	},
	"license": "https://creativecommons.org/licenses/by-sa/4.0/"
}
</script>
</head>
<body>

<div id='container'>

<main>
<nav class="breadcrumb">
<a href="https://text.baldanders.info/">text.Baldanders.info</a> &raquo; <a href="/openpgp/">OpenPGP の実装</a>
</nav>
<article>
<h1>そろそろ GnuPG でも ECC を標準で使うのがいいんじゃないかな</h1>
<nav class="tags">
	<div><a href='/tags/'>Tags</a>: #<a href="/tags/cryptography/">cryptography</a> #<a href="/tags/ecc/">ecc</a> #<a href="/tags/gnupg/">gnupg</a> #<a href="/tags/management/">management</a> #<a href="/tags/openpgp/">openpgp</a></div>
	<div class="cloud">
		<span class="share-color" title="Share this entry"><i class="fas fa-share-square"></i></span>&nbsp;:&nbsp;
		<a href="http://www.facebook.com/share.php?u=https%3a%2f%2ftext.baldanders.info%2fopenpgp%2fusing-ecc-with-gnupg%2f" target="_blank"><span class="facebook-color"><i class="fab fa-facebook-square" aria-hidden="true"></i></span></a>
		<a href="http://twitter.com/share?text=%e3%81%9d%e3%82%8d%e3%81%9d%e3%82%8d%20GnuPG%20%e3%81%a7%e3%82%82%20ECC%20%e3%82%92%e6%a8%99%e6%ba%96%e3%81%a7%e4%bd%bf%e3%81%86%e3%81%ae%e3%81%8c%e3%81%84%e3%81%84%e3%82%93%e3%81%98%e3%82%83%e3%81%aa%e3%81%84%e3%81%8b%e3%81%aa+by+@spiegel_2007&amp;url=https%3a%2f%2ftext.baldanders.info%2fopenpgp%2fusing-ecc-with-gnupg%2f" target="_blank"><span class="twitter-color"><i class="fab fa-twitter-square" aria-hidden="true"></i></span></a>
		<a href="https://getpocket.com/edit?url=https%3a%2f%2ftext.baldanders.info%2fopenpgp%2fusing-ecc-with-gnupg%2f&amp;title=%e3%81%9d%e3%82%8d%e3%81%9d%e3%82%8d%20GnuPG%20%e3%81%a7%e3%82%82%20ECC%20%e3%82%92%e6%a8%99%e6%ba%96%e3%81%a7%e4%bd%bf%e3%81%86%e3%81%ae%e3%81%8c%e3%81%84%e3%81%84%e3%82%93%e3%81%98%e3%82%83%e3%81%aa%e3%81%84%e3%81%8b%e3%81%aa" target="_blank"><span class="pocket-color"><i class="fab fa-get-pocket" aria-hidden="true"></i></span></a>
		
	</div>
</nav>
<nav class="history">
	<a href="https://github.com/spiegel-im-spiegel/spiegel-im-spiegel.github.io/commits/master/openpgp/using-ecc-with-gnupg/index.html">History</a>
</nav>

<section>
<p>最初に言っておくと <a href="http://tools.ietf.org/html/rfc4880" title="RFC 4880 - OpenPGP Message Format">OpenPGP</a> では（秘密鍵の漏洩や暗号アルゴリズム等の危殆化がない限り）永続的に使われるのがよい鍵とされている<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>。
なので，無理に新しい鍵に切り替える必要はないのだが，もし <a href="https://gnupg.org/" title="The GNU Privacy Guard">GnuPG</a> で新しい鍵を作るのであれば ECC (Elliptic Curve Cryptography; 楕円曲線暗号) を選択するのがいいんじゃないかな？ という提案である。</p>
<h2 id="-ecc-">手っ取り早く ECC 鍵を作る</h2>
<p>手っ取り早く ECC 鍵を作りたいなら <code>--quick-generate-key</code> コマンドでアルゴリズムに <code>future-default</code> を指定すればよい。
（以下は有効期限を2年で指定する場合。無期限でいいなら <code>0</code> を指定する）</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">$ gpg --quick-gen-key &#34;Alice &lt;alice@example.com&gt;&#34; future-default - 2y
たくさんのランダム・バイトの生成が必要です。キーボードを打つ、マウスを動か
す、ディスクにアクセスするなどの他の操作を素数生成の間に行うことで、乱数生
成器に十分なエントロピーを供給する機会を与えることができます。

たくさんのランダム・バイトの生成が必要です。キーボードを打つ、マウスを動か
す、ディスクにアクセスするなどの他の操作を素数生成の間に行うことで、乱数生
成器に十分なエントロピーを供給する機会を与えることができます。
gpg: 失効証明書を &#39;C:/Users/slice/AppData/Roaming/gnupg/openpgp-revocs.d\F79B411717B86902177EA08200693613E2B68F5A.rev&#39; に保管しました。
公開鍵と秘密鍵を作成し、署名しました。

pub   ed25519 2017-12-02 [SC] [有効期限: 2019-12-02]
      F79B411717B86902177EA08200693613E2B68F5A
uid                      Alice &lt;alice@example.com&gt;
sub   cv25519 2017-12-02 [E]
</code></pre></div><p>作成した鍵を私作の <a href="https://github.com/spiegel-im-spiegel/gpgpdump" title="spiegel-im-spiegel/gpgpdump: OpenPGP packet visualizer">gpgpdump</a> <sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup> で見てみるとこんな感じになっている。</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">$ gpg -a --export alice | gpgpdump
<span class="hl">Public-Key Packet (tag 6) (51 bytes)
</span><span class="hl">    Version: 4 (current)
</span><span class="hl">    Public key creation time: 2017-12-02T10:37:17+09:00
</span><span class="hl">        5a 22 03 cd
</span><span class="hl">    Public-key Algorithm: EdDSA (pub 22)
</span><span class="hl">    ECC Curve OID: ed25519
</span><span class="hl">        2b 06 01 04 01 da 47 0f 01
</span><span class="hl">    EdDSA EC point (04 || X || Y) (263 bits)
</span>User ID Packet (tag 13) (25 bytes)
    User ID: Alice &lt;alice@example.com&gt;
Signature Packet (tag 2) (150 bytes)
    Version: 4 (current)
    Signiture Type: Positive certification of a User ID and Public-Key packet (0x13)
    Public-key Algorithm: EdDSA (pub 22)
    Hash Algorithm: SHA2-256 (hash 8)
    Hashed Subpacket (62 bytes)
        Issuer Fingerprint (sub 33) (21 bytes)
            Version: 4 (need 20 octets length)
            Fingerprint (20 bytes)
                f7 9b 41 17 17 b8 69 02 17 7e a0 82 00 69 36 13 e2 b6 8f 5a
        Signature Creation Time (sub 2): 2017-12-02T10:37:17+09:00
        Key Flags (sub 27) (1 bytes)
            Flag: This key may be used to certify other keys.
            Flag: This key may be used to sign data.
        Key Expiration Time (sub 9): 730 days after (2019-12-02T10:37:17+09:00)
        Preferred Symmetric Algorithms (sub 11) (4 bytes)
            Symmetric Algorithm: AES with 256-bit key (sym 9)
            Symmetric Algorithm: AES with 192-bit key (sym 8)
            Symmetric Algorithm: AES with 128-bit key (sym 7)
            Symmetric Algorithm: TripleDES (168 bit key derived from 192) (sym 2)
        Preferred Hash Algorithms (sub 21) (5 bytes)
            Hash Algorithm: SHA2-256 (hash 8)
            Hash Algorithm: SHA2-384 (hash 9)
            Hash Algorithm: SHA2-512 (hash 10)
            Hash Algorithm: SHA2-224 (hash 11)
            Hash Algorithm: SHA-1 (hash 2)
        Preferred Compression Algorithms (sub 22) (3 bytes)
            Compression Algorithm: ZLIB &lt;RFC1950&gt; (comp 2)
            Compression Algorithm: BZip2 (comp 3)
            Compression Algorithm: ZIP &lt;RFC1951&gt; (comp 1)
        Features (sub 30) (1 bytes)
            Flag: Modification Detection (packets 18 and 19)
        Key Server Preferences (sub 23) (1 bytes)
            Flag: No-modify
    Unhashed Subpacket (10 bytes)
        Issuer (sub 16): 0x00693613e2b68f5a
    Hash left 2 bytes
        7e b5
    EdDSA compressed value r (253 bits)
    EdDSA compressed value s (251 bits)
<span class="hl">Public-Subkey Packet (tag 14) (56 bytes)
</span><span class="hl">    Version: 4 (current)
</span><span class="hl">    Public key creation time: 2017-12-02T10:37:17+09:00
</span><span class="hl">        5a 22 03 cd
</span><span class="hl">    Public-key Algorithm: ECDH public key algorithm (pub 18)
</span><span class="hl">    ECC Curve OID: cv25519
</span><span class="hl">        2b 06 01 04 01 97 55 01 05 01
</span><span class="hl">    ECDH EC point (04 || X || Y) (263 bits)
</span><span class="hl">    KDF parameters (3 bytes)
</span><span class="hl">        Hash Algorithm: SHA2-256 (hash 8)
</span><span class="hl">        Symmetric Algorithm: AES with 128-bit key (sym 7)
</span>Signature Packet (tag 2) (120 bytes)
    Version: 4 (current)
    Signiture Type: Subkey Binding Signature (0x18)
    Public-key Algorithm: EdDSA (pub 22)
    Hash Algorithm: SHA2-256 (hash 8)
    Hashed Subpacket (32 bytes)
        Issuer Fingerprint (sub 33) (21 bytes)
            Version: 4 (need 20 octets length)
            Fingerprint (20 bytes)
                f7 9b 41 17 17 b8 69 02 17 7e a0 82 00 69 36 13 e2 b6 8f 5a
        Signature Creation Time (sub 2): 2017-12-02T10:37:17+09:00
        Key Flags (sub 27) (1 bytes)
            Flag: This key may be used to encrypt communications.
            Flag: This key may be used to encrypt storage.
    Unhashed Subpacket (10 bytes)
        Issuer (sub 16): 0x00693613e2b68f5a
    Hash left 2 bytes
        29 27
    EdDSA compressed value r (254 bits)
    EdDSA compressed value s (254 bits)</code></pre></div>
<p>長々とした出力で申し訳ないが <code>Public-Key Packet</code> と <code>Public-Subkey Packet</code> の項目に注目していただくと，電子署名用に EdDSA (ed25519)，暗号用に ECDH (cv25519) が使われているのが分かる。
鍵長はいずれも 256bits である。</p>
<p>通常はこれで問題ない。</p>
<h2 id="heading">楕円曲線と鍵長</h2>
<p>ここでちょっと横道に逸れて鍵長の話をしておく。</p>
<p>たとえば RSA の（平文 $M$ から暗号文 $C$ への）暗号化は以下の式で表される。</p>
<div class="box">
\[
    C = M^e \bmod n
\]
</div>
<p>$(e, n)$ のセットが公開鍵で， $n$ のサイズが鍵長に相当する。
実際の計算はともかく，感覚としては分かりやすいよね。</p>
<p>ECC の場合は暗号化の前に，まずベースとなる楕円曲線の（素数 $q$ で決められる）素体（prime fields）を決めなければならない<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>。
これは以下の式で表される。</p>
<div class="box">
\[
    E : y^2 \equiv x^3 + ax + b \pmod{q}
\]
</div>
<p>この素体上の有理点の数（位数）を $\#E$ とした時の $\#E$ のサイズが鍵長に相当する。
$(a,b,q)$ といったパラメータを眺めただけでは鍵長が分からないというのが面倒臭い感じである<sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>。</p>
<p>そこで ECC の場合は楕円曲線を表すパラメータのセットが標準化されていて，そのセットを識別する ECC Curve OID (Object IDentifier) も決められている。
先程書いた <a href="https://github.com/spiegel-im-spiegel/gpgpdump" title="spiegel-im-spiegel/gpgpdump: OpenPGP packet visualizer">gpgpdump</a> 出力結果の &ldquo;<code>ECC Curve OID</code>” の項目がそれに該当する。</p>
<p>つまり ECC Curve OID から楕円曲線の種類を特定し，そこから鍵長も分かる，というわけだ。</p>
<h2 id="gnupg-"><a href="https://gnupg.org/" title="The GNU Privacy Guard">GnuPG</a> で利用できる楕円曲線</h2>
<p>そこで， <a href="https://gnupg.org/" title="The GNU Privacy Guard">GnuPG</a> で利用できる楕円曲線をリストアップしておく。</p>
<p>表の左端列の「GnuPG」は <a href="https://gnupg.org/" title="The GNU Privacy Guard">GnuPG</a> で表示される楕円曲線名を示す。
楕円曲線名に鍵長が含まれている（ただし <code>cv25519</code> と <code>ed25519</code> は 256bits）。
右端列の「強度」は鍵長ではなく，セキュリティ強度なのでご注意を。</p>
<h3 id="secgnist-">SECG/NIST 推奨パラメータ</h3>
<table>
<thead>
<tr>
<th align="left">GnuPG</th>
<th align="left">SECG</th>
<th align="left">NIST</th>
<th align="center">アルゴリズム</th>
<th align="center">強度 bits</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>nistp256</code></td>
<td align="left">secp256r1</td>
<td align="left">NIST curve P-256</td>
<td align="center">ECDH, ECDSA</td>
<td align="center">128</td>
</tr>
<tr>
<td align="left"><code>nistp384</code></td>
<td align="left">secp384r1</td>
<td align="left">NIST curve P-384</td>
<td align="center">ECDH, ECDSA</td>
<td align="center">192</td>
</tr>
<tr>
<td align="left"><code>nistp521</code></td>
<td align="left">secp521r1</td>
<td align="left">NIST curve P-521</td>
<td align="center">ECDH, ECDSA</td>
<td align="center">256</td>
</tr>
<tr>
<td align="left"><code>secp256k1</code></td>
<td align="left">secp256k1</td>
<td align="left"></td>
<td align="center">ECDH, ECDSA</td>
<td align="center">128</td>
</tr>
</tbody>
</table>
<p>SECG/NIST の楕円曲線名とのマッピングは <a href="https://tools.ietf.org/html/rfc4492" title="RFC 4492 - Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS)">RFC 4492</a> を参考にした。
<code>nistp256</code>, <code>nistp384</code>, <code>nistp521</code> は既に <a href="https://tools.ietf.org/html/rfc6637" title="RFC 6637 - Elliptic Curve Cryptography (ECC) in OpenPGP">RFC 6637</a> で定義済みなので正式に使える。
<a href="https://tools.ietf.org/html/rfc6637" title="RFC 6637 - Elliptic Curve Cryptography (ECC) in OpenPGP">RFC 6637</a> では NIST curve P-256 については &ldquo;MUST implement”， NIST curve P-521 については &ldquo;SHOULD implement”， NIST curve P-384 については &ldquo;MAY implement” となっている。</p>
<h3 id="brainpool">Brainpool</h3>
<table>
<thead>
<tr>
<th align="left">GnuPG</th>
<th align="center">アルゴリズム</th>
<th align="center">強度 bits</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>brainpoolP256r1</code></td>
<td align="center">ECDH, ECDSA</td>
<td align="center">128</td>
</tr>
<tr>
<td align="left"><code>brainpoolP384r1</code></td>
<td align="center">ECDH, ECDSA</td>
<td align="center">192</td>
</tr>
<tr>
<td align="left"><code>brainpoolP512r1</code></td>
<td align="center">ECDH, ECDSA</td>
<td align="center">256</td>
</tr>
</tbody>
</table>
<p>Brainpool については <a href="https://tools.ietf.org/html/rfc5639" title="RFC 5639 - Elliptic Curve Cryptography (ECC) Brainpool Standard Curves and Curve Generation">RFC 5639</a> を参照のこと。
<a href="https://datatracker.ietf.org/doc/draft-ietf-openpgp-rfc4880bis/" title="draft-ietf-openpgp-rfc4880bis - OpenPGP Message Format">RFC 4880bis</a> では <code>brainpoolP256r1</code> および <code>brainpoolP512r1</code> については &ldquo;MAY implement” となっている。</p>
<h3 id="heading-1">その他</h3>
<table>
<thead>
<tr>
<th align="left">GnuPG</th>
<th align="center">アルゴリズム</th>
<th align="center">強度 bits</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>cv25519</code></td>
<td align="center">ECDH</td>
<td align="center">128</td>
</tr>
<tr>
<td align="left"><code>ed25519</code></td>
<td align="center">EdDSA</td>
<td align="center">128</td>
</tr>
</tbody>
</table>
<p>EdDSA については <a href="https://tools.ietf.org/html/rfc8032" title="RFC 8032 - Edwards-Curve Digital Signature Algorithm (EdDSA)">RFC 8032</a> を参照のこと。
<a href="https://datatracker.ietf.org/doc/draft-ietf-openpgp-rfc4880bis/" title="draft-ietf-openpgp-rfc4880bis - OpenPGP Message Format">RFC 4880bis</a> では Curve25519 (<code>cv25519</code>) および Ed25519 (<code>ed25519</code>) については &ldquo;SHOULD implement” となっている。</p>
<h2 id="heading-2">セキュリティ強度と楕円曲線</h2>
<p>セキュリティ強度と暗号アルゴリズムと鍵長の関係は以下の表の通り（単位は全てbit）。</p>
<div>
<figure lang="en">
<style>
main table.nist2 th  {
  vertical-align:middle;
  text-align: center;
}
main table.nist2 td  {
  vertical-align:middle;
  text-align: center;
}
</style>
<table class="nist2">
<thead>
<tr>
<th>Security<br>Strength</th>
<th>Symmetric<br> key<br> algorithms</th>
<th>FFC<br>(e.g., DSA, D-H)</th>
<th>IFC<br>(e.g., RSA)</th>
<th>ECC<br>(e.g., ECDSA)</th>
</tr>
</thead>
<tbody>
<tr><td> $\le 80$ </td><td>2TDEA</td><td> $L=1024$ <br> $N=160$ </td><td> $k=1024$ </td> <td> $f = 160\text{ - }223$ </td></tr>
<tr><td> $112$ </td><td>3TDEA</td><td> $L=2048$ <br> $N=224$ </td><td>$k=2048$</td> <td>$f = 224\text{ - }255$</td></tr>
<tr><td> $128$ </td><td>AES-128</td><td> $L=3072$ <br> $N=256$ </td><td>$k=3072$</td> <td>$f = 256\text{ - }383$</td></tr>
<tr><td> $192$ </td><td>AES-192</td><td> $L=7680$ <br> $N=384$ </td><td>$k=7680$</td> <td>$f = 384\text{ - }511$</td></tr>
<tr><td> $256$ </td><td>AES-256</td><td> $L=15360$ <br> $N=512$ </td><td>$k=15360$</td><td>$f=512+$</td></tr>
</tbody>
</table>
<figcaption>Comparable strengths (via <q><a href='https://doi.org/10.6028/NIST.SP.800-57pt1r4'>SP800-57 Part 1 Revision 4 <sup><i class='far fa-file-pdf'></i></sup></a></q>)</figcaption>
</figure>
</div>
<p>2030年以降も Acceptable な鍵が要件なら 128bits 以上のセキュリティ強度が必要だが， <a href="https://gnupg.org/" title="The GNU Privacy Guard">GnuPG</a> で利用できる楕円曲線は全て問題ないことが分かるだろう。</p>
<h2 id="--ecc-">【付録】 対話モードによる ECC 鍵の選択</h2>
<p>対話モードで ECC 鍵を選択して作成するには以下のコマンドラインで起動する。</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">$ gpg --full-gen-key --expert
</code></pre></div><p>このうち ECC 鍵を作成できるのは，以下の選択肢の内 (9) から (11) を選択した場合である。</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">ご希望の鍵の種類を選択してください:
   (1) RSA と RSA (デフォルト)
   (2) DSA と Elgamal
   (3) DSA (署名のみ)
   (4) RSA (署名のみ)
   (7) DSA (機能をあなた自身で設定)
   (8) RSA (機能をあなた自身で設定)
<span class="hl">   (9) ECC と ECC
</span><span class="hl">  (10) ECC (署名のみ)
</span><span class="hl">  (11) ECC (機能をあなた自身で設定)
</span>  (13) 既存の鍵
あなたの選択は? </code></pre></div>
<p>(9) を選択すると電子署名用の主鍵と暗号化用の副鍵をセットで作成する。
(10) と (11) を選択すると電子署名用の主鍵のみ作成する（(11) では主鍵の機能を選択できる） 。</p>
<p>いずれを選択した場合でも以下の楕円曲線の選択肢が表示される。</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">ご希望の楕円曲線を選択してください:
   (1) Curve 25519
   (3) NIST P-256
   (4) NIST P-384
   (5) NIST P-521
   (6) Brainpool P-256
   (7) Brainpool P-384
   (8) Brainpool P-512
   (9) secp256k1
あなたの選択は? 
</code></pre></div><p>実際にどのような鍵が作成されるか以下に示す。</p>
<h3 id="ecc--ecc">「ECC と ECC」を選んだ場合</h3>
<table>
<thead>
<tr>
<th align="left">選択した楕円曲線</th>
<th align="left">主鍵（電子署名用）</th>
<th align="left">副鍵（暗号化用）</th>
<th align="center">強度 bit</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>Curve 25519</code></td>
<td align="left">EdDSA (<code>ed25519</code>)</td>
<td align="left">ECDH (<code>cv25519</code>)</td>
<td align="center">128</td>
</tr>
<tr>
<td align="left"><code>NIST P-256</code></td>
<td align="left">ECDSA (<code>nistp256</code>)</td>
<td align="left">ECDH (<code>nistp256</code>)</td>
<td align="center">128</td>
</tr>
<tr>
<td align="left"><code>NIST P-384</code></td>
<td align="left">ECDSA (<code>nistp384</code>)</td>
<td align="left">ECDH (<code>nistp384</code>)</td>
<td align="center">192</td>
</tr>
<tr>
<td align="left"><code>NIST P-521</code></td>
<td align="left">ECDSA (<code>nistp521</code>)</td>
<td align="left">ECDH (<code>nistp521</code>)</td>
<td align="center">256</td>
</tr>
<tr>
<td align="left"><code>Brainpool P-256</code></td>
<td align="left">ECDSA (<code>brainpoolP256r1</code>)</td>
<td align="left">ECDH (<code>brainpoolP256r1</code>)</td>
<td align="center">128</td>
</tr>
<tr>
<td align="left"><code>Brainpool P-384</code></td>
<td align="left">ECDSA (<code>brainpoolP384r1</code>)</td>
<td align="left">ECDH (<code>brainpoolP384r1</code>)</td>
<td align="center">192</td>
</tr>
<tr>
<td align="left"><code>Brainpool P-512</code></td>
<td align="left">ECDSA (<code>brainpoolP512r1</code>)</td>
<td align="left">ECDH (<code>brainpoolP512r1</code>)</td>
<td align="center">256</td>
</tr>
<tr>
<td align="left"><code>secp256k1</code></td>
<td align="left">ECDSA (<code>secp256k1</code>)</td>
<td align="left">ECDH (<code>secp256k1</code>)</td>
<td align="center">128</td>
</tr>
</tbody>
</table>
<h3 id="ecc-">「ECC (署名のみ)」を選んだ場合</h3>
<p>「ECC (機能をあなた自身で設定)」でも同じ。</p>
<table>
<thead>
<tr>
<th align="left">選択した楕円曲線</th>
<th align="left">主鍵（電子署名用）</th>
<th align="left">副鍵</th>
<th align="center">強度 bit</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>Curve 25519</code></td>
<td align="left">EdDSA (<code>ed25519</code>)</td>
<td align="left">なし</td>
<td align="center">128</td>
</tr>
<tr>
<td align="left"><code>NIST P-256</code></td>
<td align="left">ECDSA (<code>nistp256</code>)</td>
<td align="left">なし</td>
<td align="center">128</td>
</tr>
<tr>
<td align="left"><code>NIST P-384</code></td>
<td align="left">ECDSA (<code>nistp384</code>)</td>
<td align="left">なし</td>
<td align="center">192</td>
</tr>
<tr>
<td align="left"><code>NIST P-521</code></td>
<td align="left">ECDSA (<code>nistp521</code>)</td>
<td align="left">なし</td>
<td align="center">256</td>
</tr>
<tr>
<td align="left"><code>Brainpool P-256</code></td>
<td align="left">ECDSA (<code>brainpoolP256r1</code>)</td>
<td align="left">なし</td>
<td align="center">128</td>
</tr>
<tr>
<td align="left"><code>Brainpool P-384</code></td>
<td align="left">ECDSA (<code>brainpoolP384r1</code>)</td>
<td align="left">なし</td>
<td align="center">192</td>
</tr>
<tr>
<td align="left"><code>Brainpool P-512</code></td>
<td align="left">ECDSA (<code>brainpoolP512r1</code>)</td>
<td align="left">なし</td>
<td align="center">256</td>
</tr>
<tr>
<td align="left"><code>secp256k1</code></td>
<td align="left">ECDSA (<code>secp256k1</code>)</td>
<td align="left">なし</td>
<td align="center">128</td>
</tr>
</tbody>
</table>
<h2 id="heading-3">ブックマーク</h2>
<ul>
<li>
<span><a href="http://www.jnsa.org/seminar/pki-day/2011/data/02_kanaoka.pdf">楕円曲線暗号の整備動向＋楕円暗号の実装状況 <sup><i class="far fa-file-pdf"></i></sup></a></span>
</li>
<li>
<p><a href="http://www.maidsphere.jp/archive/%E6%A5%95%E5%86%86%E6%9B%B2%E7%B7%9A%E6%9A%97%E5%8F%B7%E3%81%AE%E9%8D%B5%E9%95%B7%E3%81%AB512bit%E3%81%8C%E3%81%AA%E3%81%8F521bit%E3%81%8C%E3%81%82%E3%82%8B%E7%90%86%E7%94%B1">楕円曲線暗号の鍵長に512bitがなく521bitがある理由 | maidsphere</a></p>
</li>
<li>
<p><a href="https://kazu-yamamoto.hatenablog.jp/entry/20171114/1510635277">TLS 1.3 開発日記 その22 公開鍵暗号の動向 - あどけない話</a></p>
</li>
<li>
<p><a href="https://text.baldanders.info/openpgp/algorithms-for-openpgp/">OpenPGP で利用可能なアルゴリズム（RFC 4880bis 対応版）</a></p>
</li>
<li>
<p><a href="https://text.baldanders.info/openpgp/gnupg-cheat-sheet/">GnuPG チートシート（鍵作成から失効まで）</a></p>
</li>
</ul>
<h2 id="heading-4">参考図書</h2>
<div class="hreview">
  <div class="photo"><a class="item url" href="https://www.amazon.co.jp/dp/B015643CPE?tag=baldandersinf-22&linkCode=ogi&th=1&psc=1"><img src="https://m.media-amazon.com/images/I/51t6yHHVwEL._SL160_.jpg" width="113" alt="photo"></a></div>
  <dl class="fn">
    <dt><a href="https://www.amazon.co.jp/dp/B015643CPE?tag=baldandersinf-22&linkCode=ogi&th=1&psc=1">暗号技術入門 第3版　秘密の国のアリス</a></dt>
    <dd>結城 浩 (著)</dd>
    <dd>SBクリエイティブ 2015-08-25 (Release 2015-09-17)</dd>
    <dd>Kindle版</dd>
    <dd>B015643CPE (ASIN)</dd>
    <dd>評価<abbr class="rating fa-sm" title="5">&nbsp;<i class="fas fa-star"></i>&nbsp;<i class="fas fa-star"></i>&nbsp;<i class="fas fa-star"></i>&nbsp;<i class="fas fa-star"></i>&nbsp;<i class="fas fa-star"></i></abbr></dd>
  </dl>
  <p class="description">SHA-3 や Bitcoin/Blockchain など新しい知見や技術要素を大幅追加。暗号技術を使うだけならこれ1冊でとりあえず無問題。</p>
  <p class="powered-by">reviewed by <a href='#maker' class='reviewer'>Spiegel</a> on <abbr class="dtreviewed" title="2015-09-20">2015-09-20</abbr> (powered by <a href="https://affiliate.amazon.co.jp/assoc_credentials/home">PA-APIv5</a>)</p>
</div>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p>この辺については「<a href="https://text.baldanders.info/openpgp/openpgp-key-management/">OpenPGP 鍵管理に関する考察</a>」を参照のこと。 <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2" role="doc-endnote">
<p><a href="https://github.com/spiegel-im-spiegel/gpgpdump" title="spiegel-im-spiegel/gpgpdump: OpenPGP packet visualizer">gpgpdump</a> v0.3.4 以降なら多分大丈夫。 <a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3" role="doc-endnote">
<p>素体ではなく「標数2の体（binary fields）」を使う場合もあるが，ここでは割愛する。 <a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4" role="doc-endnote">
<p>楕円曲線と楕円曲線暗号については結城浩さんの『<a href="https://www.amazon.co.jp/exec/obidos/ASIN/B015643CPE/baldandersinf-22/">暗号技術入門 第3版</a>』の付録に比較的分かりやすい解説が載っている。同じく結城浩さんの『<a href="https://www.amazon.co.jp/exec/obidos/ASIN/B00L0PDMK4/baldandersinf-22/">数学ガール ガロア理論</a>』が何となく分かれば楕円曲線についても何となく分かると思う。大丈夫。私も何となくしか分かっていない（笑） <a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>

</section>

</article>
</main>
<nav class="page-nav">
<div class="prev-page">&laquo; <a href="/openpgp/issuer-fingerprint-signature-subpacket-in-next-openpgp/">Issuer Fingerprint Signature Subpacket in Next OpenPGP</a></div>
<div class="next-page"><a href="/openpgp/git-extensions-and-libreoffice-6-with-openpgp/">Git Extensions と LibreOffice 6 と OpenPGP</a> &raquo;</div>
</nav>

<aside class="feedback" id='feedback'>
<h1>Feedback</h1>
<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "textbaldandersinfo" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

<p>Web ブラウザとその設定によってはコメント機能をホストしている <a href="https://disqus.com/">Disqus</a> のコードを「追跡コード」としてブロックする場合があります。</p>
<p>フィードバックの手段として Twitter, Facebook または電子メールも利用できます。電子メールを利用する際の公開鍵は<a href="https://baldanders.info/profile/">プロフィール</a>から取得できます。</p>
</aside>
<footer>


<div class="userinfo">
	<div class="userinfo-avater">
		<a href="https://baldanders.info/profile/"><img src="https://text.baldanders.info/images/avatar.jpg" width="48" height="48" alt="avatar" id="logo"></a>
	</div>
	<div class="userinfo-info" id="maker">
		Text by <a href="https://baldanders.info/profile/" rel="cc:attributionURL" property="cc:attributionName">Spiegel</a>
		in <time property='dc:dateCopyrighted'>2017-12-02</time> (revised in 2019-11-27)
		
	<a rel='cc:license' href="https://creativecommons.org/licenses/by-sa/4.0/"><i class="fab fa-creative-commons"></i>&nbsp;<i class="fab fa-creative-commons-by"></i>&nbsp;<i class="fab fa-creative-commons-sa"></i></a>

		<ul class="social">
	<li><a href="https://github.com/spiegel-im-spiegel"><span class="github-color"><i class="fab fa-github"></i></span></a></li>
	<li><a href="https://twitter.com/spiegel_2007"><span class="twitter-color"><i class="fab fa-twitter"></i></span></a></li>
	
	
	
	<li><a href="https://www.flickr.com/photos/spiegel/"><span class="flickr-color"><i class="fab fa-flickr"></i></span></a></li>
	<li><a href="https://www.facebook.com/spiegel.im.spiegel"><span class="facebook-color"><i class="fab fa-facebook-f"></i></span></a></li>
	
	
</ul>
	</div>
</div>

<nav>
<ul class='cloud center'>
<li><a href='https://github.com/spiegel-im-spiegel/spiegel-im-spiegel.github.io'>Repository</a></li>
<li><a href='/reviews/'>Reviews</a></li>
<li><a href='/about-feeds/'>Feeds</a></li>
<li><a href='/site-policy/'>Site Policy</a></li>
<li><a href='https://validator.w3.org/nu/?doc=https%3a%2f%2ftext.baldanders.info%2fopenpgp%2fusing-ecc-with-gnupg%2f&amp;showoutline=yes'>Debug</a></li>
</ul>
<ul class='cloud center'>
<li><a href='https://baldanders.info/'>Home</a></li>
<li><a href='https://photo.baldanders.info/'>Photos</a></li>
<li><a href='https://scrapbox.io/spiegel-branch/'>Scrapbox</a></li>
<li><a href='http://qiita.com/spiegel-im-spiegel'>Qiita</a></li>
</ul>
<ul class='cloud center'>
<li>Powered by <a href='https://gohugo.io/'>Hugo 0.62.0</a> and <a href="https://github.com/spiegel-im-spiegel/hugo-theme-baldanders-info
">Theme of Baldanders.info</a>.</li>
</ul>
</nav>
</footer>
</div>

</body>
</html>
